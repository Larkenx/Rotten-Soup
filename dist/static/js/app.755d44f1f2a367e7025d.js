webpackJsonp([1],{"+wI6":function(e,t){},"2Nfd":function(e,t){},"6EFC":function(e,t){},"7zck":function(e,t){},"9g9w":function(e,t){},ESp4:function(e,t){},NHnr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("7+uW"),s=i("cVUK"),r=i.n(s),n=i("50uv");let o=[50];for(let e=1;e<100;e++)o.push(1.5*o[e-1]);class l{constructor(e,t,i){if(this.x=e,this.y=t,Object.assign(this,i),void 0===i.id)throw"Error - entity created without valid id"}setSprite(e){this.sprite=e}setSpriteHPBar(e){this.spriteHPBar=e}move(e,t){let i=nt.map.data[t][e];nt.map.data[this.y][this.x].removeActor(this),i.actors.push(this),nt.display.moveSprite(this.sprite,e,t),this.x<e?(this.sprite.scale.x=-1,this.sprite.anchor.set(1,0)):this.x>e&&(this.sprite.scale.x=1,this.sprite.anchor.set(0,0)),this.x=e,this.y=t,void 0!==this.spriteHPBar&&nt.display.moveSprite(this.spriteHPBar,e,t-.5)}placeAt(e,t){nt.getTile(e,t).actors.push(this),this.x=e,this.y=t,void 0!==this.sprite&&nt.display.moveSprite(this.sprite,e,t,!1)}}class c extends l{constructor(e,t,i){i.visible=!0,i.inInventory=!0,super(e,t,i)}hoverInfo(){return`${this.type}${this.name}\n`}clipLocation(){getTilesetCoords(this.id);return"rect(0,32,32,0)"}use(){}getAction(){return this.action}drop(){nt.player.dropItem(this)}}class h extends c{constructor(e,t,i){i.action="Drink",super(e,t,i)}use(){nt.player.cb.potionsConsumed++}}class d extends h{constructor(e,t,i){super(e,t,{id:i,type:"Health Potion"})}use(){super.use(),nt.log("You drink a health potion. It restores a little HP.","defend"),nt.player.heal(25),nt.player.removeFromInventory(this)}hoverInfo(){return"Effect: Heals for 25 HP"}}class p{constructor(e){if(Object.assign(this,e),void 0===this.name||void 0===this.description||void 0===this.action||void 0===this.duration)throw"Effect missing critical fields"}applyEffect(e){0!=this.duration&&(this.action(e),this.duration--)}}class m extends p{constructor(){super({name:"Regeneration",action:e=>{e.heal(5)},description:e=>e===nt.player?"You regenerate 5 health.":`${e.name.capitalize()} regenerated 5 health.`,duration:5})}}class u extends p{constructor(e){if(void 0===e.undoAction)throw"Buffs must declare a way to undo temporary effects";super(e),this.initialDuration=this.duration}applyEffect(e){this.duration===this.initialDuration?(this.action(e),this.duration--):1===this.duration?(nt.log(`Your ${this.name} has expired.`,"alert"),this.undoAction(e),this.duration--):this.duration--}}class g extends u{constructor(e){super({name:"Strength Buff",action:t=>{t.cb.str+=e},undoAction:t=>{t.cb.str-=e},description:t=>`${t.name} has +${e} Strength for ${this.duration} turns`,duration:5,amount:e})}}class v extends h{constructor(e,t,i){super(e,t,{id:i,type:"Strength Potion"}),this.buff=new g(3)}use(){super.use(),nt.player.addNewBuff(this.buff),nt.log(`You drink a strength potion. It boosts your strength for the next ${this.buff.duration+1} moves.`,"defend"),nt.player.removeFromInventory(this)}hoverInfo(){return`Effect: +${this.buff.amount} STR for ${this.buff.duration} moves`}}class y extends h{constructor(e,t,i){super(e,t,{id:i,type:"Mana Potion"})}use(){super.use(),nt.log("You drink a mana potion. It restores a little mana.","defend"),nt.player.restore(10),nt.player.removeFromInventory(this)}hoverInfo(){return"Effect: Restores 10 mana"}}class f extends c{constructor(e,t,i){if(null===i.combat)throw`Error - no options.combat property defined. Bad weapon creation for ${i.name}`;i.visible=!0,i.blocked=!1,i.combat.equippable=!0,i.combat.equipped=!1,super(e,t,i),this.cb=this.combat,this.cb.enchantments=[],this.action="Equip"}use(){nt.player.cb.equipment.weapon===this?nt.player.unequipWeapon():nt.player.equipWeapon(this)}roll(){let e=0;for(let t=0;t<this.cb.rolls;t++)e+=k(1,this.cb.sides);return e}getAction(){return this.cb.equipped?"Unequip":this.action}addNewEnchantment(e){this.cb.enchantments.push(e)}hoverInfo(){return`Damage: ${this.cb.rolls}-${this.cb.sides*this.cb.rolls}`}}class b extends f{constructor(e,t,i,a,s,r){super(e,t,{id:r,name:s,type:"Sword",fg:"orange",combat:{rolls:a,sides:i},attackVerbs:["slashed","stabbed","gutted","sliced"]})}}let w=["Caledfwlch","Hywelbane","Brightkiller","Excalibur","Joyeux","Dyrnwyn","Johnny Corkscrew","The Sword of Leah","The Sword of Shannara","The Vorpal Sword","Seraph Blade","Glorious","Cortana","Heosphorous","Phaesphoros","Maellartach","The Rivan Sword","The Sword of Shadows","Sikanda","Dragnipur","Chance","Vengeance","Grief","The Swords of Night and Day","The Swords of Blood and Fire","Snaga","The Sword of Truth","The Lady Vivamus","Sword of Martin","Verminfate","Rapscallion sword","Callandor","Heron Mark Sword","Graywand","Scalpel","Rhindon","Blackfyre","Brightroar","Dark Siste","Dawn","Hearteater","Heartsbane","Widow's Wail","Ice","Lady Forlorn","Longclaw","Red Rain","Albitr","Needle","The Black Blade","Mournblade","Oathkeeper","Naegling","Arvindr","Ravenbrand","Zar'roc","Lion's Tooth","Doomgiver","Kanajana","Támerlein","Shieldbreaker","Woundhealer","Narsil","Lightbringer","Soulcutter","Sightblinder","Wayfinder","Orcrist","Stonecutter","Townsaver","The Sword of Gryffindor","Farslayer","Mindsword","Dragonslicer","Katopris","Backbiter","Undbitr","Brisingr","Barrow-blade","Coinspinner","Lhang","Traitor","Anglachel","Hadhafang","Vrangr","The Darksword","The Lightsword","Herugrim","Anaklusmos","Gúthwinë","Terminus Est","Memory","Khazid'hea","Clamorer","Backbiter","Thorn","Charon's Claw","Twinkle","Godsbane","Icingdeath","Hrunting","Naegling","The Sword of the Dawn","Hill Cleaver","Werewindle","Kijin-marukuni-shige","Balaraw","Keyblade","Hina","Tessaiga","Sorrow","Singing Sword","Sword of Chaos","The Starsword","Biggoron Sword","Grayswandir","Rain Dragon","Shisui","Gurthang","Aranrúth","Nightfall","Sting"];function x(e,t,i){return new b(e,t,k(2,4),k(1,2),w[k(0,w.length-1)],i)}const _={ARROW:"Arrow"};class T extends c{constructor(e,t,i){i.visible=!0,i.blocked=!1,i.combat.equippable=!0,i.combat.equipped=!1,i.action="Equip",super(e,t,i),Object.assign(this,i),this.cb=this.combat}use(){nt.player.cb.equipment.ammo===this?nt.player.unequipAmmo():nt.player.equipAmmo(this)}getAction(){return this.cb.equipped?"Unequip":this.action}hoverInfo(){return`Quantity: ${this.quantity}`}}class S extends T{constructor(e,t,i){i.combat.ammoType=_.ARROW,super(e,t,i)}}class C extends S{constructor(e,t,i,a){super(e,t,{id:i,type:"Steel Arrows",combat:{damage:0},quantity:a})}}function k(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function E(e,t){return Math.floor(e+(()=>{let e=0;for(let t=0;t<6;t++)e+=Math.random();return e/6})()*(t-e+1))}function O(e,t,i){return e<=t&&t<=i}function R(e){const t=["a","e","i","o","u"];if("you"!==e){return["trees","flowers","grass","wild grass","water","steel arrows","carpet","logs","cobwebs","dirt","bones"].includes(e)?"some "+e:t.includes(e[0].toLowerCase())?"an "+e:"a "+e}return e}let L={STRENGTH_POTION:"STRENGTH_POTION",MANA_POTION:"MANA_POTION",HEALTH_POTION:"HEALTH_POTION",SWORD:"SWORD",STEEL_ARROW:"STEEL_ARROW"};function A(e,t){let i=0;for(let a=0;a<e;a++)i+=k(1,t);return i}function M(e){if(void 0==e.dropTable||void 0==e.minItems||void 0==e.maxItems||void 0==e.x||void 0==e.y)throw"Not enough arguments given. Expected drop table object, min and max number of items to produce, and x,y location";let{dropTable:t,minItems:i,maxItems:a,x:s,y:n}=e,o=[],l=k(i,a);for(let e=0;e<l;e++){let e=r.a.RNG.getWeightedValue(t);switch(e){case L.STRENGTH_POTION:o.push(new v(s,n,969));break;case L.HEALTH_POTION:o.push(new d(s,n,488));break;case L.MANA_POTION:o.push(new y(s,n,608));break;case L.SWORD:o.push(x(s,n,35));break;case L.STEEL_ARROW:o.push(new C(s,n,784,5));break;default:console.log("tried to add some item that doesn't exist to an inventroy from drop table"),console.log(e)}}return o}function I(e){let t=[];return new r.a.FOV.PreciseShadowcasting(function(e,t){return nt.inbounds(e,t)&&nt.map.data[t][e].visible()}).compute(e.x,e.y,e.cb.range,(e,i,a,s)=>{nt.inbounds(e,i)&&t.push(nt.map.data[i][e])}),t}class D extends l{constructor(e,t,i){super(e,t,{name:"door",id:i,bg:"rgb(140, 80, 0)",fg:"red",visible:!1,blocked:!0}),this.closed=!0}react(){this.closed&&this.openDoor()}openDoor(){this.closed=!1,this.blocked=!1,this.visible=!0,this.id=nt.display.tileset.tileproperties[this.id].activated_id,this.sprite.texture=nt.display.tilesetMapping[this.id]}closeDoor(){this.closed=!1,this.blocked=!1,this.visible=!0,this.id=this.id}}class $ extends l{constructor(e,t,i){super(e,t,{name:"chest",id:i,visible:!0,blocked:!0}),this.closed=!0,this.items=[]}react(e){let t=e===nt.player;if(this.closed)this.open();else if(0===this.items.length&&t)nt.log("There's nothing left in this chest!","information");else{t&&nt.log("You collect everything from the chest.","information");for(let t of this.items)e.addToInventory(t);t&&nt.player.cb.chestsOpened++,this.items=[]}}addToInventory(e){this.items.push(e)}open(){this.closed=!1,this.id=nt.display.tileset.tileproperties[this.id].activated_id,this.sprite.texture=nt.display.tilesetMapping[this.id]}}class N extends l{constructor(e,t,i,a,s,r=!1){super(e,t,{id:i,name:"ladder",direction:a,description:"A ladder leading "+a,fg:"brown",bg:"orange",blocked:!1,visible:!0}),this.portal=s,this.createDungeon=r}act(){}react(e){null!==this.direction?("down"===this.direction&&nt.log("You climb down the ladder...","player_move"),"up"===this.direction&&nt.log("You climb up the ladder...","player_move"),nt.changeLevels(this.portal,this.createDungeon)):console.error("Ladder does not have a direction!")}}const P={SKELETON:5489,HUMANOID:2647};class B extends l{constructor(e,t,i,a){super(e,t,{id:a,name:"skeleton"===i.toLowerCase()?"pile of bones":`${i.capitalize()} Corpse`,blocked:!1,visible:!0}),this.rotten=!1,this.turns=0}act(){if(nt.engine.lock(),this.turns++,30===this.turns&&(this.sprite.tint=3256136),35===this.turns&&(this.sprite.tint=2520885),this.turns>=40){let e=nt.engine._scheduler.remove(this);nt.map.data[this.y][this.x].removeActor(this),e=nt.map.actors.indexOf(this),nt.map.actors.splice(e,1),nt.display.removeChild(this.sprite)}nt.engine.unlock()}hoverInfo(){return""}}class H extends l{constructor(e,t,i,a=null){super(e,t,i),this.cb=this.combat,void 0===this.corpseType&&(this.corpseType=P.HUMANOID),this.cb.effects=[],this.cb.equipment={head:null,torso:null,legs:null,weapon:null,ammo:null,ring:null},this.inventory=[];for(let e=0;e<27;e++)this.inventory.push({item:null,menu:!1})}act(){this.cb.effects=this.cb.effects.filter(e=>e.duration>0);for(let e of this.cb.effects)e instanceof u||nt.log(e.description(this),"alert"),e.applyEffect(this)}addNewEffect(e){this.cb.effects.push(e)}addNewBuff(e){e.applyEffect(this),this.cb.effects.push(e)}memberOfInventory(e){return-1<this.inventory.findIndex(t=>Object.is(e,t.item))}addToInventory(e){if("quantity"in e)for(let t=0;t<this.inventory.length;t++){let i=this.inventory[t].item;if(null!==i&&i.type===e.type)return i.quantity+=e.quantity,i}let t=null;for(let e=0;e<this.inventory.length;e++)if(null==this.inventory[e].item){t=e;break}return null===t?(nt.log("Your inventory is full! Drop something in order to pick this up."),this.placeEntityBelow(e),e):(this.inventory[t].item=e,this.inventory[t].item)}placeEntityBelow(e){e instanceof c?(e.placeAt(this.x,this.y),nt.display.assignSprite(item)):nt.map.data[this.y][this.x].actors.push(e)}removeFromInventory(e){let t=this.inventory.findIndex(t=>Object.is(e,t.item));if(-1==t)throw"invalid item removal - trying to remove an item that cannot be found in inventory!";this.inventory[t].item=null}dropItem(e){if(!this.memberOfInventory(e))throw"Error - trying to drop an item you don't have in your inventory";null!==e&&"cb"in e&&(e.cb.equipped=!1,this.cb.equipment.weapon==e&&(this.cb.equipment.weapon=null)),e.placeAt(this.x,this.y),nt.display.assignSprite(e,!0,2),this.removeFromInventory(e)}items(){return this.inventory.filter(e=>null!==e.item).map(e=>e.item)}distanceTo(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}interact(e){let t=e.x-this.x,i=e.y-this.y;return this!==nt.player&&e!==nt.player||!nt.userSettings.animationsEnabled||(nt.display.moveSprite(this.sprite,this.x+t/2,this.y+i/2),setTimeout(()=>{nt.display.moveSprite(this.sprite,this.x,this.y)},100)),null}react(e){return null}tryMove(e,t){if(e<0||e===nt.map.width||t<0||t===nt.map.height)return!1;let i=nt.map.data[t][e];if(0===i.actors.length&&!i.blocked())return this.move(e,t),!0;if(i.actors.length>0)for(let e=0;e<i.actors.length;e++){let t=i.actors[e];if(t instanceof H&&t.blocked&&t.visible)return t.isDead()||this.interact(t),!0;if(t instanceof D){if(t.react(),!0===t.closed)return!0}else if(t instanceof $)return!1}return!i.blocked()&&(this.move(e,t),!0)}attack(e){let{weapon:t}=this.cb.equipment,i=null!==t?this.cb.str+t.roll():this.cb.str;t&&t.cb.ranged&&(i=this.cb.str);let a,s="";if(null!==t){let{attackVerbs:r,type:n}=t;a=r[~~(Math.random()*r.length)],s=`${R(this.name).capitalize()} ${a} ${R(e.name)} with ${R(n.toLowerCase())} and dealt ${i} damage.`}else s=`${R(this.name).capitalize()} attacked ${R(e.name)} and dealt ${i} damage.`;if(nt.player===this?nt.log(s,"player_move"):nt.log(s,"attack"),i>0&&e.damage(i),this.cb.damageDealt+=i,t&&t.cb.enchantments.length>0)for(let i of t.cb.enchantments){let t=i.getEffect();e.cb.effects.some(e=>{e.name,t.name})||e.addNewEffect(t)}return i}equipWeapon(e){if(!(e instanceof f&&"cb"in e))throw"Error - equipped invalid item - "+this.item.type;null!==this.cb.equipment.weapon&&(this.cb.equipment.weapon.cb.equipped=!1),this.cb.equipment.weapon=e,e.cb.equipped=!0}equipAmmo(e){if(!(e instanceof T&&"cb"in e))throw"Error - equipped invalid item - "+this.item.type;null!==this.cb.equipment.ammo&&(this.cb.equipment.ammo.cb.equipped=!1),this.cb.equipment.ammo=e,this.cb.equipment.ammo.cb.equipped=!0}damage(e){this.cb.invulnerable||(this.cb.damageTaken+=e,this.cb.hp<=e?this.cb.hp=0:this.cb.hp-=e,this.isDead()&&(this!==nt.player&&nt.player.gain_xp(Math.floor(.5*this.cb.maxhp)),this.death()),null===this.sprite||this.isDead||(this.sprite.tint="0xba1b21",setTimeout(()=>this.sprite.tint="0xFFFFFF",200)))}heal(e){this.cb.healthRestored+=e,this.cb.hp+e>this.cb.maxhp?this.cb.hp=this.cb.maxhp:this.cb.hp+=e}restore(e){this.cb.mana+e>this.cb.maxmana?this.cb.mana=this.cb.maxmana:this.cb.mana+=e}fireRangedWeapon(e,t){let i=this.cb.equipment.weapon,a=i.cb.range,s=i.roll()+e.cb.damage+this.cb.str,n=r.a.DIRS[8][t];for(let t=1;t<a;t++){let i=this.x+n[0]*t,a=this.y+n[1]*t,r=nt.map.data[a][i];if(!r.visible())return void(nt.player===this&&nt.log(`Your ${e.type.toLowerCase()} hit an obstacle!`,"alert"));let o=r.actors.filter(function(e){return e.combat&&e.cb.hostile});if(o.length>0){let t=o[0],i=`${R(this.name).capitalize()} hit ${R(t.name)} with ${R(e.type.toLowerCase())} and dealt ${s} damage.`;return nt.player===this?nt.log(i,"player_move"):nt.log(i,"attack"),void t.damage(s)}}nt.log(`Your ${e.type.toLowerCase()} didn't hit anything!`,"alert")}death(){let e=nt.engine._scheduler.remove(this),t=nt.map.data[this.y][this.x];t.removeActor(this),e=nt.map.actors.indexOf(this),nt.map.actors.splice(e,1);nt.display.background.children.length;if(this.inventory.length>0){let e=this.items();for(let t of e)this.dropItem(t)}if(0===k(0,1)&&void 0!==this.corpseType&&null!==this.corpseType){let e=new B(this.x,this.y,this.name,this.corpseType);t.actors.unshift(e),nt.scheduler.add(e,!0),nt.display.assignSprite(e,!0)}let i=2644-k(0,1);if(this.corpseType===P.HUMANOID){let e=new n.Sprite(nt.display.tilesetMapping[i]);e.position.set(this.x*nt.display.tileSize,this.y*nt.display.tileSize),nt.display.background.addChildAt(e,1)}nt.display.background.removeChild(this.sprite),void 0!==this.spriteHPBar&&nt.display.background.removeChild(this.spriteHPBar),this===nt.player?nt.log("You died!","death"):(nt.log(`You killed the ${this.name}.`,"death"),nt.player.cb.enemiesKilled++)}isDead(){return this.cb.hp<=0}getHoverInfo(){return`HP: ${this.cb.hp} / ${this.cb.maxhp}<br />"${this.description}"`}getMinDmg(){let e=this.cb.equipment.weapon,t=null!==e?e.cb.rolls:0;return this.cb.str+t}getMaxDmg(){let e=this.cb.equipment.weapon,t=null!==e?e.cb.rolls*e.cb.sides:0;return this.cb.str+t}}class q extends f{constructor(e,t,i){super(e,t,i),this.cb.ranged=!0}hoverInfo(){return`Damage: ${this.cb.rolls}-${this.cb.sides*this.cb.rolls} Range: ${this.cb.range}`}}const z=(e,t,i)=>new class extends q{constructor(e,t,i,a,s,r,n){super(e,t,{id:i,name:a,type:"Bow",combat:{rolls:s,sides:r,range:n,ammoType:_.ARROW},attackVerbs:["slapped","smacked","whacked"]})}}(e,t,i,"Bow of the Sunwalker",3,2,7);class W extends H{constructor(e,t,i,a){super(e,t,i),this.ai=a}act(){nt.engine.lock();const e=()=>{super.act(),nt.engine.unlock()};let t=Math.abs(this.x-nt.player.x),i=Math.abs(this.y-nt.player.y);if(t>nt.width/2||i>nt.height/2)return void e();nt.player.recalculatePath();let a=I(this).reduce((e,t)=>e.concat(t.actors),[]).some(e=>e===nt.player),{wanders:s,morale:n,minPlayerDist:o,maxPlayerDist:l,ranged:c,melee:h,magic:d}=this.ai;if(a){this.chasing||nt.log(`A ${this.name} sees you.`,"alert"),this.chasing=!0;let t=[];nt.player.path.compute(this.x,this.y,(e,i)=>{t.push([e,i])});const i=()=>{let e=[];for(let t=0;t<7;t++){let i=r.a.DIRS[8][t],a=this.x+i[0],s=this.y+i[1];if(nt.inbounds(a,s)){let t=nt.getTile(a,s);t.blocked()||0!==t.actors.length||e.push(t)}}return e.push(nt.getTile(this.x,this.y)),e},a=e=>Math.sqrt(Math.pow(nt.player.x-e.x,2)+Math.pow(nt.player.y-e.y,2));if(n>=this.cb.hp/this.cb.maxhp){let s=(()=>{let e=i(),t=a(e[0]),s=e[0];for(let i of e){let e=a(i);e>=t&&(t=e,s=i)}return s})();if(s.x!==this.x||s.y!==this.y)return this.fleeing||nt.log(`The ${this.name.toLowerCase()} trembles at your might and attempts to escape death.`,"purple"),this.fleeing=!0,this.tryMove(s.x,s.y),void e();if(t.length<=2){let e=t[1];this.tryMove(e[0],e[1])}}else if(t.length>=2){let e=t[1];this.tryMove(e[0],e[1])}}else if(s){let e=this.x+k(-1,1),t=this.y+k(-1,1);this.tryMove(e,t)}e()}interact(e){super.interact(e),e===nt.player?this.attack(e):e.react(this)}attack(e){let t=A(2,this.cb.str),i=this.cb.description.length,a=`${R(this.name).capitalize()}${this.cb.description[Math.floor(Math.random()*i)]}${R(e.name)} and dealt ${t} damage.`;return nt.player===this?nt.log(a,"player_move"):nt.log(a,"attack"),t>0&&e.damage(t),t}}class Y extends W{constructor(e,t,i,a=!0){super(e,t,i,{morale:0,minPlayerDist:0,maxPlayerDist:0,ranged:!1,melee:!0,magic:!1,wanders:a})}}class F extends Y{constructor(e,t,i){let a=k(10,17),s=k(3,6);super(e,t,{id:i,name:"skeleton",description:"A skeleton raised from the dead!",corpseType:P.SKELETON,visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:a,maxmana:5,hp:a,mana:5,str:s,def:1,hostile:!0,range:7,invulnerable:!1}})}}class G extends Y{constructor(e,t,i){let a=k(10,15);super(e,t,{id:i,name:"zombie",description:"A zombie raised from the dead!",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:a,maxmana:5,hp:a,mana:5,str:k(1,3),def:1,hostile:!0,range:7,invulnerable:!1}})}}const V={CONJURATION:"CONJURATION",RESTORATION:"RESTORATION",CHARMS:"CHARMS",ICE:"ICE",AIR:"AIR",EARTH:"EARTH",FIRE:"FIRE",POISON:"POISON",NECROMANCY:"NECROMANCY",TRANSLOCATION:"TRANSLOCATION",TRANSMUTATION:"TRANSMUTATION",HEXES:"HEXES"},j={SELF:"SELF",TARGET:"TARGET"};class U{constructor(e){if(void 0===e.name||void 0===e.hoverInfo||void 0===e.action||void 0===e.type||void 0===e.manaCost||void 0===e.targetType)throw"Spell creation failed - insufficient information provided";Object.assign(this,e)}cast(){}}class K extends U{constructor(e){super({name:"Minor Heal",hoverInfo:"Regenerates 20 health.",action:e=>{e.heal(20)},splashArt:"minor_heal",type:V.RESTORATION,targetType:j.SELF,manaCost:5}),Object.assign(this,e)}cast(e,t){t===nt.player?nt.log("You heal yourself for 20 health points.","#e3c91c"):nt.log(`${t.name.capitalize()} used minor heal to regenerate 20 health points.`,"plum"),this.action(e)}}class J extends U{constructor(e){super({name:"Magic Dart",hoverInfo:"Deals 1-5 damage to a target",action:(e,t)=>{e.damage(t)},splashArt:"magic_dart",type:V.CONJURATION,targetType:j.TARGET,manaCost:3}),Object.assign(this,e)}cast(e,t){let i=k(1,5);e===nt.player?nt.log(`You took ${i} damage from a Magic Dart spell!`,"attack"):nt.log(`Magic Dart blasts the ${e.name} for ${i} magical damage.`,"player_move"),this.action(e,i)}}class X extends U{constructor(e){super({name:"Pain",hoverInfo:"Deals 3-9 negative energy to a target",action:(e,t)=>{e.damage(t)},splashArt:"pain",type:V.NECROMANCY,targetType:j.TARGET,manaCost:3}),Object.assign(this,e)}cast(e,t){let i=A(3,3),a=i>=7?"extreme":"some";e===nt.player?(nt.log(`The ${t.name.capitalize()} casts ${this.name} on ${e.name.toLowerCase()}.`,"plum"),nt.log(`You feel ${a} pain and take ${i} damage.`,"attack")):nt.log(`Pain causes ${a} trauma the ${e.name} for ${i} magical damage.`,"player_move"),this.action(e,i)}}class Z extends U{constructor(e){super({name:"Regeneration",hoverInfo:"Regenerates 5 health per turn by reanimating wounds with necromancy.",action:e=>{e.addNewEffect(new m)},splashArt:"regeneration",type:V.NECROMANCY,targetType:j.SELF,manaCost:3}),Object.assign(this,e)}cast(e,t){t===nt.player?nt.log("You begin regenerating your wounds with dark magic.","player_move"):nt.log(`${t.name.capitalize()} begins regenerating its wounds.`,"plum"),this.action(e)}}class Q extends U{constructor(e){super({name:"Vampiric Draining",hoverInfo:"Drains the health of an enemy for 6-12 damage, healing the caster half of the damage dealt",action:(e,t)=>{e.damage(t)},splashArt:"vampiric_draining",type:V.NECROMANCY,targetType:j.TARGET,manaCost:3}),Object.assign(this,e)}cast(e,t){let i=A(2,6);t===nt.player?(nt.log(`You suck the life energy out of the ${e.name.toLowerCase()}, damaging it for ${i} hp.`,"player_move"),nt.log(`You siphon ${~~(i/2)} hp from the enemy and gain it as health.`,"lightgreen")):(nt.log(`The ${t.name.capitalize()} casts ${this.name} on ${e.name.toLowerCase()}.`,"plum"),nt.log(`You feel your life energy slipping away and take ${i} damage.`,"alert"),nt.log(`The ${t.name.capitalize()} gains ${~~(i/2)} health.`,"plum")),this.action(e,i),t.heal(~~(i/2))}}const ee=e=>{let t=nt.map.data[e.y][e.x];t.removeActor(e);let i=nt.map.actors.indexOf(e);nt.map.actors.splice(i,1),nt.display.removeChild(e);let a=e.id===P.HUMANOID?new G(e.x,e.y,2317):new F(e.x,e.y,2552);a.chasing=!0,t.actors.push(a),nt.display.assignSprite(a),nt.map.actors.push(a),nt.scheduler.add(a,!0)},te=e=>{let t=[];new r.a.FOV.PreciseShadowcasting(function(e,t){return nt.inbounds(e,t)&&nt.map.data[t][e].visible()}).compute(e.x,e.y,e.cb.range,function(e,i,a,s){nt.inbounds(e,i)&&t.push(nt.map.data[i][e])});let i=[];for(let e of t){let t=e.actors.filter(e=>e instanceof B);t.length>0&&i.push(t[0])}return i};class ie extends U{constructor(e){super({name:"Animate Dead",hoverInfo:"Raises all skeletons and corpses within caster's line of sight as undead.",action:e=>{te(e).forEach(e=>{ee(e)})},splashArt:"animate_dead",type:V.NECROMANCY,targetType:j.SELF,manaCost:7}),Object.assign(this,e)}cast(e,t){this.action(t),t===nt.player?nt.log("You raise nearby dead corpses around you into undead zombies and skeletons.","lightgreen"):(nt.log(`The ${t.name.capitalize()} raises nearby corpses as undead minions.`,"plum"),nt.log("The undead begin marching towards you.","plum"))}}function ae(e,t){return!(e<=0||e>=nt.map.width||t<=0||t>=nt.map.height)&&!nt.getTile(e,t).blocked()}class se extends H{constructor(e,t,i){super(e,t,{id:i,name:"you",description:"It's you!",fg:"yellow",bg:"black",visible:!0,targeting:!1,casting:!1,examining:!1,blocked:!0,leveled_up:!0,mouseEnabled:!1,combat:{description:[" attacked "," stabbed "," jabbed "," smashed "],maxhp:50,maxmana:18,xp:50,level:1,hp:50,mana:18,str:1,def:1,hpRecovery:1,manaRecovery:2.5,invulnerable:!1,validTarget:null,currentSpell:null,spells:[],range:7,turnsTaken:0,enemiesKilled:0,damageDealt:0,damageTaken:0,spellsCast:0,potionsConsumed:0,healthRestored:0,dungeonsExplored:0,chestsOpened:0,dead:!1},keyTimer:null}),this.path=new r.a.Path.AStar(this.x,this.y,ae),this.nearbyEnemies=[],this.currentLevel=nt.currentLevel;let a=new b(this.x,this.y,3,1,"Training Sword",32);this.addToInventory(a),super.equipWeapon(this.inventory[0].item),this.addToInventory(z(this.x,this.y,664)),this.addToInventory(new C(this.x,this.y,784,7)),this.addToInventory(new d(this.x,this.y,488)),this.addToInventory(new y(this.x,this.y,608)),this.cb.spells.push(new J),this.cb.spells.push(new K),this.selectSpell(this.cb.spells[0]),this.mouseEnabled=!1,this.commandQueue=[]}selectSpell(e){this.cb.spells.includes(e)&&(this.cb.currentSpell=e)}recalculatePath(){this.path=new r.a.Path.AStar(this.x,this.y,ae)}interact(e){return super.interact(e),"cb"in e&&e.cb.hostile?(this.attack(e),!!e.isDead()||void e.react(this)):(e.react(this),!1)}gain_xp(e){this.cb.xp+=e,o[this.cb.level]<=this.cb.xp&&!this.isDead()&&this.level_up()}remainingXP(){return o[this.cb.level]-this.cb.xp}level_up(){this.cb.level+=1,nt.log(`You leveled up! You are now Level ${this.cb.level}.`,"level_up"),this.cb.level%2==0&&(nt.log("Your strength and health have improved.","level_up"),this.cb.maxhp+=5,this.cb.str+=1),this.cb.hp=this.cb.maxhp,this.cb.mana=this.cb.maxmana}act(){if(super.act(),this.path=new r.a.Path.AStar(this.x,this.y,ae),this.nearbyEnemies=nt.getNearbyEnemies(),this.currentLevel=nt.currentLevel,nt.engine.lock(),this.cb.turnsTaken++,this.cb.turnsTaken%5==0&&this.heal(this.cb.hpRecovery),this.cb.turnsTaken%10==0&&this.restore(this.cb.manaRecovery),this.commandQueue.length>0){let{fn:e}=this.commandQueue.pop();return e(),void nt.engine.unlock()}window.addEventListener("keydown",this),this.mouseEnabled&&(window.addEventListener("mousemove",this),window.addEventListener("click",this))}handleEvent(e){Object.assign(nt.map.seen_tiles,nt.map.visible_tiles),nt.map.visible_tiles={},new r.a.FOV.PreciseShadowcasting((e,t)=>nt.inbounds(e,t)&&nt.getTile(e,t).visible()).compute(nt.player.x,nt.player.y,nt.player.cb.range,(e,t,i,a)=>{nt.map.visible_tiles[e+","+t]=!0});let t=()=>{let e=e=>{this.keyTimer=null};window.removeEventListener("keyup",e),window.removeEventListener("keydown",this),window.removeEventListener("mousemove",this),window.removeEventListener("click",this),window.addEventListener("keyup",e),nt.clearTempLog(),nt.engine.unlock()};const i=()=>{let e=nt.selectedTile,i=this.cb.equipment.ammo,a=this.cb.equipment.weapon.roll()+i.cb.damage+this.cb.str;i.quantity--,0===i.quantity&&nt.log(`You fire your last ${i.type.toLowerCase()}!`,"alert");let s=e.actors.filter(e=>void 0!==e.cb&&e.cb.hostile);if(s.length>0){let e=s[0],t=`${R(this.name).capitalize()} hit ${R(e.name)} with ${R(i.type.toLowerCase())} and dealt ${a} damage.`;nt.log(t,"player_move"),e.damage(a)}else nt.log(`Your ${i.type.toLowerCase()} didn't hit anything!`,"alert");0==i.quantity&&(this.unequipAmmo(),this.removeFromInventory(i)),this.targeting=!1,this.validTarget=null,nt.clearSelectedTile(),t()},a=()=>{let e=nt.selectedTile.actors.filter(e=>void 0!==e.cb&&e.cb.hostile);if(e.length>0){e[0];nt.log(`You cast ${this.cb.currentSpell.name} at the ${e[0].name}.`,"magic"),this.cb.currentSpell.cast(e[0],this)}else nt.log(`You cast ${this.cb.currentSpell.name} but it hits nothing!`,"magic");this.cb.mana-=this.cb.currentSpell.manaCost,this.casting=!1,this.validTarget=null,this.cb.spellsCast++,nt.clearSelectedTile(),t()};if("click"===e.type)return void(this.targeting?this.validTarget?i():nt.log("You cannot shoot this tile because it's blocked or out of range!","alert"):this.casting&&(this.validTarget?a():nt.log(`You cannot cast ${this.cb.currentSpell.name} at this tile because it's blocked or too far away.`,"alert")));if("mousemove"===e.type){let e=nt.eventToTile();return null!==e&&(this.validTarget=nt.changeSelectedTile(e)),setTimeout(()=>{this.mouseMoved=!0},18),void(this.mouseMoved&&(this.mouseMoved=!1))}let s=e.keyCode,n=e.getModifierState("Shift"),o=[0,1,2,3,4,5,6,7],l=[9,61,187,191],c=[101,13,190],h=[70,27,90,88];l.includes(s)&&e.preventDefault();let d={39:2,37:6,38:0,40:4,104:0,105:1,102:2,99:3,98:4,97:5,100:6,103:7,68:2,65:6,87:0,83:4,101:"rest",75:0,85:1,76:2,78:3,74:4,66:5,72:6,89:7,70:"fire",90:"cast",69:"interact",188:"pickup",71:"pickup",190:"rest",88:"examine"};if("keydown"===e.type&&o.includes(d[s]))if(null===this.keyTimer)this.keyTimer=new Date;else{let e=this.keyTimer.getTime();if(!((new Date).getTime()-e>=160))return;this.keyTimer=new Date}if(this.targeting||this.casting||this.examining){let e="";if(h.includes(s))this.targeting&&(e=`You put away your ${this.cb.equipment.weapon.type.toLowerCase()}.`),this.casting&&(e="You stop casting the spell."),this.examining&&(e="You quit examining the area."),nt.log(e,"information"),this.casting=this.targeting=this.examining=!1,nt.clearTempLog(),nt.clearSelectedTile();else if(c.includes(s))if(this.validTarget)this.casting&&a(),this.targeting&&i();else{if(this.casting&&(e=`You cannot cast ${this.cb.currentSpell.name} at this tile because it's blocked or too far away.`),this.targeting&&(e="You cannot shoot this tile because it's blocked or out of range!"),this.examining)return;nt.log(e,"alert")}else if(o.includes(d[s])){let e=r.a.DIRS[8][d[s]],t=nt.selectedTile.x+e[0],i=nt.selectedTile.y+e[1];nt.inbounds(t,i)&&nt.inViewport(t,i)&&(nt.changeSelectedTile(nt.getTile(t,i)),this.validTarget=!nt.selectedTile.blocked()&&void 0!==nt.map.visible_tiles[t+","+i])}else l.includes(s)&&(this.validTarget=nt.cycleThroughSelectableEnemies());return}if(!(s in d))return;const p=d[s];if("rest"!==p||n)if("pickup"!==p||n)if("rest"===p&&n||"pickup"===p&&n||"interact"===p)this.climb();else{if("fire"===p&&!n){let e=this.cb.equipment.weapon,t=this.cb.equipment.ammo;return null!==e&&null!==t&&e.cb.ranged&&t.cb.ammoType===e.cb.ammoType&&t.quantity>0?(nt.log(`You take aim with your ${e.type.toLowerCase()}.`,"information"),nt.log(`Select a target with the movement keys and press [enter] or [.] to fire your ${e.type.toLowerCase()}.`,"player_move"),this.validTarget=nt.selectNearestEnemyTile(),this.validTarget||nt.changeSelectedTile(nt.getTile(this.x,this.y)),void(this.targeting=!0)):void(null!==e&&e.cb.ranged?null===t?nt.log("You don't have any ammunition equipped.","information"):t.cb.ammoType!==e.cb.ammoType&&nt.log("You don't have the right ammunition equipped for this weapon.","information"):nt.log("You don't have a ranged weapon equipped!","information"))}if("cast"===p){let e=this.cb.currentSpell;if(null===e)return void nt.log("You must select a spell to cast. Select one from the spellbook!","information");if(e.manaCost>this.cb.mana)return void nt.log(`You don't have enough mana to cast ${e.name}!`,"alert");if(e.targetType===j.SELF)nt.log(`You cast ${e.name}.`,"magic"),e.cast(this,this),this.cb.mana-=e.manaCost;else if(e.targetType===j.TARGET)return nt.log("You begin casting a spell.","defend"),nt.log("Select a target with the movement keys and press [enter] or [.] to cast the spell.","player_move"),this.validTarget=nt.selectNearestEnemyTile(),this.validTarget||nt.changeSelectedTile(nt.getTile(this.x,this.y)),void(this.casting=!0)}else{if("examine"===p)return nt.log("You begin examining the area.","information"),this.examining=!0,void nt.changeSelectedTile(nt.getTile(this.x,this.y));{let e=r.a.DIRS[8][p],t=this.x+e[0],i=this.y+e[1];if(!this.tryMove(t,i))return}}}else this.pickup();else nt.log("You rest for a turn.","player_move");t()}pickup(){let e=nt.map.data[this.y][this.x],t=e.actors.filter(e=>e instanceof c);if(1===t.length)nt.log(`You picked up a ${t[0].type.toLowerCase()}.`,"information"),nt.display.clearSprite(t[0]),this.addToInventory(t[0]),e.removeActor(t[0]);else if(t.length>1){let i=[];for(let a of t)i.push(a.type.toLowerCase()),nt.display.clearSprite(a),this.addToInventory(a),e.removeActor(a);let a=i.slice(1,i.length-1),s=`You picked up ${(a=a.reduce((e,t)=>e+", a "+t,"a  "+i.slice(0,1)))+` and a ${i.slice(-1)}.`}`;nt.log(s,"information")}else nt.log("There's nothing to pick up.","information")}equipWeapon(e){super.equipWeapon(e),nt.log(`You wield the ${e.type.toLowerCase()}.`,"information")}unequipWeapon(){if(null===this.cb.equipment.weapon)throw"Tried to uneqip weapon but no item was equipped.";this.cb.equipment.weapon.cb.equipped=!1,this.cb.equipment.weapon=null}unequipAmmo(){if(null===this.cb.equipment.ammo)throw"Tried to uneqip ammo but no item was equipped.";this.cb.equipment.ammo.cb.equipped=!1,this.cb.equipment.ammo=null}climb(){let e=nt.map.data[this.y][this.x].actors.filter(e=>e instanceof N)[0];void 0===e?nt.log("There are no steps or ladders here to use!","information"):e.react(this)}tryMove(e,t){if(!nt.inbounds(e,t))return;let i=nt.getTile(e,t);if(0===i.actors.length&&!i.blocked())return this.move(e,t),nt.clearSelectedTile(),!0;if(i.actors.length>0)for(let e=0;e<i.actors.length;e++){let t=i.actors[e];if(t.blocked)return this.interact(t),!0}return!i.blocked()&&(this.move(e,t),nt.clearSelectedTile(),!0)}attack(e){super.attack(e)}death(){super.death(),window.removeEventListener("keydown",this),this.cb.hp=0,this.cb.dead=!0,nt.scheduler.clear()}}class re{constructor(e,t){this.x=e,this.y=t,this.actors=[],this.obstacles=[]}updateTileInfo(e,t=null){let i={};e in nt.display.tileset.tileproperties&&(i=function(e){return nt.display.tileset.tileproperties[e+""]}(e)),i.id=e,i.tint=t,this.obstacles.push(i)}blocked(){return this.obstacles.length>0&&this.obstacles[this.obstacles.length-1].blocked}visible(){return!(this.obstacles.some(e=>e.blocks_vision)||this.actors.some(e=>!e.visible))}removeActor(e){let t=this.actors.findIndex(t=>Object.is(e,t));this.actors.splice(t,1)}bg(){let e=this.obstacles;if(!e.some(e=>"bg"in e))return"black";for(let t=e.length-1;t>=0;t--){let i=e[t];if("bg"in i)return i.bg}}}class ne extends c{constructor(e,t,i){super(e,t,{id:i,type:"Key"})}hoverInfo(){return""}}class oe extends l{constructor(e,t,i){super(e,t,{id:i,name:"path",description:"A path leading to a new area!",fg:"brown",bg:"orange",blocked:!0,visible:!0}),this.portal=null}act(){}react(e){nt.log(`You leave the ${nt.currentLevel.name} and go to the ${this.portal}.`,"information"),nt.changeLevels(this.portal)}}var le=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e};class ce extends c{constructor(e,t,i,a){super(e,t,le({id:i,action:"Read",type:"Spellbook"},a))}use(){for(let e of this.spells)nt.player.cb.spells.some(t=>t.name===e.name)||nt.player.cb.spells.push(e);nt.player.removeFromInventory(this)}hoverInfo(){}}class he extends H{constructor(e,t,i){super(e,t,{id:i,name:"non-player character",visible:!0,blocked:!0,combat:{hostile:!1}}),this.wanders=!1}act(){if(Game.engine.lock(),this.wanders&&1===k(1,2)){let e=this.x+k(-1,1),t=this.y+k(-1,1);this.tryMove(e,t)}Game.engine.unlock()}}class de extends Y{constructor(e,t,i,a=!1){let s=k(30,35),r=k(5,10);if(super(e,t,{id:i,name:a?"Empowered Orc":"orc",description:"All bronze and no brains!",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:s,maxmana:5,hp:s,mana:5,str:r,def:1,hostile:!0,range:9,invulnerable:!1,empowered:a}},!1),k(1,10)<5){M({minItems:0,maxItems:2,dropTable:{STRENGTH_POTION:1,HEALTH_POTION:1,STEEL_ARROW:1,MANA_POTION:1,SWORD:1},x:this.x,y:this.y}).forEach(e=>this.addToInventory(e))}}interact(e){if(e===nt.player){let t=this.attack(e);if(this.cb.empowered){let e=Math.floor(t/2);nt.log(`The empowered orc steals your health and regenerates ${e} health!`,"alert"),this.heal(e)}}else e.react(this)}}class pe extends Y{constructor(e,t,i,a=!1){let s=k(20,25);super(e,t,{id:i,name:"Kobold",description:"A cold-blooded kobold!",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:s,maxmana:5,hp:s,mana:5,str:k(5,7),def:1,hostile:!0,range:9,invulnerable:!1}}),M({minItems:0,maxItems:2,dropTable:{STRENGTH_POTION:1,HEALTH_POTION:1,STEEL_ARROW:2,SWORD:1},x:this.x,y:this.y}).forEach(e=>this.addToInventory(e))}}class me extends W{constructor(e,t,i){let a=k(6,9);if(super(e,t,{id:i,name:"goblin",description:"A mean, green goblin!",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:a,maxmana:5,hp:a,mana:5,str:k(1,3),def:1,hostile:!0,range:9,invulnerable:!1}},{morale:.2,minPlayerDist:0,maxPlayerDist:0,ranged:!1,melee:!0,magic:!1,wanders:!0}),k(1,10)<2){M({minItems:0,maxItems:1,dropTable:{STRENGTH_POTION:3,HEALTH_POTION:2,MANA_POTION:2,STEEL_ARROW:2,SWORD:0},x:this.x,y:this.y}).forEach(e=>this.addToInventory(e))}}}class ue extends W{constructor(e,t,i){let a=k(4,8);super(e,t,{id:i,name:"bat",description:"A creature of the night!",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:a,maxmana:5,hp:a,mana:5,str:k(1,2),def:1,hostile:!0,range:9,invulnerable:!1}},{morale:.4,minPlayerDist:0,maxPlayerDist:0,ranged:!1,melee:!0,magic:!1,wanders:!0})}}class ge extends Y{constructor(e,t,i){super(e,t,{id:i,name:"rat",description:"A fat rat!",symbol:"r",fg:"grey",bg:"seagreen",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:3,maxmana:0,hp:3,mana:0,str:1,def:0,hostile:!0,range:4,invulnerable:!1}})}}class ve extends Y{constructor(e,t,i){super(e,t,{id:i,name:"snake",description:"A sneaky snake!",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:7,maxmana:5,hp:7,mana:5,str:4,def:1,hostile:!0,range:9,invulnerable:!1}},!0)}}const ye={HEALTH_POTION:(e,t,i)=>new d(e,t,i),STRENGTH_POTION:(e,t,i)=>new v(e,t,i),MANA_POTION:(e,t,i)=>new y(e,t,i),SWORD:(e,t,i)=>x(e,t,i),BOW:(e,t,i)=>createBow(e,t,i),STEEL_ARROW:(e,t,i)=>new C(e,t,i,5),KEY:(e,t,i)=>new ne(e,t,i),NECROMANCY_SPELLBOOK:(e,t,i)=>new class extends ce{constructor(e,t,i){super(e,t,i,{spells:[new X,new Q,new ie,new Z],name:"Book of Death"})}use(){super.use(),nt.log("You have learned necromancy spells...but at what cost?","lightgreen")}}(e,t,i)};function fe(e,t,i,a=null){const s=null===a?{KEY:24,HEALTH_POTION:488,MANA_POTION:608,STRENGTH_POTION:969,SWORD:35,BOW:664,STEEL_ARROW:784,NECROMANCY_SPELLBOOK:3264}[e]:a;return e in ye?ye[e](t,i,s):(console.error(`Tried to create an item without an entry: ${e} with ID: ${a}`),null)}const be={ORC:[5292,5293,5294,5295,5296,5297,5299],EMPOWERED_ORC:[5298],GOBLIN:[7440,7441,7442,7443,7444,7445,7446],RAT:[2365],BAT:[3704,3706],KOBOLD:[5532,5533,5534,5535,5536,5537,5538,5539],SKELETON:[2552,2553,2554,2555],ZOMBIE:[2314,2317],TROLL:[9481,9480],MUMMY:[2432,2433,2434,2435,2436,2437,2438,2439],GHOST:[2792,2793,2794],ICE_ELEMENTAL:[2460,2461],GOLEM:[2457],IMP:[5412,5413],SNAKE:[4360,4361,4362,4363,4364,4365,4366,4367],SIREN:[2289,2295],VAMPIRE:[2672],MINOTAUR:[7080],CYCLOPS:[7081],BANSHEE:[3154],DEMON:[2409,2410,2411,2412,2413,2414,2415],BONE_MAN:[3392,3393]},we={NPC:(e,t,i)=>new he(e,t,i),LEVEL_TRANSITION:(e,t,i)=>new oe(e,t,i),CHEST:(e,t,i)=>new $(e,t,i),DOOR:(e,t,i)=>new D(e,t,i),LOCKED_DOOR:(e,t,i)=>new class extends D{constructor(e,t,i){super(e,t,i),this.name="locked door"}react(e){if(this.closed&&e===nt.player){let t=e.items().filter(e=>e instanceof ne);0===t.length?nt.log("You need a key to open this door.","alert"):(nt.log("You use a key to unlock the door.","player_move"),e.removeFromInventory(t[0]),this.openDoor())}}}(e,t,i),LADDER:(e,t,i)=>new N(e,t,i),ORC:(e,t,i)=>new de(e,t,i),EMPOWERED_ORC:(e,t,i)=>new de(e,t,i,!0),KOBOLD:(e,t,i)=>new pe(e,t,i),GOBLIN:(e,t,i)=>new me(e,t,i),BAT:(e,t,i)=>new ue(e,t,i),RAT:(e,t,i)=>new ge(e,t,i),SNAKE:(e,t,i)=>new ve(e,t,i),SKELETON:(e,t,i)=>new F(e,t,i),ZOMBIE:(e,t,i)=>new G(e,t,i),TROLL:(e,t,i)=>new class extends Y{constructor(e,t,i){super(e,t,{id:i,name:"troll",description:"A large, strong and stupid creature.",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:45,maxmana:5,hp:45,mana:5,str:12,def:1,hostile:!0,range:9,invulnerable:!1}},!0)}}(e,t,i),MUMMY:(e,t,i)=>new class extends Y{constructor(e,t,i){super(e,t,{id:i,name:"mummy",description:"A mummified undead, wrapped in linen!",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:40,maxmana:5,hp:40,mana:5,str:5,def:1,hostile:!0,range:9,invulnerable:!1}},!0)}}(e,t,i),GHOST:(e,t,i)=>new class extends Y{constructor(e,t,i){super(e,t,{id:i,name:"ghost",description:"A dead soul trapped in this coporeal realm.",visible:!0,blocked:!0,chasing:!1,corpseType:null,combat:{description:[" attacked "],maxhp:35,maxmana:5,hp:35,mana:5,str:3,def:1,hostile:!0,range:9,invulnerable:!1}},!0)}}(e,t,i),ICE_ELEMENTAL:(e,t,i)=>new class extends Y{constructor(e,t,i){super(e,t,{id:i,name:"Ice Elemental",description:"A living icicle!",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:25,maxmana:5,hp:25,mana:5,str:15,def:1,hostile:!0,range:9,invulnerable:!1}},!0)}}(e,t,i),GOLEM:(e,t,i)=>new class extends Y{constructor(e,t,i){super(e,t,{id:i,name:"golem",description:"A towering being made of magical minerals.",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:55,maxmana:5,hp:55,mana:5,str:15,def:1,hostile:!0,range:9,invulnerable:!1}},!0)}}(e,t,i),IMP:(e,t,i)=>new class extends Y{constructor(e,t,i){super(e,t,{id:i,name:"imp",description:"A small, mischevious demon.",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:15,maxmana:5,hp:15,mana:5,str:5,def:1,hostile:!0,range:9,invulnerable:!1}},!0)}}(e,t,i),SNAKE:(e,t,i)=>new ve(e,t,i),SIREN:(e,t,i)=>new class extends Y{constructor(e,t,i){super(e,t,{id:i,name:"siren",description:"A beautiful woman...serpent with wings",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:40,maxmana:5,hp:40,mana:5,str:8,def:1,hostile:!0,range:9,invulnerable:!1}},!0)}}(e,t,i),BANSHEE:(e,t,i)=>new class extends Y{constructor(e,t,i){super(e,t,{id:i,name:"banshee",description:"A cursed female spirit.",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:50,maxmana:5,hp:50,mana:5,str:8,def:1,hostile:!0,range:9,invulnerable:!1}})}}(e,t,i),VAMPIRE:(e,t,i)=>new class extends Y{constructor(e,t,i){super(e,t,{id:i,name:"vampire",description:"A powerful sorcerer of blood magicks.",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:70,maxmana:5,hp:70,mana:5,str:22,def:1,hostile:!0,range:9,invulnerable:!1}},!0)}}(e,t,i),MINOTAUR:(e,t,i)=>new class extends Y{constructor(e,t,i){super(e,t,{id:i,name:"minotaur",description:"A hateful beast with the head of a bull and body of a man!",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:60,maxmana:5,hp:60,mana:5,str:16,def:1,hostile:!0,range:9,invulnerable:!1}},!0)}}(e,t,i),CYCLOPS:(e,t,i)=>new class extends Y{constructor(e,t,i){super(e,t,{id:i,name:"cyclops",description:"A massive beast with one eye!",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:55,maxmana:5,hp:55,mana:5,str:14,def:1,hostile:!0,range:9,invulnerable:!1}})}}(e,t,i),DEMON:(e,t,i)=>new class extends Y{constructor(e,t,i){super(e,t,{id:i,name:"demon",description:"A spiritual being from an evil plane.",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:35,maxmana:5,hp:35,mana:5,str:6,def:1,hostile:!0,range:9,invulnerable:!1}},!0)}}(e,t,i),BONE_MAN:(e,t,i)=>new class extends Y{constructor(e,t,i){super(e,t,{id:i,name:"bone man",description:"A mysterious creature with a skull for a head.",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:70,maxmana:5,hp:15,mana:5,str:7,def:1,hostile:!0,range:9,invulnerable:!1}},!0)}}(e,t,i),ZOMBIE_CORPSE:(e,t,i)=>new B(e,t,"undead",i),SKELETON_CORPSE:(e,t,i)=>new B(e,t,"Skeleton",i),LICH:(e,t,i)=>new class extends H{constructor(e,t,i){super(e,t,{id:i,name:"Lich",description:"Once a powerful necromancer, now transformed into a lich.",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:40,maxmana:25,hp:40,mana:25,str:15,def:5,hostile:!0,range:7,invulnerable:!1}}),this.spells={regeneration:new Z({cd:0,maxCD:15}),pain:new X({cd:0,maxCD:2}),vampiricDraining:new Q({cd:0,maxCD:5}),animateDead:new ie({cd:0,maxCD:7})}}act(){nt.engine.lock();for(let e in this.spells)this.spells[e].cd=0===this.spells[e].cd?0:this.spells[e].cd-1;let e=Math.abs(this.x-nt.player.x),t=Math.abs(this.y-nt.player.y);if(e>nt.width/2||t>nt.height/2)return nt.engine.unlock(),void super.act();this.intro||(nt.log("You feel a sense of hopelessness and fear come over you.","crimson"),nt.log("Something evil is nearby.","crimson")),this.intro=!0,nt.player.recalculatePath();let i=[];if(I(this).reduce((e,t)=>e.concat(t.actors),[]).some(e=>e===nt.player)){this.chasing||nt.log(`A ${this.name} sees you.`,"alert"),this.chasing=!0,nt.player.path.compute(this.x,this.y,function(e,t){i.push([e,t])});let e=this.cb.maxhp-this.cb.hp,t=te(this);const a=e=>{e.cd=e.maxCD};if(2===i.length)if(nt.player.cb.hp<=15){let e=i[1];this.tryMove(e[0],e[1])}else if(e>=10&&0===this.spells.vampiricDraining.cd)this.spells.vampiricDraining.cast(nt.player,this),a(this.spells.vampiricDraining);else if(e>=25&&0===this.spells.regeneration.cd)this.spells.regeneration.cast(this,this),a(this.spells.regeneration);else if(t.length>=2&&0===this.spells.animateDead.cd)this.spells.animateDead.cast(this,this),a(this.spells.animateDead);else{let e=i[1];this.tryMove(e[0],e[1])}else nt.player.cb.hp<=9&&0===this.spells.pain.cd?(this.spells.pain.cast(nt.player,this),a(this.spells.pain)):t.length>=2&&0===this.spells.animateDead.cd?(this.spells.animateDead.cast(this,this),a(this.spells.animateDead)):e>=25&&0===this.spells.regeneration.cd?(this.spells.regeneration.cast(this,this),a(this.spells.regeneration)):0===this.spells.pain.cd&&(this.spells.pain.cast(nt.player,this),a(this.spells.pain))}else{let e=this.x+k(-1,1),t=this.y+k(-1,1);this.tryMove(e,t)}nt.engine.unlock(),super.act()}interact(e){e===nt.player?this.attack(e):e.react(this)}}(e,t,i)};function xe(e,t,i,a=null){let s=a;if(null===a){let t=be[e];s=t[k(0,t.length-1)]}return e in we?we[e](t,i,s):(console.error(`Tried to create entity without an entry: ${e} with ID: ${a}`),null)}function _e(e,t){let{layers:i,width:a,height:s}=e,r=new Te(a,s,t);return r.createFromJSON(e),r.revealed=!0,r.type="static",r}class Te{constructor(e,t,i){this.name=i,this.loadedIDS=[],this.playerLocation=null,this.width=e,this.height=t,this.actors=[],this.data=new Array(this.height),this.visible_tiles={},this.seen_tiles={},this.visited=!1;for(let e=0;e<this.height;e++){this.data[e]=new Array(this.width);for(let t=0;t<this.width;t++)this.data[e][t]=new re(t,e)}}getTile(e,t){return this.data[t][e]}createFromJSON({layers:e}){for(let t of e)if("tilelayer"===t.type)this.processTileLayer(t);else{if("objectgroup"!==t.type)throw"A layer has been added to the map and is invalid";this.processObjectGroupLayer(t)}}processTileLayer(e){for(let t=0;t<this.height;t++)for(let i=0;i<this.width;i++){let a=e.data[t*this.width+i]-1;a>1&&(nt.loadedIDS.push(a),this.data[t][i].updateTileInfo(a))}}createActorFromObject(e){const{gid:t,x:i,y:a,properties:s}=e;if(void 0===s.entity_type)return void console.error(`No entity type given in properties for object ${e}`);const{entity_type:r}=s;let n=i/32,o=a/32-1,l=s.item?fe(r,n,o,t-1):xe(r,n,o,t-1);if(s.item&&(l.inInventory=!1),void 0!==s.items){s.items.split(",").map(e=>fe(e.trim(),n,o)).forEach(e=>l.addToInventory(e))}"NPC"===r?l.wanders=s.wanders:"LADDER"!==r&&"LEVEL_TRANSITION"!==r||(l.portal=s.portalID,l.createDungeon=s.createDungeon,"LADDER"===r&&(l.direction=s.direction)),this.actors.push(l),this.getTile(n,o).actors.push(l)}processObjectGroupLayer(e){for(let t of e.objects)"PLAYER"===t.properties.entity_type?this.playerLocation=[t.x/32,t.y/32-1]:this.createActorFromObject(t)}}const Se={ORC:[5292,5293,5294,5295,5296,5297,5299],EMPOWERED_ORC:[5298],GOBLIN:[7440,7441,7442,7443,7444,7445,7446],RAT:[2365],BAT:[3704,3706],KOBOLD:[5532,5533,5534,5535,5536,5537,5538,5539]},Ce=e=>e.reduce((e,t)=>e.concat(Array.isArray(t)?Ce(t):t),[]),ke=e=>{let t=k(0,e.length),i=e.splice(t,1);return 1===i.length?i[0].split(",").map(e=>Number(e)):null};const Ee={RUINS:{tint:null,mobDistribution:{ORC:1,GOBLIN:15,BAT:10,RAT:15,SNAKE:10},type:"RUINS",textures:{floor:{upperLeft:7736,top:7737,upperRight:7738,left:7856,center:7857,right:7858,lowerLeft:7976,bottom:7977,lowerRight:7978,endLeft:7860,middleCorridorHorizontal:7861,endRight:7862,endTop:7739,middleCorridorVertical:7859,endBottom:7979,single:7740},corridorFloor:{horizontal:{left:7861,middle:7862,right:7863},vertical:{top:7740,middle:7860,bottom:7980}},walls:{upperLeft:8117,top:8118,upperRight:8119,left:8237,center:8238,right:8237,lowerLeft:8357,bottom:8118,lowerRight:8359,endBottom:8238,endTop:8239,island:8120,leftT:8242,middleT:8241,rightT:8240,topT:8121,bottomT:8361},doors:{vertical:569,horizontal:568}}},CATACOMBS:{type:"CATACOMBS",tint:null,mobDistribution:{ZOMBIE:30,SKELETON:30,MUMMY:30,GHOST:10,BANSHEE:5,VAMPIRE:1},textures:{floor:{upperLeft:8096,top:8097,upperRight:8098,left:8216,center:8217,right:8218,lowerLeft:8336,bottom:8337,lowerRight:8338,endLeft:8220,middleCorridorHorizontal:8221,endRight:8222,endTop:8099,middleCorridorVertical:8219,endBottom:8339,single:8100},corridorFloor:{horizontal:{left:8221,middle:8222,right:8223},vertical:{top:8100,middle:8220,bottom:8340}},walls:{upperLeft:8477,top:8478,upperRight:8479,left:8597,center:8598,right:8597,lowerLeft:8717,bottom:8478,lowerRight:8719,endBottom:8598,endTop:8599,island:8480,leftT:8602,middleT:8601,rightT:8600,topT:8481,bottomT:8721},doors:{vertical:569,horizontal:568}}},MINE:{type:"MINE",tint:null,mobDistribution:{KOBOLD:2,MINOTAUR:1,GOBLIN:5,ORC:5,EMPOWERED_ORC:5,BONE_MAN:10,GOLEM:1},textures:{floor:{upperLeft:9176,top:9177,upperRight:9178,left:9296,center:9297,right:9298,lowerLeft:9416,bottom:9417,lowerRight:9418,endLeft:9300,middleCorridorHorizontal:9301,endRight:9302,endTop:9179,middleCorridorVertical:9299,endBottom:9419,single:9180},corridorFloor:{horizontal:{left:9301,middle:9302,right:9303},vertical:{top:9180,middle:9300,bottom:9420}},walls:{upperLeft:7771,top:7772,upperRight:7773,left:7891,center:7892,right:7891,lowerLeft:8011,bottom:7772,lowerRight:8013,endBottom:7892,endTop:7893,island:7774,leftT:7896,middleT:7895,rightT:7894,topT:7775,bottomT:8015},doors:{vertical:569,horizontal:568}}},ICE:{type:"ICE",tint:null,mobDistribution:{CYCLOPS:1,TROLL:3,MINOTAUR:1,ICE_ELEMENTAL:3,SKELETON:20,IMP:10,SIREN:1},textures:{floor:{upperLeft:7376,top:7377,upperRight:7378,left:7496,center:7497,right:7498,lowerLeft:7616,bottom:7617,lowerRight:7618,endLeft:7500,middleCorridorHorizontal:7501,endRight:7502,endTop:7379,middleCorridorVertical:7499,endBottom:7619,single:7380},corridorFloor:{horizontal:{left:7501,middle:7502,right:7503},vertical:{top:7380,middle:7500,bottom:7620}},walls:{upperLeft:7757,top:7758,upperRight:7759,left:7877,center:7878,right:7877,lowerLeft:7997,bottom:7758,lowerRight:7999,endBottom:7878,endTop:7879,island:7760,leftT:7882,middleT:7881,rightT:7880,topT:7761,bottomT:8001},doors:{vertical:569,horizontal:568}}},HELL:{type:"HELL",tint:"0xba1b21",mobDistribution:{ORC:2,EMPOWERED_ORC:1,KOBOLD:1,GOBLIN:7,BAT:10,RAT:10},textures:{floor:{upperLeft:7736,top:7737,upperRight:7738,left:7856,center:7857,right:7858,lowerLeft:7976,bottom:7977,lowerRight:7978,endLeft:7860,middleCorridorHorizontal:7861,endRight:7862,endTop:7739,middleCorridorVertical:7859,endBottom:7979,single:7740},corridorFloor:{horizontal:{left:7861,middle:7862,right:7863},vertical:{top:7740,middle:7860,bottom:7980}},walls:{upperLeft:8117,top:8118,upperRight:8119,left:8237,center:8238,right:8237,lowerLeft:8357,bottom:8118,lowerRight:8359,endBottom:8238,endTop:8239,island:8120,leftT:8242,middleT:8241,rightT:8240,topT:8121,bottomT:8361},doors:{vertical:569,horizontal:568}}}},Oe={up:477,down:479},Re=57;let Le=(e,t,i)=>{let a=0,s=`${e},${t-1}`,r=`${e},${t+1}`,n=`${e-1},${t}`,o=`${e+1},${t}`,l=`${e+1},${t-1}`,c=`${e-1},${t+1}`,h=`${e-1},${t-1}`,d=`${e+1},${t+1}`,p=e=>e in i;if(p(s)&&(a+=1),p(o)&&(a+=2),p(r)&&(a+=4),p(n)&&(a+=8),0==a){if(p(h))return 16;if(p(l))return 17;if(p(c))return 18;if(p(d))return 19}return a},Ae=(e,t,i)=>{let a=0,s=`${e},${t-1}`,r=`${e},${t+1}`,n=`${e-1},${t}`,o=`${e+1},${t}`,l=`${e+1},${t-1}`,c=`${e-1},${t+1}`,h=`${e-1},${t-1}`,d=`${e+1},${t+1}`,p=e=>e in i;if(p(s)&&(a+=1),p(o)&&(a+=2),p(r)&&(a+=4),p(n)&&(a+=8),p(s)&&!p(r)&&!p(o)&&!p(n)&&(p(c)||p(d)))return 20;if(0==a){if(p(h))return 16;if(p(l))return 17;if(p(c))return 18;if(p(d))return 19}return a};const Me=e=>{let t=k(0,e.length),i=e.splice(t,1);return 1===i.length?i[0].split(",").map(e=>Number(e)):null},Ie=(e,t)=>{return{0:e.single,1:e.endBottom,2:e.endLeft,3:e.lowerLeft,4:e.endTop,5:e.middleCorridorVertical,6:e.upperLeft,7:e.left,8:e.endRight,9:e.lowerRight,10:e.middleCorridorHorizontal,11:e.bottom,12:e.upperRight,13:e.right,14:e.top,15:e.center,16:e.single,17:e.single,18:e.single,19:e.lowerLeft}[t]},De=(e,t)=>{return{0:7026,1:e.bottom,2:e.left,3:e.upperRight,4:e.top,5:e.top,6:e.lowerRight,7:e.bottom,8:e.right,9:e.upperLeft,10:e.left,11:e.endTop,12:e.lowerLeft,13:e.bottom,14:e.endBottom,15:e.center,16:e.lowerRight,17:e.lowerLeft,18:e.upperRight,19:e.upperLeft,20:e.middleT}[t]};function $e(e,t,i,a,s,n=!0){let{dungeonName:o,lastDungeon:l,fromPortal:c,toPortal:h,level:d}=s,p=new Te(e,t,o);const{tint:m,type:u,textures:g,mobDistribution:v}=i,{floor:y,corridorFloor:f,walls:b,doors:w}=g;let x=0,_={},T=a.create((e,t,i)=>{i||(_[e+","+t]=!0)});for(let e of T.getRooms())e.getDoors((e,t)=>{_[e+","+t]=!0});for(let i=0;i<t;i++)for(let t=0;t<e;t++){let e=p.getTile(t,i);if(`${t},${i}`in _){let a=Ie(y,Le(t,i,_));e.updateTileInfo(a,m)}else{let a=De(b,Ae(t,i,_));e.updateTileInfo(a,m)}}for(let e of T.getRooms()){let t=e.getLeft()-1,i=e.getRight()+1,a=e.getTop()-1,s=e.getBottom()+1,o=e.getLeft(),c=e.getRight(),d=e.getTop(),m=e.getBottom(),u={y:~~((d+m)/2),x:~~((c+o)/2)};if(1===k(1,2)&&n&&e.getDoors((e,t)=>{let i,a=Object.values(f.vertical)+Object.values(y)+Object.values(f.horizontal)+Object.values(y),s=p.getTile(e,t-1).obstacles[0].id,r=p.getTile(e,t+1).obstacles[0].id;i=a.includes(s)&&a.includes(r)?new D(e,t,w.horizontal):new D(e,t,w.vertical),p.getTile(e,t).actors.push(i),p.actors.push(i)}),x<1)if(l){let e=new oe(u.x,u.y,1169);e.portal=h,p.getTile(u.x,u.y).actors.push(e),p.actors.push(e),x++}else{let e=Oe.down,t=new N(u.x,u.y,e,"down",h);p.getTile(u.x,u.y).actors.push(t),p.actors.push(t),x++}let g=[];Object.values(b);for(let e=d;e<m;e++)for(let t=o;t<c;t++)p.getTile(t,e).blocked()||0!==p.getTile(t,e).actors.length||g.push(t+","+e);let _=i-t,T=s-a,S=E(_>7&&T>7?3:1,_>6&&T>6?5:3);for(let e=0;e<S;e++){let e=Me(g);if(null===e)break;let[t,i]=e,a=xe(r.a.RNG.getWeightedValue(v),t,i);p.getTile(t,i).actors.push(a),p.actors.push(a)}if(S>=4){let e=Me(g);if(null!==e){let[t,i]=e,a=new $(t,i,Re);M({minItems:1,maxItems:3,dropTable:{STRENGTH_POTION:1,HEALTH_POTION:1,STEEL_ARROW:1,MANA_POTION:1,SWORD:10},x:a.x,y:a.y}).forEach(e=>a.addToInventory(e)),p.getTile(t,i).actors.push(a),p.actors.push(a)}}}let S=function(e){let t=Object.keys(e);return t[Math.floor(t.length*Math.random())]}(_).split(","),[C,O]=S.map(e=>parseInt(e));p.playerLocation=[C,O];let R=new N(C,O,Oe.up,"up",c);return p.getTile(C,O).actors.push(R),p.actors.push(R),p.revealed=!1,p.type="dungeon",p.depth=d,p}var Ne=i("wG9/"),Pe=i.n(Ne),Be=i("d+bC"),He=i.n(Be);class qe extends W{constructor(e,t,i){let a=k(4,8);super(e,t,{id:i,name:"wild goat",description:"A really pissed off goat!",visible:!0,blocked:!0,chasing:!1,combat:{description:[" headbutted "," rammed "],maxhp:a,maxmana:5,hp:a,mana:5,str:k(1,2),def:1,hostile:!0,range:9,invulnerable:!1}},{morale:.4,minPlayerDist:0,maxPlayerDist:0,ranged:!1,melee:!0,magic:!1,wanders:!0})}}const ze={OLD_BEACH:{type:"OLD_BEACH",textures:{upperLeft:8816,top:8817,upperRight:8818,left:8936,center:8937,right:8938,lowerLeft:9056,bottom:9057,lowerRight:9058,endLeft:8940,middleCorridorHorizontal:8941,endRight:8942,endTop:8819,middleCorridorVertical:8939,endBottom:9059,single:8937}},BEACH:{type:"BEACH",textures:{upperLeft:8830,top:8831,upperRight:8832,left:8950,center:8951,right:8952,lowerLeft:9070,bottom:9071,lowerRight:9072,endLeft:8954,middleCorridorHorizontal:8955,endRight:8956,endTop:8833,middleCorridorVertical:8953,endBottom:9073,single:8951}},OCEAN_WATER:{type:"OCEAN_WATER",textures:{upperLeft:9017,top:9017,upperRight:9017,left:9017,center:9017,right:9017,lowerLeft:9017,bottom:9017,lowerRight:9017,endLeft:9017,middleCorridorHorizontal:9017,endRight:9017,endTop:9017,middleCorridorVertical:9017,endBottom:9017,single:9017}},COASTAL_WATER:{type:"COASTAL_WATER",textures:{upperLeft:8176,top:8177,upperRight:8178,left:8296,center:8297,right:8298,lowerLeft:8296,bottom:8297,lowerRight:8298,endLeft:8296,middleCorridorHorizontal:8177,endRight:8178,altUpperRight:8181,endTop:8177,middleCorridorVertical:8298,endBottom:8296,single:8178}},FOREST:{type:"FOREST",textures:{hasCorridors:!0,upperLeft:7743,top:7744,upperRight:7745,left:7863,center:7864,right:7865,lowerLeft:7983,bottom:7984,lowerRight:7985,endLeft:7867,middleCorridorHorizontal:7868,endRight:7869,endTop:7746,middleCorridorVertical:7866,endBottom:7986,single:7748}},MOUNTAIN:{type:"MOUNTAIN",textures:{upperLeft:9197,top:9198,upperRight:9199,left:9317,right:9317,lowerLeft:9437,bottom:9198,lowerRight:9439,endLeft:9198,middleCorridorHorizontal:9198,endRight:9198,endTop:9198,middleCorridorVertical:9200,endBottom:9198,middleT:9201,middleIntersection:9321}},SNOW:{type:"SNOW",textures:{}}},We={ORC:[5292,5293,5294,5295,5296,5297,5299],EMPOWERED_ORC:[5298],GOBLIN:[7440,7441,7442,7443,7444,7445,7446],RAT:[2362,2363,2365,2366],BAT:[3704,3706],KOBOLD:[5532,5533,5534,5535,5536,5537,5538,5539],WILD_GOAT:[2600,2601,2602,2603,2604,2605]},Ye=1242,Fe=1243,Ge=1362,Ve=1363,je=1722,Ue=1726,Ke=1724,Je=7355,Xe=1482,Ze=1483,Qe=1484,et=1485;var tt={randomCave:function(e,t,i,a=1){let s={revealed:!0};s.width=e,s.height=t,s.layers=[{data:[],properties:{obstacles:!0}},{data:[],properties:{obstacles:!0}},{data:[],properties:{actors:!0}},{data:[],properties:{actors:!0}}];let n={},o=new r.a.Map.Cellular(e,t);o.randomize(.5);for(let e=0;e<10;e++)o.create();o.connect(function(e,t,i){i||(n[e+","+t]=!0)});for(let i=0;i<t;i++){for(let e=0;e<s.layers.length;e++)s.layers[e].data.push([]);for(let t=0;t<e;t++)t+","+i in n?s.layers[0].data[i].push(9298):s.layers[0].data[i].push(9201),s.layers[1].data[i].push(0),s.layers[2].data[i].push(0),s.layers[3].data[i].push(0)}let l=9197,c=9198,h=9199,d=9317,p=9437,m=9198,u=9439,g={upperLeft:9176,top:9177,upperRight:9178,left:9296,center:9297,right:9298,lowerLeft:9416,bottom:9417,lowerRight:9418,endLeft:9300,middleCorridorHorizontal:9301,endRight:9302,endTop:9179,middleCorridorVertical:9299,endBottom:9419,single:9181},v=(e,t)=>{let i=0,a=`${e},${t-1}`,s=`${e},${t+1}`,r=`${e-1},${t}`,o=`${e+1},${t}`,l=`${e+1},${t-1}`,c=`${e-1},${t+1}`,h=`${e-1},${t-1}`,d=`${e+1},${t+1}`,p=e=>e in n;if(p(a)&&(i+=1),p(o)&&(i+=2),p(s)&&(i+=4),p(r)&&(i+=8),0==i){if(p(c)&&p(l)||p(h)&&p(d))return 21;if(p(h)&&p(a)&&p(d))return 20;if(p(d)&&p(s)&&p(h))return 20;if(p(h))return 16;if(p(l))return 17;if(p(c))return 18;if(p(d))return 19}return i},y={0:7046,1:m,2:d,3:h,4:c,5:c,6:u,7:m,8:9317,9:l,10:d,11:9319,12:p,13:m,14:9318,15:9318,16:u,17:p,18:h,19:l,20:9201,21:9321},f={0:g.single,1:g.endBottom,2:g.endLeft,3:g.lowerLeft,4:g.endTop,5:g.middleCorridorVertical,6:g.upperLeft,7:g.left,8:g.endRight,9:g.lowerRight,10:g.middleCorridorHorizontal,11:g.bottom,12:g.upperRight,13:g.right,14:g.top,15:g.center,16:g.single,17:g.single,18:g.single,19:g.lowerLeft,20:g.middleT};for(let i=0;i<t;i++)for(let t=0;t<e;t++)if(`${t},${i}`in n){let e=f[v(t,i)]+1;s.layers[0].data[i][t]=e}else{let e=y[v(t,i)]+1;s.layers[0].data[i][t]=e}let b=Object.keys(n),w=ke(b);if(null===w)throw"Could not find an open spot on the map to place the player!";s.layers[2].data[w[1]][w[0]]=nt.playerID,s.layers[3].data[w[1]][w[0]]="down"===i?238:237;let x=ke(b);s.layers[2].data[x[1]][x[0]]="down"===i?237:238,x=ke(b),s.layers[2].data[x[1]][x[0]]="down"===i?237:238;let _=E(7+a,25+a);for(let e=0;e<_;e++){let e=ke(b);if(null===e)break;let t=r.a.RNG.getWeightedValue(mobDistribution),i=Se[t],a=(createActor(t),i[k(0,i.length-1)]+1);s.layers[2].data[e[1]][e[0]]=a}for(let e=0;e<s.layers.length;e++)s.layers[e].data=Ce(s.layers[e].data);return s},randomDungeon:function(e,t,i){let{level:a}=i,s={};return a<=5?(s={roomWidth:[3,20],roomHeight:[4,10],corridorLength:[4,4],roomDugPercentage:.4},$e(e,t,Ee.RUINS,new r.a.Map.Uniform(e,t,s),i,!1)):a<=10?(s={roomWidth:[3,6],roomHeight:[4,7],corridorLength:[2,4],roomDugPercentage:.2},$e(e,t,Ee.CATACOMBS,new r.a.Map.Digger(e,t,s),i)):a<=15?(s={roomWidth:[3,10],roomHeight:[4,10],corridorLength:[1,10],roomDugPercentage:.4},$e(e,t,Ee.MINE,new r.a.Map.Uniform(e,t,s),i,!1)):(s={roomWidth:[3,20],roomHeight:[4,10],corridorLength:[4,4],roomDugPercentage:.4},$e(e,t,Ee.ICE,new r.a.Map.Digger(e,t,s),i))},randomSimplexMap:function(e,t,i){let a=~~(e/i),s=~~(t/i),n=new Te(a,s);console.log(a,s);let o=He.a.create(908234),l=He.a.create(908234),c=new Pe.a(o.nextDouble.bind(o));new Pe.a(l.nextDouble.bind(l));const h={GOBLIN:1,RAT:3,WILD_GOAT:3},d=(e,t,i,a)=>{switch(e){case"ORC":return new de(t,i,a);case"EMPOWERED_ORC":return new de(t,i,a,!0);case"KOBOLD":return new pe(t,i,a);case"GOBLIN":return new me(t,i,a);case"BAT":return new ue(t,i,a);case"RAT":return new ge(t,i,a);case"WILD_GOAT":return new qe(t,i,a);default:throw"Unidentified actor given to create actor"}},p=(e,t)=>c.noise2D(e,t)/2+.5,m=(i,a)=>{let s=i/e-.5,r=a/t-.5,n=1*p(1.5*s,1.5*r)+.5*p(3*s,3*r)+.25*p(6*s,6*r)+.13*p(12*s,12*r)+.06*p(24*s,24*r)+.03*p(48*s,48*r);return n/=1.97,100*(n=Math.pow(n,5))},u=e=>e<1.5?ze.COASTAL_WATER:ze.FOREST;let g=(e,t)=>{let i=m(e,t),a=u(i),s=0,r=`${e},${t+1}`,n=`${e-1},${t}`,o=`${e+1},${t}`,l=`${e-1},${t-1}`,c=e=>{let[t,i]=e.split(","),s=m(t,i),r=u(s).type;return r===a.type||"OCEAN_WATER"===r&&"COASTAL_WATER"===a.type};return c(`${e},${t-1}`)&&(s+=1),c(o)&&(s+=2),c(r)&&(s+=4),c(n)&&(s+=8),15!==s||c(l)||"COASTAL_WATER"!==a.type||(s=18),{texture:((e,t)=>{const{hasCorridors:i}=e;let a={0:e.single,1:e.endBottom,2:i?e.endLeft:e.upperLeft,3:e.lowerLeft,4:i?e.endTop:e.upperLeft,5:e.middleCorridorVertical,6:e.upperLeft,7:e.left,8:i?e.endRight:e.upperRight,9:e.lowerRight,10:e.middleCorridorHorizontal,11:e.bottom,12:e.upperRight,13:e.right,14:e.top,15:e.center,16:e.lowerRight,17:e.lowerLeft,18:e.altUpperRight,19:e.upperLeft,20:e.middleT,21:e.middleIntersection};return t in a?a[t]:(console.warn(`Couldn't find a texture for sum: ${t} with tile options: ${tileOptions}`),0)})(a.textures,s),type:a.type,elevation:i}};const v={[Ye]:25,[Fe]:25,[Ge]:25,[Ve]:25,[je]:1,[Ue]:1,[Xe]:1,[Ze]:1,[Qe]:1,[et]:1,[Ke]:1};for(let e=0;e<s;e++)for(let t=0;t<a;t++){let i=g(t,e),a=n.getTile(t,e);if(i.type===ze.OCEAN_WATER.type||i.type===ze.COASTAL_WATER.type)a.updateTileInfo(7146),a.updateTileInfo(i.texture);else if(i.type===ze.FOREST.type){if(a.updateTileInfo(i.texture),O(5,i.elevation,6)||O(10,i.elevation,100))a.updateTileInfo(Je);else if(k(0,4)>0){let e=r.a.RNG.getWeightedValue(v);a.updateTileInfo(e)}if(!a.blocked()&&1===k(0,500)){let i=r.a.RNG.getWeightedValue(h),s=We[i],o=d(i,t,e,s[k(0,s.length-1)]);a.actors.push(o),n.actors.push(o)}}}return n.playerLocation=[~~(a/2),~~(s/2)],n}};n.utils.skipHello();const{randomSimplexMap:it,randomDungeon:at,randomCave:st}=tt,rt=7419;let nt={app:null,overview:null,dev:!1,display:null,HUD:null,console:null,player:null,playerLocation:null,playerID:4696,loadedIDS:[],scheduler:null,turn:0,engine:null,loaded:!1,levels:{},currentLevel:{name:"Mulberry Town",depth:0},map:null,messageHistory:[],tempMessages:[],minimap:null,selectedTile:null,pathToTarget:{},targetReticle:null,enemyCycle:null,enemyCycleIndex:0,userSettings:{hpBars:!1,animationsEnabled:!0},init(e){this.playerID=e,this.player=new se(0,0,e),this.displayOptions={width:32,height:20,forceSquareRatio:!0,layout:"tile",tileWidth:32,tileHeight:32};this.display=new class{constructor(){let e=window.innerHeight<=800||window.innerWidth<=1400;this.width=e?800:1024,this.height=e?500:640,this.scale=1,this.app=new n.Application({width:this.width,height:this.height}),this.staticBackground=null,this.animatedBackground=null,this.FOVBackground=null,this.HUDBackground=null,this.movingSprites=[],this.viewPort=null,this.tileSize=32,this.tileset=null,this.objectTemplates=null,this.tilesetMapping={},this.spriteBox=[]}resize(e=null){let t=window.innerHeight<=800||window.innerWidth<=1400,i=t?800:1024,a=t?500:640,s=t?.72:1;null!==e&&(s=e),this.width===i&&this.height===a&&this.scale===s||(this.app.renderer.resize(i,a),this.app.stage.scale.x=this.app.stage.scale.y=s,this.scale=s,this.width=i,this.height=a)}loadAssets(e){let{renderer:t,stage:i,view:a}=this.app,{resources:s}=n.loader;n.loader.add({url:"static/images/compiled_tileset_32x32.png",name:"spritesheet"}).add({url:"static/compiled_dawnlike.json",name:"textureAtlas"}).add({url:"static/maps/mulberryTown.json",name:"mulberryTown"}).add({url:"static/maps/mulberryForest.json",name:"mulberryForest"}).add({url:"static/maps/mulberryGraveyard.json",name:"mulberryGraveyard"}).add({url:"static/maps/lichLair.json",name:"lichLair"}).on("progress",(e,t)=>this.handleAssetLoad(e,t)).load(()=>{this.tileset=n.loader.resources.textureAtlas.data;for(let e=0;e<this.tileset.tilecount;e++){let t=this.getTilesetCoords(e),i=new n.Rectangle(t[0],t[1],this.tileSize,this.tileSize),a=new n.Texture(n.loader.resources.spritesheet.texture,i);this.tilesetMapping[e]=a}this.clear();let t=e=>{for(let e of this.movingSprites)e.sprite.x===e.target.x&&e.sprite.y===e.target.y&&(this.movingSprites=this.movingSprites.filter(t=>t.sprite!==e.sprite));for(let e of this.movingSprites){let{sprite:t,target:i}=e,a=0,s=0,r=Math.abs(t.x-i.x),n=Math.abs(t.y-i.y),o=r<=12&&0!==r||n<=12&&0!==n?2:4;i.x>t.x&&(a=o),i.x<t.x&&(a=-o),i.y>t.y&&(s=o),i.y<t.y&&(s=-o),Math.abs(a)>r&&(a=r),Math.abs(s)>n&&(s=n),t.position.set(t.x+a,t.y+s)}};this.app.ticker.add(e=>t()),e()})}getTilesetCoords(e){this.tileset.tilewidth;let t=this.tileset.tileheight,i=this.tileset.columns;return[e%i*t,Math.floor(e/i)*t]}renderMap(e){let{renderer:t,stage:i}=this.app;i.removeChildren();let a=new n.Container;this.animatedBackground=new n.Container;for(let t=0;t<e.height;t++)for(let i=0;i<e.width;i++){let s=e.getTile(i,t);for(let e of s.obstacles)if(!0===e.animated&&void 0!==e.animated_id&&void 0!==this.getTexture(e.animated_id)){let a=[this.getTexture(e.id),this.getTexture(e.animated_id)],s=new n.extras.AnimatedSprite(a);null!==e.tint&&(s.tint=e.tint),s.position.set(i*this.tileSize,t*this.tileSize),s.animationSpeed=.025;let r=~~(150*Math.random());setTimeout(()=>s.play(),r),this.animatedBackground.addChild(s)}else{let s=new n.Sprite(this.getTexture(e.id));null!==e.tint&&(s.tint=e.tint),s.position.set(i*this.tileSize,t*this.tileSize),a.addChild(s)}}this.staticBackground=new n.Sprite(t.generateTexture(a)),this.staticBackground.position.set(0,0),this.animatedBackground.position.set(0,0),this.background=new n.Container,this.background.addChild(this.staticBackground),this.background.addChild(this.animatedBackground),i.addChild(this.background);let s={x:nt.player.x-~~(nt.width/2),y:nt.player.y-~~(nt.height/2),width:Math.ceil(nt.width),height:nt.height},r=[s.x,s.y];s.x<0&&(r[0]=0),s.x+s.width>nt.map.width&&(r[0]=nt.map.width-s.width),s.y<=0&&(r[1]=0),s.y+s.height>nt.map.height&&(r[1]=nt.map.height-s.height),r[0],r[1],this.background.position.set(-r[0]*this.tileSize,-r[1]*this.tileSize);for(let t of e.actors)t instanceof c&&t.inInventory||this.assignSprite(t);if(!e.revealed){this.FOVBackground=new n.Container,this.spriteBox=[];for(let e=0;e<nt.map.height;e++){this.spriteBox.push([]);for(let t=0;t<nt.map.width;t++){let i=new n.Sprite(this.getTexture(7026));i.position.set(t*this.tileSize,e*this.tileSize),this.spriteBox[e].push(i),this.FOVBackground.addChild(i)}}for(let t=0;t<e.height;t++)for(let i=0;i<e.width;i++)e.visible_tiles[i+","+t]?this.spriteBox[t][i].visible=!1:i+","+t in e.seen_tiles?this.spriteBox[t][i].alpha=.5:this.spriteBox[t][i].alpha=1;this.background.addChild(this.FOVBackground)}nt.drawMiniMap()}updateMap(){let e={x:nt.player.x-~~(nt.width/2),y:nt.player.y-~~(nt.height/2),width:Math.ceil(nt.width),height:nt.height},t=[e.x,e.y];if(e.x<0&&(t[0]=0),e.x+e.width>nt.map.width&&(t[0]=nt.map.width-e.width),e.y<=0&&(t[1]=0),e.y+e.height>nt.map.height&&(t[1]=nt.map.height-e.height),t[0],t[1],!nt.map.revealed){Object.assign(nt.map.seen_tiles,nt.map.visible_tiles),nt.map.visible_tiles={},new r.a.FOV.PreciseShadowcasting((e,t)=>nt.inbounds(e,t)&&nt.getTile(e,t).visible()).compute(nt.player.x,nt.player.y,nt.player.cb.range,(e,t,i,a)=>{nt.map.visible_tiles[e+","+t]=!0});for(let e=0;e<nt.map.height;e++)for(let t=0;t<nt.map.width;t++)if(nt.map.visible_tiles[t+","+e])this.spriteBox[e][t].visible=!1;else if(this.spriteBox[e][t].visible=!0,nt.map.seen_tiles[t+","+e]){let i=((...e)=>e.some(e=>nt.map.visible_tiles[e]))(`${t-1},${e}`,`${t+1},${e}`,`${t},${e-1}`,`${t},${e+1}`,`${t-1},${e-1}`,`${t+1},${e+1}`,`${t-1},${e+1}`,`${t+1},${e-1}`);this.spriteBox[e][t].alpha=i?.5:.7}else this.spriteBox[e][t].alpha=1}if(nt.userSettings.hpBars){for(let t=e.x;t<e.x+e.width-1;t++)for(let i=e.y;i<e.y+e.height-1;i++)if(nt.inbounds(t,i)&&(nt.map.revealed||nt.map.visible_tiles[t+","+i])){let e=nt.getTile(t,i).actors.filter(e=>e instanceof H&&!(e instanceof se)&&!(e instanceof he));if(e.length>=1)for(let t of e)if(void 0!==t.spriteHPBar&&this.background.removeChild(t.spriteHPBar),t.cb.hp<t.cb.maxhp){let e=new n.Graphics,i=t.x*this.tileSize,a=(t.y-.5)*this.tileSize;e.beginFill(10627626),e.drawRect(i+1,a,this.tileSize-2,7),e.beginFill(16732754);let s=t.cb.hp/t.cb.maxhp*(this.tileSize-4);e.drawRect(i+2,a+1,s,5),e.endFill();let r=new n.Sprite(this.app.renderer.generateTexture(e));r.position.set(i,a),t.setSpriteHPBar(r),this.background.addChild(r)}}}else for(let e of nt.map.actors)void 0!==e.spriteHPBar&&(this.background.removeChild(e.spriteHPBar),e.spriteHPBar=void 0);this.moveSprite(this.background,-t[0],-t[1]),nt.drawMiniMap()}getTexture(e){return this.tilesetMapping[e]}moveSprite(e,t,i,a=!0){let s=t*this.tileSize,r=i*this.tileSize;a?(this.movingSprites.filter(t=>t.sprite===e).length>0&&(this.movingSprites=this.movingSprites.filter(t=>t.sprite!==e)),this.movingSprites.push({sprite:e,target:{x:s,y:r}})):e.position.set(s,r)}assignSprite(e,t=!1,i=1){let{x:a,y:s,id:r}=e,o=this.tileset.tileproperties[e.id];if(void 0!==o&&!0===o.animated&&void 0!==o.animated_id&&void 0!==this.getTexture(o.animated_id)){let a=[this.getTexture(e.id),this.getTexture(o.animated_id)],s=new n.extras.AnimatedSprite(a);e.setSprite(s),s.animationSpeed=.065;let r=~~(1e3*Math.random());setTimeout(()=>s.play(),r),t?this.background.addChildAt(s,i):this.background.addChild(s),s.position.set(e.x*this.tileSize,e.y*this.tileSize)}else{let i=new n.Sprite(this.getTexture(e.id));e.setSprite(i),t?this.background.addChildAt(i,1):this.background.addChild(i),i.position.set(e.x*this.tileSize,e.y*this.tileSize)}}clearSprite(e){this.background.removeChild(e.sprite),e.sprite=null}removeChild(e){this.background.removeChild(e)}getContainer(){return this.app.view}handleAssetLoad(e,t){let{stage:i,renderer:a}=this.app;this.clear();let s=a.width/2,r=a.height/2,o=new n.Text(`Loading ${t.name}... ${Math.floor(e.progress)}%`,{fill:16777215,fontSize:16,fontFamily:["Source Code Pro","Menlo","Consolas"],x:s,y:r});i.addChild(o)}clear(){this.app.stage.removeChildren()}act(){nt.engine.lock(),this.updateMap(),nt.engine.unlock()}},this.display.loadAssets(()=>{let{resources:e}=n.loader;this.levels["Mulberry Town"]=_e(e.mulberryTown.data,"Mulberry Town"),this.levels["Mulberry Forest"]=_e(e.mulberryForest.data,"Mulberry Forest"),this.levels["Mulberry Graveyard"]=_e(e.mulberryGraveyard.data,"Mulberry Graveyard"),this.levels["Lich Lair"]=_e(e.lichLair.data,"Lich Lair"),this.map=this.levels[this.currentLevel.name],this.width=this.map.width<this.displayOptions.width?this.map.width:this.displayOptions.width,this.height=this.map.height<this.displayOptions.height?this.map.height:this.displayOptions.height,this.map.actors.push(this.player);let[t,i]=this.map.playerLocation;this.player.placeAt(t,i),this.scheduleAllActors(),this.initializeMinimap(),document.getElementById("game_container").appendChild(this.display.getContainer()),document.getElementById("minimap_container").appendChild(this.minimap.getContainer()),this.engine.start(),this.renderMap()})},renderMap(){this.display.renderMap(this.map),this.targetReticle=new n.Sprite(this.display.tilesetMapping[7418]),this.targetReticle.visible=!1,this.display.background.addChild(this.targetReticle)},scheduleAllActors(){this.scheduler=new r.a.Scheduler.Simple,this.scheduler.add(this.player,!0),this.scheduler.add(this.display,!0);for(let e=0;e<this.map.actors.length;e++)this.map.actors[e]!==this.player&&this.map.actors[e]instanceof H&&this.scheduler.add(this.map.actors[e],!0);this.engine=new r.a.Engine(this.scheduler)},initializeMinimap(){this.minimap=new r.a.Display,this.minimap.setOptions({width:this.map.width,height:this.map.height,fontSize:2,spacing:2,forceSquareRatio:!0}),this.drawMiniMap()},clearTempLog(){this.tempMessages.splice(0,this.tempMessages.length)},inbounds(e,t){return!(e<0||e>=this.map.width||t<0||t>=this.map.height)},inViewport(e,t){let i=nt.player.x-~~(nt.width/2),a=nt.player.y-~~(nt.height/2);return i<=e&&e<=i+nt.width&&a<=t&&t<=a+nt.height},createDungeonFloors(e,t,i){this.levels[t+1]=at(40,40,{dungeonName:t,lastDungeon:!1,fromPortal:e,toPortal:t+2,level:1});for(let e=2;e<i;e++){let i={dungeonName:t,lastDungeon:!1,fromPortal:t+(e-1),toPortal:t+(e+1),level:e};this.levels[t+e]=at(40,40,i)}this.levels[t+i]=at(40,40,{dungeonName:t,lastDungeon:!0,fromPortal:t+(i-1),toPortal:e,level:i})},changeLevels(e,t=!1){let i=this.levels[e];!0!==t||e+1 in this.levels?!0===t&&(i=this.levels[e+1]):(this.createDungeonFloors(this.currentLevel.name,e,20),i=this.levels[e+1]),this.map.playerLocation=[nt.player.x,nt.player.y],"dungeon"===this.map.type?this.levels[this.currentLevel.name+this.currentLevel.depth]=this.map:this.levels[this.currentLevel.name]=this.map,this.getTile(this.player.x,this.player.y).removeActor(this.player),this.map.actors=this.map.actors.filter(e=>e!==this.player);for(let e of this.map.actors)this.display.clearSprite(e);this.map=i,this.currentLevel.name=i.name,this.currentLevel.depth=void 0!==i.depth?i.depth:0,this.playerLocation=this.map.playerLocation,i.visited||"dungeon"!==i.type||(i.visited=!0,this.player.cb.dungeonsExplored++),this.display.clear(),this.width=this.map.width<this.displayOptions.width?this.map.width:this.displayOptions.width,this.height=this.map.height<this.displayOptions.height?this.map.height:this.displayOptions.height,this.player.placeAt(this.playerLocation[0],this.playerLocation[1]),this.map.actors.push(this.player),this.scheduleAllActors(),Object.assign(this.map.seen_tiles,this.map.visible_tiles),this.map.visible_tiles={},new r.a.FOV.PreciseShadowcasting((e,t)=>this.inbounds(e,t)&&this.getTile(e,t).visible()).compute(this.player.x,this.player.y,this.player.cb.range,(e,t,i,a)=>{this.map.visible_tiles[e+","+t]=!0}),this.minimap.setOptions({width:this.map.width,height:this.map.height,fontSize:2,spacing:2,forceSquareRatio:!0}),this.minimap.clear(),this.drawMiniMap(),this.renderMap()},drawMiniMap(){let e=this.map.actors.filter(e=>e instanceof N||e instanceof D);if(this.map.revealed){for(let e=0;e<this.map.height;e++)for(let t=0;t<this.map.width;t++){let i=this.getTile(t,e);i.x+","+i.y in this.map.visible_tiles?this.minimap.draw(t,e," ",i.bg(),this.brightenColor(i.bg())):this.minimap.draw(t,e," ",i.bg(),i.bg())}for(let t of e)this.minimap.draw(t.x,t.y," ",t.fg,t.bg)}else{for(let e=0;e<this.map.height;e++)for(let t=0;t<this.map.width;t++){let i=this.getTile(t,e);i.x+","+i.y in this.map.visible_tiles?this.minimap.draw(t,e," ",i.bg(),this.brightenColor(i.bg())):i.x+","+i.y in this.map.seen_tiles&&this.minimap.draw(t,e," ",i.bg(),i.bg())}for(let t of e)t.x+","+t.y in this.map.seen_tiles&&this.minimap.draw(t.x,t.y," ",t.fg,t.bg)}this.minimap.draw(this.player.x,this.player.y," ","yellow","yellow")},brightenColor(e){let t=r.a.Color.rgb2hsl(r.a.Color.fromString(e));return t[2]*=1.25,r.a.Color.toRGB(r.a.Color.hsl2rgb(t))},getNearbyEnemies(){let e={x:this.player.x-~~(nt.width/2),y:this.player.y-~~(nt.height/2),width:Math.ceil(nt.width),height:nt.height},t=[e.x,e.y];e.x<0&&(t[0]=0),e.x+e.width>nt.map.width&&(t[0]=nt.map.width-e.width),e.y<=0&&(t[1]=0),e.y+e.height>nt.map.height&&(t[1]=nt.map.height-e.height),this.camera={x:t[0],y:t[1]};let i=[t[0]+e.width,t[1]+e.height],a=0,s=[];for(let e=t[0];e<i[0];e++){for(let a=t[1];a<i[1];a++){let t=this.getTile(e,a);s=s.concat(t.actors)}0,a=0}return s.filter(e=>void 0!==e.cb&&e.cb.hostile).sort((e,t)=>e.distanceTo(this.player)<t.distanceTo(this.player)?-1:t.distanceTo(this.player)<e.distanceTo(this.player)?1:0)},getClosestEnemyToPlayer(){return this.getNearbyEnemies()[0]},clearSelectedTile(){this.selectedTile=null,this.pathToTarget={},this.clearTempLog(),this.targetReticle.visible=!1},changeSelectedTile(e){this.selectedTile=e;let{x:t,y:i}=e,a=this.selectedTile.blocked()||void 0===this.map.visible_tiles[t+","+i];if(this.pathToTarget={},!a){let e=this.player.x,t=this.selectedTile.x,i=this.player.y,a=this.selectedTile.y,s=Math.abs(t-e),r=e<t?1:-1,n=Math.abs(a-i),o=i<a?1:-1,l=(s>n?s:-n)/2;for(;e!==t||i!==a;){this.pathToTarget[e+","+i]=!0;let t=l;t>-s&&(l-=n,e+=r),t<n&&(l+=s,i+=o)}this.pathToTarget[e+","+i]=!0,this.pathToTarget[this.player.x+","+this.player.y]=!1}return this.targetReticle.visible=!0,this.targetReticle.position.set(e.x*this.display.tileSize,e.y*this.display.tileSize),this.describeSelectedTile(),!a},selectNearestEnemyTile(){this.clearSelectedTile();let e=this.getClosestEnemyToPlayer();if(void 0!==e){let{x:t,y:i}=e;return this.changeSelectedTile(this.getTile(t,i))}return!1},cycleThroughSelectableEnemies(){if(null===this.enemyCycle&&(this.enemyCycle=this.getNearbyEnemies(),this.enemyCycleIndex=0),this.enemyCycle.length>1){this.clearSelectedTile(),this.enemyCycleIndex+=1,this.enemyCycleIndex===this.enemyCycle.length&&(this.enemyCycleIndex=0);let e=this.enemyCycle[this.enemyCycleIndex];return this.changeSelectedTile(this.getTile(e.x,e.y))}},describeSelectedTile(){let{actors:e,obstacles:t}=this.selectedTile,i=e.filter(e=>e instanceof l&&e!==this.player).map(e=>e instanceof c?e.type.toLowerCase():e.name.toLowerCase()),a=t.map(e=>e.description).filter(e=>void 0!==e);a.length>0&&i.push(a.slice(-1)[0]);let s=[];if(s=i.slice(1,-1).reduce((e,t)=>e+", "+R(t),R(i.slice(0,1)[0])),i.length>1?s+=[` and ${R(i.slice(-1)[0])}`]:0==i.length&&(s="nothing"),(nt.player.targeting||nt.player.casting)&&null!==this.selectedTile){let e=nt.map.data[this.selectedTile.y][this.selectedTile.x].actors.some(e=>e.id===rt)?" This tile is out of range or blocked.":"";this.log(`[You see ${s} here.${e}]`,"player_move",!0)}else this.log(`[You see ${s} here.]`,"player_move",!0)},getTile(e,t){return this.map.data[t][e]},printPlayerTile(){console.log(nt.map.data[this.player.y][this.player.x])},eventToTile(){let{x:e,y:t}=this.display.app.renderer.plugins.interaction.mouse.global,i=nt.player.x-~~(nt.width/2),a=nt.player.y-~~(nt.height/2)-1,s=i+~~(e/this.display.tileSize),r=a+~~(t/this.display.tileSize);return this.inbounds(s,r)?this.getTile(s,r):null},log(e,t,i=!1){let a={defend:"lightblue",magic:"#6757c6",attack:"red",death:"crimson",information:"yellow",player_move:"#878787",level_up:"green",alert:"orange"},s=t in a?a[t]:t;i?this.tempMessages.splice(0,1,[e,s]):this.messageHistory.push([e,s])},getNearestLadder(){let e=this.map.actors.filter(e=>e instanceof N);return e.length>0?e[0]:null},getNearestLevelTransition(){let e=this.map.actors.filter(e=>e instanceof oe);return e.length>0?e[0]:null}};var ot={name:"start-menu",data:()=>({selectedSprite:null,playerSprites:[{name:"Monk",description:"A master of martial arts with special healing abilities",abilities:[{name:"Magic Dart",description:"A magical dart of energy that deals between 1-8 damage to a target",school:"conjuration",art:"magic_dart"}],stats:{hp:50,strength:1,dexterity:1,wisdom:1},sprites:[4812,4453,3859,4219]},{name:"Ninja",description:"A sneaky ninja of a secret order with the ability to stealth",abilities:[{name:"Magic Dart",description:"A magical dart of energy that deals between 1-8 damage to a target",school:"conjuration",art:"magic_dart"}],stats:{hp:50,strength:1,dexterity:1,wisdom:1},sprites:[4334,4814]},{name:"Knight",description:"A proud knight, sworn to uphold chivalric values",abilities:[{name:"Magic Dart",description:"A magical dart of energy that deals between 1-8 damage to a target",school:"conjuration",art:"magic_dart"}],stats:{hp:50,strength:1,dexterity:1,wisdom:1},sprites:[4213,4693]},{name:"Barbarian",description:"A wild and vicious savage with extreme strength and rage",abilities:[{name:"Magic Dart",description:"A magical dart of energy that deals between 1-8 damage to a target",school:"conjuration",art:"magic_dart"}],stats:{hp:50,strength:1,dexterity:1,wisdom:1},sprites:[4337,4336]},{name:"Wizard",description:"A scholar of the arcane and all things magical",abilities:[{name:"Magic Dart",description:"A magical dart of energy that deals between 1-8 damage to a target",school:"conjuration",art:"magic_dart"}],stats:{hp:50,strength:1,dexterity:1,wisdom:1},sprites:[3858,4218,4813]},{name:"Centaur",description:"Half-man, half-beast with high speed and agility",abilities:[{name:"Magic Dart",description:"A magical dart of energy that deals between 1-8 damage to a target",school:"conjuration",art:"magic_dart"}],stats:{hp:50,strength:1,dexterity:1,wisdom:1},sprites:[8521,8522,8523]}]}),created(){},methods:{getPlayerSpriteImage:e=>`../static/images/player_sprites/${e}.png`,selectSprite(e){this.$emit("spriteSelected",e)},getSpellSplashArt:(e,t)=>`../static/images/spells/${e}/${t}.png`}},lt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-app",{attrs:{dark:""}},[i("v-container",{attrs:{fluid:"","grid-list-xl":""}},[i("v-layout",{attrs:{row:""}},[i("v-flex",{attrs:{xs12:""}},[i("h2",[e._v("Welcome to Rotten Soup")])])],1),e._v(" "),i("v-layout",{attrs:{row:""}},[i("v-flex",[i("h3",[e._v("Select your hero by clicking on the character you want to play")])])],1),e._v(" "),i("v-layout",{attrs:{row:"",wrap:""}},e._l(e.playerSprites,function(t,a){return i("v-flex",{key:a,staticStyle:{padding:"10px"},attrs:{xs4:""}},[i("v-card",{staticStyle:{padding:"25px"}},[i("v-layout",{attrs:{row:""}},[i("div",[i("h3",[e._v(e._s(t.name))]),e._v(" "),i("p",[e._v(e._s(t.description))])])]),e._v(" "),i("v-layout",{attrs:{row:""}},[i("h5",[e._v("\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tCharacters\r\n\t\t\t\t\t\t\t\t\t\t\t\t")])]),e._v(" "),i("v-layout",{attrs:{row:""}},e._l(t.sprites,function(t){return i("v-flex",{key:t,staticClass:"mr-2 ml-2",attrs:{xs1:""}},[i("img",{class:{spriteIsSelected:e.selectedSprite===t,sprite:e.selectedSprite!==t},attrs:{src:e.getPlayerSpriteImage(t)},on:{click:function(i){e.selectSprite(t)}}})])}))],1)],1)}))],1)],1)},staticRenderFns:[]};var ct=i("VU/8")(ot,lt,!1,function(e){i("jHJM")},null,null).exports,ht={data:()=>({messages:nt.messageHistory,tempMessages:nt.tempMessages,offset:0}),methods:{getTempMessages(){return this.tempMessages},getMessages(){return this.messages.slice(-10-this.offset+this.getTempMessages().length)},resetOffset(){this.offset=0},down(){this.offset>0&&this.offset--},up(){this.offset<this.messages.length-10&&this.offset++}}},dt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-layout",{attrs:{id:"console_container"}},[i("v-flex",{attrs:{column:"","align-start":""}},[i("v-list",{staticClass:"pt-3",attrs:{id:"console"}},[e._l(e.getMessages(),function(t,a){return i("li",{key:a,staticClass:"ml-2"},[i("p",[i("b",{style:{color:t[1]}},[e._v(e._s(t[0]))])])])}),e._v(" "),e._l(e.getTempMessages(),function(t,a){return i("li",{staticClass:"ml-2"},[i("p",[i("b",{style:{color:t[1]}},[e._v(e._s(t[0]))])])])})],2)],1),e._v(" "),i("v-flex",{staticClass:"text-xs-center",staticStyle:{"max-width":"27px"},attrs:{id:"scroll_controls",column:""}},[i("v-layout",[i("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[i("v-icon",{staticClass:"scroll_controls",attrs:{small:""},on:{click:function(t){e.up()}}},[e._v("fa-angle-up")])],1)],1),e._v(" "),i("v-layout",{staticStyle:{height:"70px"}}),e._v(" "),i("v-layout",[i("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[i("v-icon",{staticClass:"scroll_controls",attrs:{small:""},on:{click:function(t){e.down()}}},[e._v("fa-angle-down")])],1)],1),e._v(" "),i("v-layout",[i("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[i("v-icon",{staticClass:"scroll_controls",attrs:{small:""},on:{click:function(t){e.resetOffset()}}},[e._v("fa-angle-double-down")])],1)],1)],1)],1)},staticRenderFns:[]};var pt=i("VU/8")(ht,dt,!1,function(e){i("drkq")},null,null).exports,mt={components:{"message-log":pt},data:()=>({})},ut={render:function(){var e=this.$createElement,t=this._self._c||e;return t("v-flex",{staticStyle:{"max-width":"1120px"},attrs:{column:""}},[t("v-layout",{staticStyle:{padding:"0px"},attrs:{row:""}},[t("div",{staticStyle:{margin:"0",padding:"0"},attrs:{id:"game_container"}})]),this._v(" "),t("message-log")],1)},staticRenderFns:[]};var gt=i("VU/8")(mt,ut,!1,function(e){i("jZkN")},null,null).exports,vt=i("DAYN"),yt={components:{draggable:i.n(vt).a},data:()=>({inventory:[],length:nt.player.inventory,rows:[1,2,3,4],x:0,y:0}),created(){},methods:{getInventorySprite:e=>`../static/images/inventory_sprites/${e}.png`,colorSlot:e=>null!==e.item&&"cb"in e.item&&e.item.cb.equipped,getInventoryRow(e){let t=e*(nt.player.inventory.length/this.rows.length);return nt.player.inventory.slice(t,t+nt.player.inventory.length/this.rows.length)},useItem(e,t){t.shiftKey?e.item.drop():e.item.use()},dropItem(e,t){e.item.drop()},getInventory:()=>nt.player.inventory,show(e,t){t.preventDefault(),nt.player.inventory.forEach(e=>{e.menu=!1}),this.x=t.clientX,this.y=t.clientY,this.$nextTick(()=>{e.menu=!0})}}},ft={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{staticClass:"pa-0",attrs:{fluid:""}},[i("v-layout",{attrs:{row:""}},[i("v-flex",{attrs:{xs4:""}},[i("b",[e._v("Items")])])],1),e._v(" "),i("draggable",{staticClass:"layout inventory_row row",attrs:{element:"v-layout",row:"",wrap:""},model:{value:e.inventory,callback:function(t){e.inventory=t},expression:"inventory"}},e._l(e.getInventory(),function(t,a){return i("v-flex",{key:a,class:{selectedItem:e.colorSlot(t),inventory_cell:!e.colorSlot(t)},attrs:{xs1:"",col:"","align-center":""}},[null!==t.item?i("v-tooltip",{attrs:{"open-delay":"200",bottom:"","align-center":""}},[i("p",{staticClass:"text-xs-center ma-0"},[e._v("\r\n                    "+e._s(t.item.getAction())+" "+e._s(t.item.type)+"\r\n                    "),i("br"),e._v(" "),"name"in t.item?i("span",[e._v(e._s("Name: "+t.item.name)),i("br")]):e._e(),e._v(" "+e._s(t.item.hoverInfo())+"\r\n                ")]),e._v(" "),null!==t.item?i("v-layout",{attrs:{slot:"activator",ripple:"",row:""},on:{click:function(i){e.useItem(t,i)},contextmenu:function(i){e.show(t,i)}},slot:"activator"},[i("v-menu",{attrs:{"offset-x":"","nudge-width":200,"close-on-click":!0,absolute:"","position-x":e.x,"position-y":e.y},model:{value:t.menu,callback:function(i){e.$set(t,"menu",i)},expression:"cell.menu"}},[i("v-card",[i("v-list",[i("v-list-tile",{attrs:{avatar:""}},[i("v-list-tile-avatar",[i("img",{attrs:{src:e.getInventorySprite(t.item.id)}})]),e._v(" "),i("v-list-tile-content",[i("v-list-tile-title",[e._v(e._s(t.item.type))]),e._v(" "),i("v-list-tile-sub-title",[e._v(e._s(t.item.hoverInfo()))])],1)],1)],1),e._v(" "),i("v-divider"),e._v(" "),i("v-card-actions",[i("v-btn",{attrs:{flat:"",color:"blue"},on:{click:function(i){e.useItem(t,i)}}},[e._v(e._s(t.item.getAction()))]),e._v(" "),i("v-btn",{attrs:{flat:"",color:"red"},on:{click:function(i){e.dropItem(t,i)}}},[e._v("Drop")])],1)],1)],1),e._v(" "),i("v-badge",{attrs:{overlay:"",bottom:"",color:"grey",overlap:""}},[void 0!==t.item.quantity?i("span",{attrs:{slot:"badge",dark:""},slot:"badge"},[i("b",[e._v(e._s(t.item.quantity))])]):e._e(),e._v(" "),i("img",{attrs:{src:e.getInventorySprite(t.item.id)}})])],1):e._e()],1):e._e()],1)}))],1)},staticRenderFns:[]};var bt=i("VU/8")(yt,ft,!1,function(e){i("TiSk")},"data-v-46096a4a",null).exports,wt={components:{inventory:bt},data:()=>({inventoryModalOpened:!1}),methods:{}},xt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.inventoryModalOpened?i("v-container",{staticClass:"modal elevation-24"},[i("v-layout",{attrs:{row:""}},[i("v-flex",{attrs:{xs5:"",col:""}},[i("h3",[e._v("Bob the NPC")]),e._v(" "),i("inventory")],1),e._v(" "),i("v-flex",{attrs:{xs2:"",col:""}}),e._v(" "),i("v-flex",{attrs:{xs5:"",col:""}},[i("h3",[e._v("Your Items")]),e._v(" "),i("inventory")],1)],1)],1):e._e()},staticRenderFns:[]};var _t=i("VU/8")(wt,xt,!1,function(e){i("z9mr")},null,null).exports,Tt={data:()=>({enemies:nt.player.nearbyEnemies}),methods:{getNearbyEnemies:()=>nt.player.nearbyEnemies},created(){}},St={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{staticStyle:{"min-height":"50px"},attrs:{fluid:""}},[e.getNearbyEnemies().length>0?i("v-layout",{attrs:{row:"",wrap:""}},e._l(e.getNearbyEnemies(),function(t,a){return i("v-flex",{key:a,attrs:{md4:"",col:""}},[i("v-tooltip",{attrs:{bottom:""}},[i("span",{attrs:{"align-center":""}},[e._v("\n                    HP : "+e._s(t.cb.hp)+" / "+e._s(t.cb.maxhp)),i("br"),e._v('\n                    "'+e._s(t.description)+'"'),i("br")]),e._v(" "),i("div",{staticClass:"enemy_col",attrs:{slot:"activator",fluid:""},slot:"activator"},[i("v-layout",{staticClass:"text-xs-center",staticStyle:{"font-size":"10px",margin:"0px auto -10px 0px"},attrs:{"align-center":"",row:""}},[i("v-flex",{attrs:{xs12:""}},[e._v(e._s(t.name.capitalize()))])],1),e._v(" "),i("v-layout",{staticStyle:{margin:"0px"},attrs:{row:""}},[i("v-flex",{attrs:{xs12:""}},[i("v-progress-linear",{attrs:{value:t.cb.hp/t.cb.maxhp*100,height:"4",color:"error"}})],1)],1)],1)])],1)})):i("v-layout",{attrs:{row:""}},[i("v-container",{attrs:{fluid:""}},[e._v("\n            No enemies in view\n        ")])],1)],1)},staticRenderFns:[]};var Ct=i("VU/8")(Tt,St,!1,function(e){i("lPMU")},null,null).exports,kt={data:()=>({}),methods:{}},Et={render:function(){var e=this.$createElement,t=this._self._c||e;return t("v-layout",{staticClass:"text-xs-center",attrs:{row:""}},[t("v-flex",{attrs:{xs10:"",fluid:"",id:"minimap_container"}})],1)},staticRenderFns:[]};var Ot=i("VU/8")(kt,Et,!1,function(e){i("2Nfd")},null,null).exports,Rt={data:()=>({}),methods:{getHP:()=>nt.player.cb.hp,getMaxHP:()=>nt.player.cb.maxhp,getMana:()=>nt.player.cb.mana,getMaxMana:()=>nt.player.cb.maxmana,getStrength:()=>nt.player.cb.str,getDefence:()=>nt.player.cb.def,getDamageRange:()=>nt.player.getMinDmg()===nt.player.getMaxDmg()?nt.player.getMinDmg():nt.player.getMinDmg()+" - "+nt.player.getMaxDmg(),getLevel:()=>nt.player.cb.level,getRemainingXP:()=>nt.player.remainingXP(),getPercentToLevel(){let e=o[this.getLevel()]-o[this.getLevel()-1];return(nt.player.cb.xp-o[this.getLevel()-1])/e},getCurrentWeapon:()=>nt.player.cb.equipment.weapon,getCurrentWeaponEnchantments(){if(null!==this.getCurrentWeapon()){let e=this.getCurrentWeapon().cb.enchantments;return 0===e.length?null:1===e.length?e[0].name:e.reduce((e,t)=>e+", "+t.name,"")}return null},getCurrentSpell:()=>nt.player.cb.currentSpell}},Lt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{staticClass:"pa-0",attrs:{fluid:""}},[i("v-flex",{staticClass:"stat-row"},[i("v-layout",{attrs:{row:"","align-center":""}},[i("v-flex",{staticStyle:{"min-width":"70px"},attrs:{md1:"",col:""}},[i("b",[e._v("Level")])]),e._v(" "),i("v-flex",{staticStyle:{"padding-left":"7px"},attrs:{md2:"",col:""}},[e._v(e._s(e.getLevel()))]),e._v(" "),i("v-flex",{attrs:{md5:"",col:""}},[e._v(e._s(Math.ceil(e.getRemainingXP()))+"XP until level "+e._s(e.getLevel()+1))])],1)],1),e._v(" "),i("v-flex",{staticClass:"stat-row"},[i("v-layout",{attrs:{row:"","align-center":""}},[i("v-flex",{staticStyle:{"min-width":"70px"},attrs:{md1:"",col:""}},[i("b",[e._v("Strength")])]),e._v(" "),i("v-flex",{staticStyle:{"padding-left":"7px"},attrs:{md3:"",col:""}},[e._v(e._s(e.getStrength()))])],1)],1),e._v(" "),i("v-flex",{staticClass:"stat-row"},[i("v-layout",{attrs:{row:"","align-center":""}},[i("v-flex",{staticStyle:{"min-width":"70px"},attrs:{md1:"",col:""}},[i("b",[e._v("Damage")])]),e._v(" "),i("v-flex",{staticStyle:{"padding-left":"7px"},attrs:{md2:"",col:""}},[e._v(e._s(e.getDamageRange()))]),e._v(" "),null!==e.getCurrentWeapon()&&null!==e.getCurrentWeaponEnchantments()?i("v-flex",{attrs:{md6:"",col:""}},[i("b",[e._v("Weapon Enchantments:")]),e._v(" "+e._s(e.getCurrentWeaponEnchantments())+"\n        ")]):e._e()],1)],1),e._v(" "),i("v-flex",{staticClass:"stat-row"},[i("v-layout",{attrs:{row:"","align-center":""}},[i("v-flex",{attrs:{md4:"",col:""}},[i("b",[e._v("Current Weapon")])]),e._v(" "),i("v-flex",{attrs:{md5:"",col:""}},[e._v("\n        "+e._s(null!==e.getCurrentWeapon()?e.getCurrentWeapon().name:"Fists")+"\n      ")])],1)],1),e._v(" "),i("v-flex",{staticClass:"stat-row"},[i("v-layout",{attrs:{row:"","align-center":""}},[i("v-flex",{attrs:{md4:"",col:""}},[i("b",[e._v("Current Spell")])]),e._v(" "),i("v-flex",{attrs:{md3:"",col:""}},[e._v(e._s(null!==e.getCurrentSpell()?e.getCurrentSpell().name:"None"))])],1)],1)],1)},staticRenderFns:[]},At=i("VU/8")(Rt,Lt,!1,null,null,null).exports,Mt={data:()=>({spells:nt.player.cb.spells}),methods:{highlightSpell:e=>nt.player.cb.currentSpell===e,getSpellSplashArt:(e,t)=>`../static/images/spells/${e}/${t}.png`,getSpells(){return this.spells},fillerSpellSlots(){return this.spells.length<11?11-this.spells.length:0},selectSpell(e){nt.player.selectSpell(e)}}},It={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{staticClass:"pa-0",attrs:{fluid:""}},[i("v-layout",{attrs:{row:""}},[i("v-flex",{attrs:{xs4:""}},[i("b",[e._v("Spells")])])],1),e._v(" "),i("v-layout",{attrs:{row:"",id:"spell_bar"}},[e._l(e.getSpells(),function(t,a){return i("div",{key:a,class:{selectedSpell:e.highlightSpell(t),spell:!e.highlightSpell(t)},attrs:{xs1:""},on:{click:function(i){e.selectSpell(t)}}},[i("v-tooltip",{attrs:{bottom:"","align-center":""}},[i("p",{staticClass:"text-xs-center ma-0",staticStyle:{"max-width":"200px"}},[e._v("\n                    Cast "+e._s(t.name)+" "),i("br"),e._v("\n                    Costs "),i("b",{staticStyle:{color:"blue"}},[e._v(e._s(t.manaCost)+" Mana")]),i("br"),e._v("\n                    "+e._s(t.hoverInfo)+"\n                ")]),e._v(" "),i("img",{attrs:{slot:"activator",src:e.getSpellSplashArt(t.type.toLowerCase(),t.splashArt),width:"26",height:"26"},slot:"activator"})])],1)}),e._v(" "),e._l(e.fillerSpellSlots(),function(e,t){return i("div",{staticClass:"spell",attrs:{xs1:""}},[i("img",{staticStyle:{opacity:"0.7"},attrs:{width:"26",height:"26",src:"static/images/equipment_placeholders/bookmarklet.png"}})])})],2)],1)},staticRenderFns:[]};var Dt=i("VU/8")(Mt,It,!1,function(e){i("6EFC")},null,null).exports,$t={props:["item","altSprite"],methods:{getInventorySprite:e=>`../static/images/inventory_sprites/${e}.png`,colorSlot:e=>!0,useItem(e,t){t.shiftKey?e.drop():e.use()},dropItem(e,t){e.drop()},getInventory:()=>Game.player.inventory}},Nt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"item_slot pa-0 ma-0 text-xs-center"},[null!==e.item?i("v-tooltip",{attrs:{"open-delay":"200",bottom:"","align-center":""}},[i("p",{staticClass:"text-xs-center ma-0"},[e._v("\n            "+e._s(e.item.getAction())+" "+e._s(e.item.type)+"\n            "),i("br"),e._v(" "),"name"in e.item?i("span",[e._v(e._s("Name: "+e.item.name)),i("br")]):e._e(),e._v(" "+e._s(e.item.hoverInfo())+"\n        ")]),e._v(" "),null!==e.item?i("v-layout",{attrs:{slot:"activator",ripple:"",row:""},on:{click:function(t){e.useItem(e.item,t)}},slot:"activator"},[i("v-badge",{attrs:{overlay:"",bottom:"",color:"grey",overlap:""}},[void 0!==e.item.quantity?i("span",{attrs:{slot:"badge",dark:""},slot:"badge"},[i("b",[e._v(e._s(e.item.quantity))])]):e._e(),e._v(" "),i("img",{attrs:{src:e.getInventorySprite(e.item.id)}})])],1):e._e()],1):null!==e.altSprite?i("img",{staticStyle:{opacity:"0.5"},attrs:{src:e.altSprite,width:"35",height:"35"}}):e._e()],1)},staticRenderFns:[]};var Pt={components:{"item-slot":i("VU/8")($t,Nt,!1,function(e){i("9g9w")},null,null).exports},data:()=>({equipment:nt.player.cb.equipment})},Bt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{staticClass:"pa-0",attrs:{fluid:""}},[i("v-layout",[i("v-flex",{staticStyle:{"min-width":"75px"},attrs:{md1:""}},[i("b",[e._v("Equipment")])])],1),e._v(" "),i("v-container",{staticClass:"pa-0 text-xs-left",attrs:{fluid:""}},[i("v-layout",{staticStyle:{"margin-top":"4px"}},[e._l(4,function(e){return i("v-flex",{key:e,staticClass:"filler",attrs:{xs1:""}})}),e._v(" "),i("v-flex",{staticClass:"filler",attrs:{xs1:""}},[i("item-slot",{attrs:{item:e.equipment.head,altSprite:"../static/images/equipment_placeholders/head.png",index:"head"}})],1),e._v(" "),i("v-flex",{staticClass:"filler",attrs:{xs1:""}},[i("item-slot",{attrs:{item:e.equipment.ammo,altSprite:"../static/images/equipment_placeholders/quiver.png",index:"ammo"}})],1)],2),e._v(" "),i("v-layout",{staticStyle:{"margin-top":"4px"}},[e._l(3,function(e){return i("v-flex",{key:e,staticClass:"filler",attrs:{xs1:""}})}),e._v(" "),i("v-flex",{staticClass:"filler",attrs:{xs1:""}},[i("item-slot",{attrs:{item:e.equipment.weapon,altSprite:"../static/images/equipment_placeholders/stiletto.png",index:"weapon"}})],1),e._v(" "),i("v-flex",{staticClass:"filler",attrs:{xs1:""}},[i("item-slot",{attrs:{item:e.equipment.torso,altSprite:"../static/images/equipment_placeholders/chest-armor.png",index:"torso"}})],1)],2),e._v(" "),i("v-layout",{staticStyle:{"margin-top":"4px"}},[e._l(3,function(e){return i("v-flex",{key:e,staticClass:"filler",attrs:{xs1:""}})}),e._v(" "),i("v-flex",{staticClass:"filler",attrs:{xs1:""}},[i("item-slot",{attrs:{item:e.equipment.ring,altSprite:"../static/images/equipment_placeholders/ring.png",index:"weapon"}})],1),e._v(" "),i("v-flex",{staticClass:"filler",attrs:{xs1:""}},[i("item-slot",{attrs:{item:e.equipment.legs,altSprite:"../static/images/equipment_placeholders/leg-armor.png",index:"legs"}})],1)],2)],1)],1)},staticRenderFns:[]};var Ht=i("VU/8")(Pt,Bt,!1,function(e){i("gPi5")},null,null).exports,qt={name:"help-dialog",data:()=>({helpDialog:!1,cheatSheet:[{code:". | 5",description:"Rest for a turn"},{code:", | g",description:"Pick up an item"},{code:"<",description:"Climb up a ladder"},{code:">",description:"Climb down a ladder"},{code:"f",description:"Fire a ranged weapon"},{code:"z",description:"Cast a spell"},{code:"x",description:"Examine the area"}]}),mounted(){window.addEventListener("keydown",e=>{(e.getModifierState("Shift")&&191===e.keyCode||27===e.keyCode&&this.helpDialog)&&(this.helpDialog=!this.helpDialog)})}},zt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"help"}},[i("v-tooltip",{attrs:{right:"","align-center":""}},[i("span",[e._v("Controls")]),e._v(" "),i("v-btn",{attrs:{slot:"activator",flat:"",icon:"",color:"yellow darken-4"},on:{click:function(t){t.stopPropagation(),e.helpDialog=!0}},slot:"activator"},[i("v-icon",[e._v("fa-question-circle")])],1)],1),e._v(" "),i("v-dialog",{attrs:{"max-width":"600px"},model:{value:e.helpDialog,callback:function(t){e.helpDialog=t},expression:"helpDialog"}},[i("v-card",[i("v-card-text",{staticClass:"text-xs-center"},[i("h2",{staticClass:"pa-1"},[e._v("Controls")])]),e._v(" "),i("v-card-text",[i("v-expansion-panel",[i("v-expansion-panel-content",[i("div",{attrs:{slot:"header"},slot:"header"},[e._v("All Keybinds")]),e._v(" "),i("v-card",{attrs:{flat:""}},[i("v-card-text",{staticClass:"pb-0 pt-0"},[i("v-container",[i("v-layout",{staticClass:"pb-2",attrs:{row:""}},[i("v-flex",{attrs:{xs6:""}},[i("b",[e._v("Keys")])]),e._v(" "),i("v-flex",{attrs:{xs6:""}},[i("b",[e._v("Description")])])],1),e._v(" "),e._l(e.cheatSheet,function(t,a){return i("v-layout",{key:a,attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs6:""}},[i("code",[e._v(e._s(t.code))])]),e._v(" "),i("v-flex",{attrs:{xs6:""}},[i("p",[e._v(e._s(t.description))])])],1)})],2)],1)],1)],1),e._v(" "),i("v-expansion-panel-content",[i("div",{attrs:{slot:"header"},slot:"header"},[e._v("Magic and Ranged Combat")]),e._v(" "),i("v-card",{attrs:{flat:""}},[i("v-card-text",{staticClass:"pt-0"},[i("v-container",{attrs:{fluid:""}},[i("p",[i("b",[e._v("Magic")])]),e._v(" "),i("p",[e._v("To cast a spell, first select a spell from your spellbook by "),i("code",[e._v("clicking")]),e._v(" on it. Then, you can press "),i("code",[e._v("z")]),e._v(" to cast the selected spell. If your spell is targeted, you will enter targeting mode.\n\n                                    ")]),i("p",[i("b",[e._v("Ranged")])]),e._v(" "),i("p",[e._v("If you have a ranged weapon and proper ammunition equipped, press "),i("code",[e._v("f")]),e._v(" to enter targeting mode to fire your ranged weapon.\n                                    ")]),e._v(" "),i("p",[i("b",[e._v("Targeting")])]),e._v("\n                                    In targeting mode, you can select a tile to cast a spell or shoot a projectile so long as it's within range. By default, targeting will select the nearest enemy. You can change the selected tile with the standard "),i("code",[e._v("movement")]),e._v(" keys. You can also cycle through enemies in view with "),i("code",[e._v("tab")]),e._v(", "),i("code",[e._v("=")]),e._v(", and "),i("code",[e._v("/")]),e._v(". You cannot select a tile that is blocked or out of your line of sight. Pressing "),i("code",[e._v("escape")]),e._v(" will cancel your spell or ranged attack. You can also press "),i("code",[e._v("f")]),e._v(" or "),i("code",[e._v("z")]),e._v(" for ranged or magic respectively.\n                                    ")])],1)],1)],1),e._v(" "),i("v-expansion-panel-content",[i("div",{attrs:{slot:"header"},slot:"header"},[e._v("Movement and Examining")]),e._v(" "),i("v-card",{attrs:{flat:""}},[i("v-card-text",{staticClass:"pb-0 pt-0"},[i("v-container",[i("p",[e._v("You can move with arrow keys, the numpad, or vi keys. You can move in all 8 directions. ")]),e._v(" "),i("v-container",{staticClass:"text-xs-center"},[i("pre",[e._v("y  k  u      7  8  9  ")]),e._v(" "),i("pre",[e._v(" \\ | /        \\ | /   ")]),e._v(" "),i("pre",[e._v(" h-+-l        4-5-6   ")]),e._v(" "),i("pre",[e._v(" / | \\        / | \\   ")]),e._v(" "),i("pre",[e._v("b  j  n      1  2  3  ")]),e._v(" "),i("pre",[e._v("vi-keys     numberpad ")])]),e._v(" "),i("p",[e._v("\n                                        When in targeting mode, you can use these keys to switch to different tiles. Press "),i("code",[e._v("x")]),e._v(" to examine your surroundings. Press "),i("code",[e._v("x")]),e._v(" or "),i("code",[e._v("escape")]),e._v(" to leave the examine mode.\n                                    ")])],1)],1)],1)],1),e._v(" "),i("v-expansion-panel-content",[i("div",{attrs:{slot:"header"},slot:"header"},[e._v("Melee Combat")]),e._v(" "),i("v-card",{attrs:{flat:""}},[i("v-card-text",{staticClass:"pt-0"},[i("v-container",{attrs:{fluid:""}},[i("p",[e._v("To fight an enemy with your fists or melee weapon, simply "),i("code",[e._v("move")]),e._v(" into a tile where they are standing.")])])],1)],1)],1),e._v(" "),i("v-expansion-panel-content",[i("v-card",{attrs:{flat:""}},[i("div",{attrs:{slot:"header"},slot:"header"},[e._v("Ladders, Resting, and Picking up Items")]),e._v(" "),i("v-card-text",{staticClass:"pt-0"},[i("v-container",{attrs:{fluid:""}},[i("p",[e._v("To pick up items off the ground, press "),i("code",[e._v(",")]),e._v(" or "),i("code",[e._v("g")]),e._v(".")]),e._v(" "),i("p",[e._v("To rest for a turn and restore a little health, press "),i("code",[e._v(".")]),e._v(" or "),i("code",[e._v("5")]),e._v(" on the numpad.")]),e._v(" "),i("p",[e._v("To climb ladders, press "),i("code",[e._v("<")]),e._v(" to go up and press "),i("code",[e._v(">")]),e._v(" to go down.")])])],1)],1)],1),e._v(" "),i("v-expansion-panel-content",[i("div",{attrs:{slot:"header"},slot:"header"},[e._v("Inventory Management")]),e._v(" "),i("v-card",{attrs:{flat:""}},[i("v-card-text",{staticClass:"pt-0"},[i("v-container",{attrs:{fluid:""}},[i("p",[e._v("\n                                        To equip a weapon or drink a potion, "),i("code",[e._v("click")]),e._v(" the item in your inventory. To drop an item, "),i("code",[e._v("shift+click")]),e._v(" the item in your inventory. Alternatively, you can either equip or drop items by right-clicking an item to bring up its context menu and selecting one of the actions from there.\n                                    ")]),e._v(" "),i("p",[e._v("\n                                        You can rearrange inventory items by dragging and dropping items where you want them to be.\n                                    ")]),e._v(" "),i("p",[e._v("\n                                        To view details about items, simply "),i("code",[e._v("hover")]),e._v(" over the item in your inventory and view the tooltip.\n                                    ")])])],1)],1)],1)],1)],1),e._v(" "),i("v-card-actions",[i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"yellow darken-4",flat:""},on:{click:function(t){t.stopPropagation(),e.helpDialog=!1}}},[e._v("Close")])],1)],1)],1)],1)},staticRenderFns:[]};var Wt=i("VU/8")(qt,zt,!1,function(e){i("zLzP")},null,null).exports,Yt={name:"help-dialog",data:()=>({userSettings:nt.userSettings,toolDialog:!1,mouseEnabled:!1,showHPBars:nt.userSettings.hpBars,turnOffAnimation:!1}),watch:{mouseEnabled(e,t){nt.player.mouseEnabled=e}},methods:{toggleHPBars(){nt.userSettings.hpBars=!nt.userSettings.hpBars},toggleAnimations(){nt.userSettings.animationsEnabled=!nt.userSettings.animationsEnabled}}},Ft={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-tooltip",{attrs:{right:"","align-center":""}},[i("span",[e._v("Settings")]),e._v(" "),i("v-btn",{attrs:{slot:"activator",flat:"",icon:"",color:"yellow darken-4"},on:{click:function(t){t.stopPropagation(),e.toolDialog=!0}},slot:"activator"},[i("v-icon",[e._v("fa-cog")])],1)],1),e._v(" "),i("v-dialog",{attrs:{"max-width":"400px"},model:{value:e.toolDialog,callback:function(t){e.toolDialog=t},expression:"toolDialog"}},[i("v-card",[i("v-card-text",{staticClass:"text-xs-center"},[i("h2",[e._v("Settings")])]),e._v(" "),i("v-card-text",[i("v-layout",{attrs:{row:""}},[i("v-flex",[e._v("Enable Mouse Controls*")]),e._v(" "),i("span",[i("v-switch",{attrs:{color:"yellow darken-4"},model:{value:e.mouseEnabled,callback:function(t){e.mouseEnabled=t},expression:"mouseEnabled"}})],1)],1),e._v(" "),i("v-layout",{attrs:{row:""}},[i("v-flex",[e._v("Show HP Bars*")]),e._v(" "),i("span",[i("v-switch",{attrs:{color:"yellow darken-4"},on:{click:function(t){return t.stopPropagation(),e.toggleHPBars(t)}},model:{value:e.userSettings.hpBars,callback:function(t){e.$set(e.userSettings,"hpBars",t)},expression:"userSettings.hpBars"}})],1)],1),e._v(" "),i("v-layout",{attrs:{row:""}},[i("v-flex",[e._v("Enable attacking animations*")]),e._v(" "),i("span",[i("v-switch",{attrs:{color:"yellow darken-4"},on:{click:function(t){return t.stopPropagation(),e.toggleAnimations(t)}},model:{value:e.userSettings.animationsEnabled,callback:function(t){e.$set(e.userSettings,"animationsEnabled",t)},expression:"userSettings.animationsEnabled"}})],1)],1)],1),e._v(" "),i("v-card-actions",[i("small",[e._v("* may cause performance issues")]),e._v(" "),i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"yellow darken-4",flat:""},on:{click:function(t){t.stopPropagation(),e.toolDialog=!1}}},[e._v("Close")])],1)],1)],1)],1)},staticRenderFns:[]},Gt={props:["showEquipment"],data:()=>({activeTab:null,currentLevel:nt.currentLevel,cb:nt.player.cb,equipment:nt.player.cb.equipment}),methods:{getHP:()=>nt.player.cb.hp,getMaxHP:()=>nt.player.cb.maxhp,getMana:()=>nt.player.cb.mana,getMaxMana:()=>nt.player.cb.maxmana,getCurrentLevel:()=>nt.currentLevel.name,getCurrentLevelDepth:()=>nt.currentLevel.depth},components:{inventory:bt,"enemy-overview":Ct,"mini-map":Ot,stats:At,spellbook:Dt,"help-dialog":Wt,"tool-dialog":i("VU/8")(Yt,Ft,!1,null,null,null).exports,equipment:Ht},created(){}},Vt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-flex",{staticClass:"hud_container elevation-0",attrs:{column:""}},[i("v-container",{staticClass:"pa-2",attrs:{fluid:""}},[i("v-layout",{staticStyle:{"margin-bottom":"-20px","margin-top":"-10px"},attrs:{"align-center":""}},[i("v-flex",{staticStyle:{"min-width":"75px"},attrs:{md1:""}},[i("b",[e._v("Health ")])]),e._v(" "),i("v-flex",{attrs:{md8:""}},[i("v-progress-linear",{attrs:{id:"hpBar",color:"error",value:e.getHP()/e.getMaxHP()*100,height:"15"}})],1),e._v(" "),i("v-flex",{staticClass:"text-xs-center",staticStyle:{"padding-left":"5px"},attrs:{md3:""}},[e._v(e._s(e.getHP())+" / "+e._s(e.getMaxHP()))]),e._v(" "),i("v-flex",[i("help-dialog")],1)],1),e._v(" "),i("v-layout",{attrs:{"align-center":""}},[i("v-flex",{staticStyle:{"min-width":"75px"},attrs:{md1:""}},[i("b",[e._v("Magic")])]),e._v(" "),i("v-flex",{attrs:{md8:""}},[i("v-progress-linear",{attrs:{id:"manaBar",value:e.getMana()/e.getMaxMana()*100,height:"15",info:""}})],1),e._v(" "),i("v-flex",{staticClass:"text-xs-center",staticStyle:{"padding-left":"5px"},attrs:{md3:""}},[e._v(e._s(e.getMana())+" / "+e._s(e.getMaxMana()))]),e._v(" "),i("v-flex",[i("tool-dialog")],1)],1),e._v(" "),i("v-layout",[i("stats")],1),e._v(" "),i("v-layout",{staticClass:"mt-2",attrs:{"align-center":""}},[i("v-flex",{attrs:{xs6:""}},[i("b",[e._v("Location:")]),e._v(" "+e._s(e.getCurrentLevel().capitalize()))]),e._v(" "),e.getCurrentLevelDepth()>0?i("v-flex",{staticClass:"pl-3",attrs:{xs4:""}},[i("b",[e._v("Level:")]),e._v(" "+e._s(e.getCurrentLevelDepth()))]):e._e()],1),e._v(" "),i("v-layout",{staticClass:"text-xs-center"},[i("v-flex",{attrs:{xs10:"",fluid:"",id:"minimap_container"}})],1),e._v(" "),e.showEquipment?i("v-layout",{staticClass:"pt-1",staticStyle:{"min-height":"145px"}},[i("equipment")],1):e._e(),e._v(" "),i("v-layout",[i("spellbook")],1),e._v(" "),i("v-layout",{staticClass:"mt-1"},[i("inventory")],1)],1)],1)},staticRenderFns:[]};var jt=i("VU/8")(Gt,Vt,!1,function(e){i("+wI6")},null,null).exports,Ut={data:()=>({cb:nt.player.cb,dead:nt.player.cb.dead,deathDialog:!0}),methods:{startNewGame(){location.reload()},formatNoOrMultiple:(e,t,i)=>`${0===t?"no":t} ${1===t?e:i}`,playerIsDead:()=>nt.player.isDead()}},Kt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.playerIsDead()?i("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:e.deathDialog,callback:function(t){e.deathDialog=t},expression:"deathDialog"}},[i("v-card",[i("v-card-text",{staticClass:"text-xs-center"},[i("h1",{staticClass:"red--text lighten-1"},[e._v("\n          You have died!\n      ")])]),e._v(" "),i("v-card-text",[i("v-layout",[i("v-flex",{attrs:{id:"death_text"}},[e._v("\n            You played for "+e._s(e.cb.turnsTaken)+" turns.\n            "),i("p"),e._v("\n\n            You were level "+e._s(e.cb.level)+".\n            Your strength was level "+e._s(e.cb.str)+".\n            "),i("p"),e._v("\n\n            You knew "+e._s(e.formatNoOrMultiple("spell",e.cb.spells.length,"spells"))+".\n            You casted "+e._s(e.formatNoOrMultiple("spell",e.cb.spellsCast,"spells"))+".\n            "),i("p"),e._v("\n\n            You dealt "+e._s(e.cb.damageDealt)+" damage. You received "+e._s(e.cb.damageTaken)+" damage.\n            "),i("p"),e._v("\n\n            You recovered "+e._s(e.formatNoOrMultiple("heath point",e.cb.healthRestored,"health points"))+".\n            You consumed "+e._s(e.formatNoOrMultiple("potion",e.cb.potionsConsumed,"potions"))+".\n            "),i("p"),e._v("\n\n            You defeated "+e._s(e.formatNoOrMultiple("enemy",e.cb.enemiesKilled,"enemies"))+".\n            "),i("p"),e._v("\n\n            You explored "+e._s(e.formatNoOrMultiple("dungeon floor",e.cb.dungeonsExplored,"dungeon floors"))+".\n            You looted "+e._s(e.formatNoOrMultiple("treasure chest",e.cb.chestsOpened,"treasure chests"))+".\n            "),i("p")])],1)],1),e._v(" "),i("v-card-actions",[i("img",{attrs:{src:"static/images/death_icons/tombstone.png",width:"100px",height:"100px"}}),e._v(" "),i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"green darken-3",raised:""},on:{click:function(t){t.stopPropagation(),e.startNewGame()}}},[e._v("Play Again")]),e._v(" "),i("v-spacer"),e._v(" "),i("img",{attrs:{src:"static/images/death_icons/hasty-grave.png",width:"120px",height:"100px"}})],1)],1)],1):e._e()},staticRenderFns:[]};var Jt=i("VU/8")(Ut,Kt,!1,function(e){i("ESp4")},null,null).exports;window.Game=nt;let{innerWidth:Xt,innerHeight:Zt}=window,Qt="1470px",ei="823px",ti=!0,ii="1024px",ai="640px";(Xt<=1400||Zt<=800)&&(Qt="1240px",ei="750px",ti=!1,ii="800px",ai="500px");var si={name:"app",data:()=>({mouseControls:!1,loading:!0,playerSelected:!1,unstableBuildMessage:!1,uiWidth:Qt,uiHeight:ei,gameDisplayWidth:ii,gameDisplayHeight:ai,showFooter:ti}),mounted(){window.addEventListener("resize",this.recomputeSize)},beforeDestroy(){window.removeEventListener("resize",this.recomputeSize)},components:{"start-menu":ct,"game-display":gt,hud:jt,"item-transfer-modal":_t,"death-modal":Jt,"help-dialog":Wt,"message-log":pt},created(){},methods:{loadGame(e){this.playerSelected=!0,nt.init(e),nt.log("Welcome to Rotten Soup!","information"),nt.log("Press ? to view the controls.","player_move")},recomputeSize(e){console.log("resizing!"),this.uiWidth="1470px",this.uiHeight="823px",this.showFooter=!0,this.gameDisplayWidth="1024px",this.gameDisplayHeight="640px",(window.innerWidth<=1400||window.innerHeight<=800)&&(this.uiWidth="1240px",this.uiHeight="750px",this.showFooter=!1,this.gameDisplayWidth="800px",this.gameDisplayHeight="500px"),nt.display.resize()}}},ri={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-app",{staticClass:"black",attrs:{dark:""}},[i("v-content",[i("v-container",{directives:[{name:"show",rawName:"v-show",value:e.playerSelected,expression:"playerSelected"}],staticClass:"mt-3",style:{"max-width":e.uiWidth+6,"max-height":e.uiHeight+6},attrs:{id:"main_container"}},[e.unstableBuildMessage?i("v-layout",{attrs:{row:""}},[i("v-flex",{attrs:{xs12:""}},[i("v-alert",{attrs:{color:"yellow darken-4",type:"warning",dismissible:""},model:{value:e.unstableBuildMessage,callback:function(t){e.unstableBuildMessage=t},expression:"unstableBuildMessage"}},[e._v("\n              This build is unstable. A lot of working is going on under the hood. Expect lots of broken, weird things!\n            ")])],1)],1):e._e(),e._v(" "),i("v-layout",{style:{"max-width":e.uiWidth,"max-height":e.uiHeight},attrs:{row:"",id:"ui"}},[i("v-flex",{style:{"max-width":e.gameDisplayWidth},attrs:{column:""}},[i("v-layout",{style:{"max-height":e.gameDisplayHeight},attrs:{id:"game_container_row"}},[i("div",{attrs:{id:"game_container"}})]),e._v(" "),e.playerSelected?i("message-log"):e._e()],1),e._v(" "),e.playerSelected?i("hud",{attrs:{showEquipment:e.showFooter}}):e._e()],1),e._v(" "),e.playerSelected?i("death-modal"):e._e()],1),e._v(" "),i("start-menu",{directives:[{name:"show",rawName:"v-show",value:!e.playerSelected,expression:"!playerSelected"}],on:{spriteSelected:e.loadGame}})],1),e._v(" "),e.showFooter?i("v-footer",{attrs:{app:""}},[i("small",{staticClass:"pl-2"},[e._v("RottenSoup")]),e._v(" "),i("v-btn",{attrs:{target:"_blank",href:"https://github.com/Larkenx/Rotten-Soup",icon:"",ripple:""}},[i("v-icon",[e._v("fa-github")])],1)],1):e._e()],1)},staticRenderFns:[]};var ni=i("VU/8")(si,ri,!1,function(e){i("o4Xp")},null,null).exports,oi=i("3EgV"),li=i.n(oi);i("7zck");a.a.use(li.a),a.a.config.productionTip=!1,new a.a({el:"#app",components:{App:ni},template:"<App/>"})},TiSk:function(e,t){},drkq:function(e,t){},gPi5:function(e,t){},jHJM:function(e,t){},jZkN:function(e,t){},lPMU:function(e,t){},o4Xp:function(e,t){},z9mr:function(e,t){},zLzP:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.755d44f1f2a367e7025d.js.map