webpackJsonp([1],{"2Nfd":function(e,t){},"6DgK":function(e,t){},"6EFC":function(e,t){},"7zck":function(e,t){},"9g9w":function(e,t){},ESgl:function(e,t){},KJcc:function(e,t){},NHnr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("7+uW"),s=i("cVUK"),r=i.n(s),n=i("50uv");let l=[50];for(let e=1;e<100;e++)l.push(1.5*l[e-1]);class o{constructor(e,t,i){if(this.x=e,this.y=t,Object.assign(this,i),void 0===i.id)throw"Error - entity created without valid id"}setSprite(e){this.sprite=e}setSpriteHPBar(e){this.spriteHPBar=e}move(e,t){let i=Ze.map.data[t][e];Ze.map.data[this.y][this.x].removeActor(this),i.actors.push(this),Ze.display.moveSprite(this.sprite,e,t),this.x<e?(this.sprite.scale.x=-1,this.sprite.anchor.set(1,0)):this.x>e&&(this.sprite.scale.x=1,this.sprite.anchor.set(0,0)),this.x=e,this.y=t,void 0!==this.spriteHPBar&&Ze.display.moveSprite(this.spriteHPBar,e,t-.5)}placeAt(e,t){Ze.getTile(e,t).actors.push(this),this.x=e,this.y=t,void 0!==this.sprite&&Ze.display.moveSprite(this.sprite,e,t,!1)}}class h extends o{constructor(e,t,i){i.visible=!0,super(e,t,i)}hoverInfo(){return`${this.type}${this.name}\n`}clipLocation(){getTilesetCoords(this.id);return"rect(0,32,32,0)"}use(){}getAction(){return this.action}drop(){Ze.player.dropItem(this)}}class c extends h{constructor(e,t,i){i.action="Drink",super(e,t,i)}use(){Ze.player.cb.potionsConsumed++}}class d extends c{constructor(e,t,i){super(e,t,{id:i,type:"Health Potion"})}use(){super.use(),Ze.log("You drink a health potion. It restores a little HP.","defend"),Ze.player.heal(25),Ze.player.removeFromInventory(this)}hoverInfo(){return"Effect: Heals for 25 HP"}}class p{constructor(e){if(Object.assign(this,e),void 0===this.name||void 0===this.description||void 0===this.action||void 0===this.duration)throw"Effect missing critical fields"}applyEffect(e){0!=this.duration&&(this.action(e),this.duration--)}}class u extends p{constructor(){super({name:"Bleed",action:e=>{let t=~~(.1*e.cb.maxhp);0===t&&(t=1),e.damage(t)},description:e=>{let t=~~(.1*e.cb.maxhp);return 0===t&&(t=1),e===Ze.player?`You bleed for ${t} damage.`:`${e.name.capitalize()} took ${t} bleed damage.`},duration:3})}}class m extends p{constructor(){super({name:"Regeneration",action:e=>{e.heal(10)},description:e=>e===Ze.player?"You regenerate 10 health.":`${e.name.capitalize()} regenerated 10 health.`,duration:5})}}class g extends p{constructor(e){if(void 0===e.undoAction)throw"Buffs must declare a way to undo temporary effects";super(e),this.initialDuration=this.duration}applyEffect(e){this.duration===this.initialDuration?(this.action(e),this.duration--):1===this.duration?(Ze.log(`Your ${this.name} has expired.`,"alert"),this.undoAction(e),this.duration--):this.duration--}}class v extends g{constructor(e){super({name:"Strength Buff",action:t=>{t.cb.str+=e},undoAction:t=>{t.cb.str-=e},description:t=>`${t.name} has +${e} Strength for ${this.duration} turns`,duration:5,amount:e})}}class f extends c{constructor(e,t,i){super(e,t,{id:i,type:"Strength Potion"}),this.buff=new v(3)}use(){super.use(),Ze.player.addNewBuff(this.buff),Ze.log(`You drink a strength potion. It boosts your strength for the next ${this.buff.duration+1} moves.`,"defend"),Ze.player.removeFromInventory(this)}hoverInfo(){return`Effect: +${this.buff.amount} STR for ${this.buff.duration} moves`}}class y extends c{constructor(e,t,i){super(e,t,{id:i,type:"Mana Potion"})}use(){super.use(),Ze.log("You drink a mana potion. It restores a little mana.","defend"),Ze.player.restore(10),Ze.player.removeFromInventory(this)}hoverInfo(){return"Effect: Restores 10 mana"}}class b extends h{constructor(e,t,i){if(null===i.combat)throw`Error - no options.combat property defined. Bad weapon creation for ${i.name}`;i.visible=!0,i.blocked=!1,i.combat.equippable=!0,i.combat.equipped=!1,super(e,t,i),this.cb=this.combat,this.cb.enchantments=[],this.action="Equip"}use(){Ze.player.cb.equipment.weapon===this?Ze.player.unequipWeapon():Ze.player.equipWeapon(this)}roll(){let e=0;for(let t=0;t<this.cb.rolls;t++)e+=A(1,this.cb.sides);return e}getAction(){return this.cb.equipped?"Unequip":this.action}addNewEnchantment(e){this.cb.enchantments.push(e)}hoverInfo(){return`Damage: ${this.cb.rolls}-${this.cb.sides*this.cb.rolls}`}}class w{constructor(e){if(Object.assign(this,e),void 0===this.name||void 0===this.description||void 0===this.getEffect)throw"Enchantment missing critical fields"}}class x extends w{constructor(){super({name:"Bleed",description:"Applies a bleed effect on-hit, dealing % max health damage.",getEffect:()=>new u})}}class _ extends b{constructor(e,t,i,a,s,r){super(e,t,{id:r,name:s,type:"Sword",fg:"orange",combat:{rolls:a,sides:i},attackVerbs:["slashed","stabbed","gutted","sliced"]})}}let T=["Caledfwlch","Hywelbane","Brightkiller","Excalibur","Joyeux","Dyrnwyn","Johnny Corkscrew","The Sword of Leah","The Sword of Shannara","The Vorpal Sword","Seraph Blade","Glorious","Cortana","Heosphorous","Phaesphoros","Maellartach","The Rivan Sword","The Sword of Shadows","Sikanda","Dragnipur","Chance","Vengeance","Grief","The Swords of Night and Day","The Swords of Blood and Fire","Snaga","The Sword of Truth","The Lady Vivamus","Sword of Martin","Verminfate","Rapscallion sword","Callandor","Heron Mark Sword","Graywand","Scalpel","Rhindon","Blackfyre","Brightroar","Dark Siste","Dawn","Hearteater","Heartsbane","Widow's Wail","Ice","Lady Forlorn","Longclaw","Red Rain","Albitr","Needle","The Black Blade","Mournblade","Oathkeeper","Naegling","Arvindr","Ravenbrand","Zar'roc","Lion's Tooth","Doomgiver","Kanajana","Támerlein","Shieldbreaker","Woundhealer","Narsil","Lightbringer","Soulcutter","Sightblinder","Wayfinder","Orcrist","Stonecutter","Townsaver","The Sword of Gryffindor","Farslayer","Mindsword","Dragonslicer","Katopris","Backbiter","Undbitr","Brisingr","Barrow-blade","Coinspinner","Lhang","Traitor","Anglachel","Hadhafang","Vrangr","The Darksword","The Lightsword","Herugrim","Anaklusmos","Gúthwinë","Terminus Est","Memory","Khazid'hea","Clamorer","Backbiter","Thorn","Charon's Claw","Twinkle","Godsbane","Icingdeath","Hrunting","Naegling","The Sword of the Dawn","Hill Cleaver","Werewindle","Kijin-marukuni-shige","Balaraw","Keyblade","Hina","Tessaiga","Sorrow","Singing Sword","Sword of Chaos","The Starsword","Biggoron Sword","Grayswandir","Rain Dragon","Shisui","Gurthang","Aranrúth","Nightfall","Sting"];function S(e,t,i){let a=new _(e,t,A(2,5),A(2,3),T[A(0,T.length-1)],i);return a.addNewEnchantment(new x),a}const C={ARROW:"Arrow"};class k extends h{constructor(e,t,i){i.visible=!0,i.blocked=!1,i.combat.equippable=!0,i.combat.equipped=!1,i.action="Equip",super(e,t,i),Object.assign(this,i),this.cb=this.combat}use(){Ze.player.cb.equipment.ammo===this?Ze.player.unequipAmmo():Ze.player.equipAmmo(this)}getAction(){return this.cb.equipped?"Unequip":this.action}hoverInfo(){return`Quantity: ${this.quantity}`}}class O extends k{constructor(e,t,i){i.combat.ammoType=C.ARROW,super(e,t,i)}}class R extends O{constructor(e,t,i,a){super(e,t,{id:i,type:"Steel Arrows",combat:{damage:0},quantity:a})}}function A(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function E(e,t){return Math.floor(e+(()=>{let e=0;for(let t=0;t<6;t++)e+=Math.random();return e/6})()*(t-e+1))}function L(e,t,i){return e<=t&&t<=i}function $(e){const t=["a","e","i","o","u"];if("you"!==e){return["trees","flowers","grass","wild grass","water","steel arrows"].includes(e)?"some "+e:e[0]in t?"an "+e:"a "+e}return e}let I={STRENGTH_POTION:"STRENGTH_POTION",MANA_POTION:"MANA_POTION",HEALTH_POTION:"HEALTH_POTION",SWORD:"SWORD",STEEL_ARROW:"STEEL_ARROW"};function M(e,t){let i=0;for(let a=0;a<e;a++)i+=A(1,t);return i}function D(e){if(void 0==e.dropTable||void 0==e.minItems||void 0==e.maxItems||void 0==e.x||void 0==e.y)throw"Not enough arguments given. Expected drop table object, min and max number of items to produce, and x,y location";let{dropTable:t,minItems:i,maxItems:a,x:s,y:n}=e,l=[],o=A(i,a);for(let e=0;e<o;e++){let e=r.a.RNG.getWeightedValue(t);switch(e){case I.STRENGTH_POTION:l.push(new f(s,n,969));break;case I.HEALTH_POTION:l.push(new d(s,n,488));break;case I.MANA_POTION:l.push(new y(s,n,608));break;case I.SWORD:l.push(S(s,n,35));break;case I.STEEL_ARROW:l.push(new R(s,n,784,5));break;default:console.log("tried to add some item that doesn't exist to an inventroy from drop table"),console.log(e)}}return l}function N(e){let t=[];return new r.a.FOV.PreciseShadowcasting(function(e,t){return Ze.inbounds(e,t)&&Ze.map.data[t][e].visible()}).compute(e.x,e.y,e.cb.range,(e,i,a,s)=>{Ze.inbounds(e,i)&&t.push(Ze.map.data[i][e])}),t}class B extends o{constructor(e,t,i){super(e,t,{name:"door",id:i,bg:"rgb(140, 80, 0)",fg:"red",visible:!1,blocked:!0}),this.closed=!0}react(){this.closed&&this.openDoor()}openDoor(){this.closed=!1,this.blocked=!1,this.visible=!0,this.id=Ze.display.tileset.tileproperties[this.id].activated_id,this.sprite.texture=Ze.display.tilesetMapping[this.id]}closeDoor(){this.closed=!1,this.blocked=!1,this.visible=!0,this.id=this.id}}const P={SKELETON:5489,HUMANOID:2647};class q extends o{constructor(e,t,i,a){super(e,t,{id:a,name:"skeleton"===i.toLowerCase()?"pile of bones":`${i.capitalize()} Corpse`,blocked:!1,visible:!0}),this.rotten=!1,this.turns=0}act(){if(Ze.engine.lock(),this.turns++,30===this.turns&&(this.sprite.tint=3256136),35===this.turns&&(this.sprite.tint=2520885),this.turns>=40){let e=Ze.engine._scheduler.remove(this);Ze.map.data[this.y][this.x].removeActor(this),e=Ze.map.actors.indexOf(this),Ze.map.actors.splice(e,1),Ze.display.removeChild(this.sprite)}Ze.engine.unlock()}hoverInfo(){return""}}class H extends o{constructor(e,t,i,a=null){super(e,t,i),this.cb=this.combat,void 0===this.corpseType&&(this.corpseType=P.HUMANOID),this.cb.effects=[],this.cb.equipment={head:null,torso:null,legs:null,weapon:null,ammo:null,ring:null},this.inventory=[];for(let e=0;e<27;e++)this.inventory.push({item:null,menu:!1})}act(){this.cb.effects=this.cb.effects.filter(e=>e.duration>0);for(let e of this.cb.effects)e instanceof g||Ze.log(e.description(this),"alert"),e.applyEffect(this)}addNewEffect(e){this.cb.effects.push(e)}addNewBuff(e){e.applyEffect(this),this.cb.effects.push(e)}memberOfInventory(e){return-1<this.inventory.findIndex(t=>Object.is(e,t.item))}addToInventory(e){if("quantity"in e)for(let t=0;t<this.inventory.length;t++){let i=this.inventory[t].item;if(null!==i&&i.type===e.type)return i.quantity+=e.quantity,i}let t=null;for(let e=0;e<this.inventory.length;e++)if(null==this.inventory[e].item){t=e;break}return null===t?(Ze.log("Your inventory is full! Drop something in order to pick this up."),this.placeEntityBelow(e),e):(this.inventory[t].item=e,this.inventory[t].item)}placeEntityBelow(e){e instanceof h?(e.placeAt(this.x,this.y),Ze.display.assignSprite(item)):Ze.map.data[this.y][this.x].actors.push(e)}removeFromInventory(e){let t=this.inventory.findIndex(t=>Object.is(e,t.item));if(-1==t)throw"invalid item removal - trying to remove an item that cannot be found in inventory!";this.inventory[t].item=null}dropItem(e){if(!this.memberOfInventory(e))throw"Error - trying to drop an item you don't have in your inventory";null!==e&&"cb"in e&&(e.cb.equipped=!1,this.cb.equipment.weapon==e&&(this.cb.equipment.weapon=null)),e.placeAt(this.x,this.y),Ze.display.assignSprite(e,!0,2),this.removeFromInventory(e)}items(){return this.inventory.filter(e=>null!==e.item).map(e=>e.item)}distanceTo(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}interact(e){let t=e.x-this.x,i=e.y-this.y;return this!==Ze.player&&e!==Ze.player||(Ze.display.moveSprite(this.sprite,this.x+t/2,this.y+i/2),setTimeout(()=>{Ze.display.moveSprite(this.sprite,this.x,this.y)},100)),null}react(e){return null}tryMove(e,t){if(e<0||e===Ze.map.width||t<0||t===Ze.map.height)return!1;let i=Ze.map.data[t][e];if(0===i.actors.length&&!i.blocked())return this.move(e,t),!0;if(i.actors.length>0)for(let e=0;e<i.actors.length;e++){let t=i.actors[e];if(t instanceof H&&t.blocked&&t.visible)return t.isDead()||this.interact(t),!0;t instanceof B&&this.interact(t)}return!i.blocked()&&(this.move(e,t),!0)}attack(e){let{weapon:t}=this.cb.equipment,i=null!==t?this.cb.str+t.roll():this.cb.str;t&&t.cb.ranged&&(i=this.cb.str);let a,s="";if(null!==t){let{attackVerbs:r,type:n}=t;a=r[~~(Math.random()*r.length)],s=`${$(this.name).capitalize()} ${a} ${$(e.name)} with ${$(n.toLowerCase())} and dealt ${i} damage.`}else s=`${$(this.name).capitalize()} attacked ${$(e.name)} and dealt ${i} damage.`;if(Ze.player===this?Ze.log(s,"player_move"):Ze.log(s,"attack"),i>0&&e.damage(i),this.cb.damageDealt+=i,t&&t.cb.enchantments.length>0)for(let i of t.cb.enchantments){let t=i.getEffect();e.cb.effects.some(e=>{e.name,t.name})||e.addNewEffect(t)}return i}equipWeapon(e){if(!(e instanceof b&&"cb"in e))throw"Error - equipped invalid item - "+this.item.type;null!==this.cb.equipment.weapon&&(this.cb.equipment.weapon.cb.equipped=!1),this.cb.equipment.weapon=e,e.cb.equipped=!0}equipAmmo(e){if(!(e instanceof k&&"cb"in e))throw"Error - equipped invalid item - "+this.item.type;null!==this.cb.equipment.ammo&&(this.cb.equipment.ammo.cb.equipped=!1),this.cb.equipment.ammo=e,this.cb.equipment.ammo.cb.equipped=!0}damage(e){this.cb.invulnerable||(this.cb.damageTaken+=e,this.cb.hp-=e,this.isDead()&&(this!==Ze.player&&Ze.player.gain_xp(Math.floor(.5*this.cb.maxhp)),this.death()),null!==this.sprite&&(this.sprite.tint="0xba1b21",setTimeout(()=>this.sprite.tint="0xFFFFFF",200)))}heal(e){this.cb.healthRestored+=e,this.cb.hp+e>this.cb.maxhp?this.cb.hp=this.cb.maxhp:this.cb.hp+=e}restore(e){this.cb.mana+e>this.cb.maxmana?this.cb.mana=this.cb.maxmana:this.cb.mana+=e}fireRangedWeapon(e,t){let i=this.cb.equipment.weapon,a=i.cb.range,s=i.roll()+e.cb.damage+this.cb.str,n=r.a.DIRS[8][t];for(let t=1;t<a;t++){let i=this.x+n[0]*t,a=this.y+n[1]*t,r=Ze.map.data[a][i];if(!r.visible())return void(Ze.player===this&&Ze.log(`Your ${e.type.toLowerCase()} hit an obstacle!`,"alert"));let l=r.actors.filter(function(e){return e.combat&&e.cb.hostile});if(l.length>0){let t=l[0],i=`${$(this.name).capitalize()} hit ${$(t.name)} with ${$(e.type.toLowerCase())} and dealt ${s} damage.`;return Ze.player===this?Ze.log(i,"player_move"):Ze.log(i,"attack"),void t.damage(s)}}Ze.log(`Your ${e.type.toLowerCase()} didn't hit anything!`,"alert")}death(){let e=Ze.engine._scheduler.remove(this),t=Ze.map.data[this.y][this.x];t.removeActor(this),e=Ze.map.actors.indexOf(this),Ze.map.actors.splice(e,1);Ze.display.background.children.length;if(this.inventory.length>0){let e=this.items();for(let t of e)this.dropItem(t)}if(0===A(0,1)&&void 0!==this.corpseType){let e=new q(this.x,this.y,this.name,this.corpseType);t.actors.unshift(e),Ze.scheduler.add(e,!0),Ze.display.assignSprite(e,!0)}let i=2644-A(0,1);if(this.corpseType!==P.SKELETON){let e=new n.Sprite(Ze.display.tilesetMapping[i]);e.position.set(this.x*Ze.display.tileSize,this.y*Ze.display.tileSize),Ze.display.background.addChildAt(e,1)}Ze.display.background.removeChild(this.sprite),void 0!==this.spriteHPBar&&Ze.display.background.removeChild(this.spriteHPBar),this===Ze.player?Ze.log("You died!","death"):(Ze.log(`You killed the ${this.name}.`,"death"),Ze.player.cb.enemiesKilled++)}isDead(){return this.cb.hp<=0}getHoverInfo(){return`HP: ${this.cb.hp} / ${this.cb.maxhp}<br />"${this.description}"`}getMinDmg(){let e=this.cb.equipment.weapon,t=null!==e?e.cb.rolls:0;return this.cb.str+t}getMaxDmg(){let e=this.cb.equipment.weapon,t=null!==e?e.cb.rolls*e.cb.sides:0;return this.cb.str+t}}class Y extends b{constructor(e,t,i){super(e,t,i),this.cb.ranged=!0}hoverInfo(){return`Damage: ${this.cb.rolls}-${this.cb.sides*this.cb.rolls} Range: ${this.cb.range}`}}const W=(e,t,i)=>new class extends Y{constructor(e,t,i,a,s,r,n){super(e,t,{id:i,name:a,type:"Bow",combat:{rolls:s,sides:r,range:n,ammoType:C.ARROW},attackVerbs:["slapped","smacked","whacked"]})}}(e,t,i,"Bow of the Sunwalker",3,2,8);class z extends H{constructor(e,t,i,a){super(e,t,i),this.ai=a}act(){Ze.engine.lock();const e=()=>{super.act(),Ze.engine.unlock()};let t=Math.abs(this.x-Ze.player.x),i=Math.abs(this.y-Ze.player.y);if(t>Ze.width/2||i>Ze.height/2)return void e();Ze.player.recalculatePath();let a=N(this).reduce((e,t)=>e.concat(t.actors),[]).some(e=>e===Ze.player),{wanders:s,morale:n,minPlayerDist:l,maxPlayerDist:o,ranged:h,melee:c,magic:d}=this.ai;if(a){this.chasing||Ze.log(`A ${this.name} sees you.`,"alert"),this.chasing=!0;let t=[];Ze.player.path.compute(this.x,this.y,(e,i)=>{t.push([e,i])});const i=()=>{let e=[];for(let t=0;t<7;t++){let i=r.a.DIRS[8][t],a=this.x+i[0],s=this.y+i[1];if(Ze.inbounds(a,s)){let t=Ze.getTile(a,s);t.blocked()||0!==t.actors.length||e.push(t)}}return e.push(Ze.getTile(this.x,this.y)),e},a=e=>Math.sqrt(Math.pow(Ze.player.x-e.x,2)+Math.pow(Ze.player.y-e.y,2));if(n>=this.cb.hp/this.cb.maxhp){let s=(()=>{let e=i(),t=a(e[0]),s=e[0];for(let i of e){let e=a(i);e>=t&&(t=e,s=i)}return s})();if(s.x!==this.x||s.y!==this.y)return this.fleeing||Ze.log(`The ${this.name.toLowerCase()} trembles at your might and attempts to escape death.`,"purple"),this.fleeing=!0,this.tryMove(s.x,s.y),void e();if(t.length<=2){let e=t[1];this.tryMove(e[0],e[1])}}else if(t.length>=2){let e=t[1];this.tryMove(e[0],e[1])}}else if(s){let e=this.x+A(-1,1),t=this.y+A(-1,1);this.tryMove(e,t)}e()}interact(e){super.interact(e),e===Ze.player?this.attack(e):e.react(this)}attack(e){let t=M(2,this.cb.str),i=this.cb.description.length,a=`${$(this.name).capitalize()}${this.cb.description[Math.floor(Math.random()*i)]}${$(e.name)} and dealt ${t} damage.`;return Ze.player===this?Ze.log(a,"player_move"):Ze.log(a,"attack"),t>0&&e.damage(t),t}}class F extends z{constructor(e,t,i,a=!0){super(e,t,i,{morale:0,minPlayerDist:0,maxPlayerDist:0,ranged:!1,melee:!0,magic:!1,wanders:a})}}class V extends F{constructor(e,t,i){let a=A(10,17),s=A(3,6);super(e,t,{id:i,name:"skeleton",description:"A skeleton raised from the dead!",corpseType:P.SKELETON,visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:a,maxmana:5,hp:a,mana:5,str:s,def:1,hostile:!0,range:7,invulnerable:!1}})}}class j extends F{constructor(e,t,i){let a=A(10,15);super(e,t,{id:i,name:"zombie",description:"A zombie raised from the dead!",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:a,maxmana:5,hp:a,mana:5,str:A(1,3),def:1,hostile:!0,range:7,invulnerable:!1}})}}const G={CONJURATION:"CONJURATION",CHARMS:"CHARMS",ICE:"ICE",AIR:"AIR",EARTH:"EARTH",FIRE:"FIRE",POISON:"POISON",NECROMANCY:"NECROMANCY",TRANSLOCATION:"TRANSLOCATION",TRANSMUTATION:"TRANSMUTATION",HEXES:"HEXES"},U={SELF:"SELF",TARGET:"TARGET"};class K{constructor(e){if(void 0===e.name||void 0===e.hoverInfo||void 0===e.action||void 0===e.type||void 0===e.manaCost||void 0===e.targetType)throw"Spell creation failed - insufficient information provided";Object.assign(this,e)}cast(){}}class J extends K{constructor(e){super({name:"Magic Dart",hoverInfo:"Deals 1-8 damage to a target",action:(e,t)=>{e.damage(t)},splashArt:"magic_dart",type:G.CONJURATION,targetType:U.TARGET,manaCost:3}),Object.assign(this,e)}cast(e,t){let i=A(1,8);e===Ze.player?Ze.log(`You took ${i} damage from a Magic Dart spell!`,"attack"):Ze.log(`Magic Dart blasts the ${e.name} for ${i} magical damage.`,"player_move"),this.action(e,i)}}class X extends K{constructor(e){super({name:"Pain",hoverInfo:"Deals 3-9 negative energy to a target",action:(e,t)=>{e.damage(t)},splashArt:"pain",type:G.NECROMANCY,targetType:U.TARGET,manaCost:3}),Object.assign(this,e)}cast(e,t){let i=M(3,3),a=i>=7?"extreme":"some";e===Ze.player?(Ze.log(`The ${t.name.capitalize()} casts ${this.name} on ${e.name.toLowerCase()}.`,"plum"),Ze.log(`You feel ${a} pain and take ${i} damage.`,"attack")):Ze.log(`Pain causes ${a} trauma the ${e.name} for ${i} magical damage.`,"player_move"),this.action(e,i)}}class Z extends K{constructor(e){super({name:"Regeneration",hoverInfo:"Regenerates 10 health per turn by reanimating wounds with necromancy.",action:e=>{e.addNewEffect(new m)},splashArt:"regeneration",type:G.NECROMANCY,targetType:U.SELF,manaCost:3}),Object.assign(this,e)}cast(e,t){t===Ze.player?Ze.log("You begin regenerating your wounds with dark magic.","player_move"):Ze.log(`${t.name.capitalize()} begins regenerating its wounds.`,"plum"),this.action(e)}}class Q extends K{constructor(e){super({name:"Vampiric Draining",hoverInfo:"Drains the health of an enemy for 10-20 damage, healing the caster half of the damage dealt",action:(e,t)=>{e.damage(t)},splashArt:"vampiric_draining",type:G.NECROMANCY,targetType:U.TARGET,manaCost:3}),Object.assign(this,e)}cast(e,t){let i=M(10,2);t===Ze.player?(Ze.log(`You suck the life energy out of the ${e.name.toLowerCase()}, damaging it for ${i} hp.`,"player_move"),Ze.log(`You siphon ${~~(i/2)} hp from the enemy and gain it as health.`,"lightgreen")):(Ze.log(`The ${t.name.capitalize()} casts ${this.name} on ${e.name.toLowerCase()}.`,"plum"),Ze.log(`You feel your life energy slipping away and take ${i} damage.`,"alert"),Ze.log(`The ${t.name.capitalize()} gains ${~~(i/2)} health.`,"plum")),this.action(e,i),t.heal(~~(i/2))}}const ee=e=>{let t=Ze.map.data[e.y][e.x];t.removeActor(e);let i=Ze.map.actors.indexOf(e);Ze.map.actors.splice(i,1),Ze.display.removeChild(e);let a=e.id===P.HUMANOID?new j(e.x,e.y,2317):new V(e.x,e.y,2552);a.chasing=!0,t.actors.push(a),Ze.display.assignSprite(a),Ze.map.actors.push(a),Ze.scheduler.add(a,!0)},te=e=>{let t=[];new r.a.FOV.PreciseShadowcasting(function(e,t){return Ze.inbounds(e,t)&&Ze.map.data[t][e].visible()}).compute(e.x,e.y,e.cb.range,function(e,i,a,s){Ze.inbounds(e,i)&&t.push(Ze.map.data[i][e])});let i=[];for(let e of t){let t=e.actors.filter(e=>e instanceof q);t.length>0&&i.push(t[0])}return i};class ie extends K{constructor(e){super({name:"Animate Dead",hoverInfo:"Raises all skeletons and corpses within caster's line of sight as undead.",action:e=>{te(e).forEach(e=>{ee(e)})},splashArt:"animate_dead",type:G.NECROMANCY,targetType:U.SELF,manaCost:7}),Object.assign(this,e)}cast(e,t){this.action(t),t===Ze.player?Ze.log("You raise nearby dead corpses around you into undead zombies and skeletons.","lightgreen"):(Ze.log(`The ${t.name.capitalize()} raises nearby corpses as undead minions.`,"plum"),Ze.log("The undead begin marching towards you.","plum"))}}class ae extends o{constructor(e,t,i,a){super(e,t,{id:i,name:"ladder",direction:a,description:"A ladder leading "+a,fg:"brown",bg:"orange",blocked:!1,visible:!0}),this.portal=null}act(){}react(e){let t=Ze.currentLevel.name.replace(/[0-9]/g,""),i=parseInt(Ze.currentLevel.name.replace(/[^0-9]/g,""));if("down"===this.direction)return Ze.log("You climb down the ladder...","player_move"),null!==this.portal?void Ze.changeLevels(this.portal,"down"==this.direction?"up":"down"):void Ze.changeLevels(t+(i+1),"down"==this.direction?"up":"down",i);Ze.log("You climb up the ladder...","player_move"),null===this.portal?1!==i?Ze.changeLevels(t+(i-1),"down"==this.direction?"up":"down",i):Ze.changeLevels("overworld"):Ze.changeLevels(this.portal,"down"==this.direction?"up":"down")}}function se(e,t){return!(e<=0||e>=Ze.map.width||t<=0||t>=Ze.map.height)&&!Ze.getTile(e,t).blocked()}class re extends H{constructor(e,t,i){super(e,t,{id:i,name:"you",description:"It's you!",fg:"yellow",bg:"black",visible:!0,targeting:!1,casting:!1,examining:!1,blocked:!0,leveled_up:!0,mouseEnabled:!1,combat:{description:[" attacked "," stabbed "," jabbed "," smashed "],maxhp:50,maxmana:15,xp:50,level:1,hp:50,mana:15,str:1,def:1,hpRecovery:5,manaRecovery:2.5,invulnerable:!1,validTarget:null,currentSpell:null,spells:[],range:7,enemiesKilled:0,damageDealt:0,damageTaken:0,spellsCast:0,potionsConsumed:0,healthRestored:0,dungeonsExplored:0,chestsOpened:0,dead:!1},keyTimer:null}),this.path=new r.a.Path.AStar(this.x,this.y,se),this.nearbyEnemies=[],this.currentLevel=Ze.currentLevel;let a=new _(this.x,this.y,2,2,"Training Sword",35);a.addNewEnchantment(new x),this.addToInventory(a),super.equipWeapon(this.inventory[0].item),this.addToInventory(W(this.x,this.y,664)),this.addToInventory(new R(this.x,this.y,784,30)),this.addToInventory(new d(this.x,this.y,488)),this.addToInventory(new y(this.x,this.y,608)),this.cb.spells.push(new J),this.selectSpell(this.cb.spells[0]),this.mouseEnabled=!1}selectSpell(e){this.cb.spells.includes(e)&&(this.cb.currentSpell=e)}recalculatePath(){this.path=new r.a.Path.AStar(this.x,this.y,se)}interact(e){return super.interact(e),"cb"in e&&e.cb.hostile?(this.attack(e),!!e.isDead()||void e.react(this)):(e.react(this),!1)}gain_xp(e){this.cb.xp+=e,l[this.cb.level]<=this.cb.xp&&!this.isDead()&&this.level_up()}remainingXP(){return l[this.cb.level]-this.cb.xp}level_up(){this.cb.level+=1,this.cb.maxhp+=5,this.cb.str+=1,this.cb.hp=this.cb.maxhp,this.cb.mana=this.cb.maxmana,Ze.log(`You leveled up! You are now Level ${this.cb.level}.`,"level_up"),Ze.log("Your strength and health have improved.","level_up")}act(){super.act(),this.path=new r.a.Path.AStar(this.x,this.y,se),this.nearbyEnemies=Ze.getNearbyEnemies(),this.currentLevel=Ze.currentLevel,Ze.engine.lock(),window.addEventListener("keydown",this),this.mouseEnabled&&(window.addEventListener("mousemove",this),window.addEventListener("click",this))}handleEvent(e){Object.assign(Ze.map.seen_tiles,Ze.map.visible_tiles),Ze.map.visible_tiles={},new r.a.FOV.PreciseShadowcasting((e,t)=>Ze.inbounds(e,t)&&Ze.getTile(e,t).visible()).compute(Ze.player.x,Ze.player.y,Ze.player.cb.range,(e,t,i,a)=>{Ze.map.visible_tiles[e+","+t]=!0});let t=()=>{let e=e=>{this.keyTimer=null};window.removeEventListener("keyup",e),window.removeEventListener("keydown",this),window.removeEventListener("mousemove",this),window.removeEventListener("click",this),window.addEventListener("keyup",e),Ze.clearTempLog(),Ze.engine.unlock()};const i=()=>{let e=Ze.selectedTile,i=this.cb.equipment.ammo,a=this.cb.equipment.weapon.roll()+i.cb.damage+this.cb.str;i.quantity--,0===i.quantity&&Ze.log(`You fire your last ${i.type.toLowerCase()}!`,"alert");let s=e.actors.filter(e=>void 0!==e.cb&&e.cb.hostile);if(s.length>0){let e=s[0],t=`${$(this.name).capitalize()} hit ${$(e.name)} with ${$(i.type.toLowerCase())} and dealt ${a} damage.`;Ze.log(t,"player_move"),e.damage(a)}else Ze.log(`Your ${i.type.toLowerCase()} didn't hit anything!`,"alert");0==i.quantity&&(this.unequipAmmo(),this.removeFromInventory(i)),this.targeting=!1,this.validTarget=null,Ze.clearSelectedTile(),t()},a=()=>{let e=Ze.selectedTile.actors.filter(e=>void 0!==e.cb&&e.cb.hostile);if(e.length>0){e[0];Ze.log(`You cast ${this.cb.currentSpell.name} at the ${e[0].name}.`,"magic"),this.cb.currentSpell.cast(e[0],this)}else Ze.log(`You cast ${this.cb.currentSpell.name} but it hits nothing!`,"magic");this.cb.mana-=this.cb.currentSpell.manaCost,this.casting=!1,this.validTarget=null,this.cb.spellsCast++,Ze.clearSelectedTile(),t()};if("click"===e.type)return void(this.targeting?this.validTarget?i():Ze.log("You cannot shoot this tile because it's blocked or out of range!","alert"):this.casting&&(this.validTarget?a():Ze.log(`You cannot cast ${this.cb.currentSpell.name} at this tile because it's blocked or too far away.`,"alert")));if("mousemove"===e.type){let e=Ze.eventToTile();return null!==e&&(this.validTarget=Ze.changeSelectedTile(e)),setTimeout(()=>{this.mouseMoved=!0},18),void(this.mouseMoved&&(this.mouseMoved=!1))}let s=e.keyCode,n=e.getModifierState("Shift"),l=[0,1,2,3,4,5,6,7],o=[9,61,187,191],h=[101,13,190],c=[70,27,90,88];o.includes(s)&&e.preventDefault();let d={39:2,37:6,38:0,40:4,104:0,105:1,102:2,99:3,98:4,97:5,100:6,103:7,101:"rest",75:0,85:1,76:2,78:3,74:4,66:5,72:6,89:7,70:"fire",90:"cast",188:"pickup",71:"pickup",190:"rest",88:"examine"};if("keydown"===e.type&&l.includes(d[s]))if(null===this.keyTimer)this.keyTimer=new Date;else{let e=this.keyTimer.getTime();if(!((new Date).getTime()-e>=160))return;this.keyTimer=new Date}if(this.targeting||this.casting||this.examining){let e="";if(c.includes(s))this.targeting&&(e=`You put away your ${this.cb.equipment.weapon.type.toLowerCase()}.`),this.casting&&(e="You stop casting the spell."),this.examining&&(e="You quit examining the area."),Ze.log(e,"information"),this.casting=this.targeting=this.examining=!1,Ze.clearTempLog(),Ze.clearSelectedTile();else if(h.includes(s))if(this.validTarget)this.casting&&a(),this.targeting&&i();else{if(this.casting&&(e=`You cannot cast ${this.cb.currentSpell.name} at this tile because it's blocked or too far away.`),this.targeting&&(e="You cannot shoot this tile because it's blocked or out of range!"),this.examining)return;Ze.log(e,"alert")}else if(l.includes(d[s])){let e=r.a.DIRS[8][d[s]],t=Ze.selectedTile.x+e[0],i=Ze.selectedTile.y+e[1];Ze.inbounds(t,i)&&Ze.inViewport(t,i)&&(Ze.changeSelectedTile(Ze.getTile(t,i)),this.validTarget=!Ze.selectedTile.blocked()&&void 0!==Ze.map.visible_tiles[t+","+i])}else o.includes(s)&&(this.validTarget=Ze.cycleThroughSelectableEnemies())}else if(s in d){if("rest"!==d[s]||n)if("pickup"!==d[s]||n)if("rest"===d[s]&&n)this.climb("down");else if("pickup"===d[s]&&n)this.climb("up");else{if("fire"===d[s]&&!n){let e=this.cb.equipment.weapon,t=this.cb.equipment.ammo;return null!==e&&null!==t&&e.cb.ranged&&t.cb.ammoType===e.cb.ammoType&&t.quantity>0?(Ze.log(`You take aim with your ${e.type.toLowerCase()}.`,"information"),Ze.log(`Select a target with the movement keys and press [enter] or [.] to fire your ${e.type.toLowerCase()}.`,"player_move"),this.validTarget=Ze.selectNearestEnemyTile(),this.validTarget||Ze.changeSelectedTile(Ze.getTile(this.x,this.y)),void(this.targeting=!0)):void(null!==e&&e.cb.ranged?null===t?Ze.log("You don't have any ammunition equipped.","information"):t.cb.ammoType!==e.cb.ammoType&&Ze.log("You don't have the right ammunition equipped for this weapon.","information"):Ze.log("You don't have a ranged weapon equipped!","information"))}if("cast"===d[s]){let e=this.cb.currentSpell;if(null===e)return void Ze.log("You must select a spell to cast. Select one from the spellbook!","information");if(e.manaCost>this.cb.mana)return void Ze.log(`You don't have enough mana to cast ${e.name}!`,"alert");if(e.targetType===U.SELF)Ze.log(`You cast ${e.name}.`,"magic"),e.cast(this,this),this.cb.mana-=e.manaCost;else if(e.targetType===U.TARGET)return Ze.log("You begin casting a spell.","defend"),Ze.log("Select a target with the movement keys and press [enter] or [.] to cast the spell.","player_move"),this.validTarget=Ze.selectNearestEnemyTile(),this.validTarget||Ze.changeSelectedTile(Ze.getTile(this.x,this.y)),void(this.casting=!0)}else{if("examine"===d[s])return Ze.log("You begin examining the area.","information"),this.examining=!0,void Ze.changeSelectedTile(Ze.getTile(this.x,this.y));{let e=r.a.DIRS[8][d[s]],t=this.x+e[0],i=this.y+e[1];if(!this.tryMove(t,i))return}}}else this.pickup();else Ze.log("You rest for a turn.","player_move");t()}}pickup(){let e=Ze.map.data[this.y][this.x],t=e.actors.filter(e=>e instanceof h);if(1===t.length)Ze.log(`You picked up a ${t[0].type.toLowerCase()}.`,"information"),Ze.display.clearSprite(t[0]),this.addToInventory(t[0]),e.removeActor(t[0]);else if(t.length>1){let i=[];for(let a of t)i.push(a.type.toLowerCase()),Ze.display.clearSprite(a),this.addToInventory(a),e.removeActor(a);let a=i.slice(1,i.length-1),s=`You picked up ${(a=a.reduce((e,t)=>e+", a "+t,"a  "+i.slice(0,1)))+` and a ${i.slice(-1)}.`}`;Ze.log(s,"information")}else Ze.log("There's nothing to pick up.","information")}equipWeapon(e){super.equipWeapon(e),Ze.log(`You wield the ${e.type.toLowerCase()}.`,"information")}unequipWeapon(){if(null===this.cb.equipment.weapon)throw"Tried to uneqip weapon but no item was equipped.";this.cb.equipment.weapon.cb.equipped=!1,this.cb.equipment.weapon=null}unequipAmmo(){if(null===this.cb.equipment.ammo)throw"Tried to uneqip ammo but no item was equipped.";this.cb.equipment.ammo.cb.equipped=!1,this.cb.equipment.ammo=null}climb(e){let t=Ze.map.data[this.y][this.x].actors.filter(e=>e instanceof ae)[0];void 0===t||t.direction!==e?Ze.log(`You cannot climb ${e} here.`,"information"):t.react(this)}tryMove(e,t){if(!Ze.inbounds(e,t))return;let i=Ze.getTile(e,t);if(0===i.actors.length&&!i.blocked())return this.move(e,t),Ze.clearSelectedTile(),!0;if(i.actors.length>0)for(let e=0;e<i.actors.length;e++){let t=i.actors[e];if(t.blocked)return this.interact(t),!0}return!i.blocked()&&(this.move(e,t),Ze.clearSelectedTile(),!0)}attack(e){super.attack(e)}death(){super.death(),window.removeEventListener("keydown",this),this.cb.hp=0,this.cb.dead=!0,Ze.scheduler.clear()}}function ne(e){return Ze.display.tileset.tileproperties[e+""]}class le{constructor(e,t){this.x=e,this.y=t,this.actors=[],this.obstacles=[]}updateTileInfo(e){let t={};e in Ze.display.tileset.tileproperties&&(t=ne(e)),t.id=e,this.obstacles.push(t)}blocked(){return this.obstacles.length>0&&this.obstacles[this.obstacles.length-1].blocked}visible(){return!(this.obstacles.some(e=>e.blocks_vision)||this.actors.some(e=>!e.visible))}removeActor(e){let t=this.actors.findIndex(t=>Object.is(e,t));this.actors.splice(t,1)}bg(){let e=this.obstacles;if(!e.some(e=>"bg"in e))return"black";for(let t=e.length-1;t>=0;t--){let i=e[t];if("bg"in i)return i.bg}}}class oe extends H{constructor(e,t,i){super(e,t,{id:i,name:"non-player character",visible:!0,blocked:!0,combat:{hostile:!1}})}}class he extends z{constructor(e,t,i){let a=A(6,9);if(super(e,t,{id:i,name:"goblin",description:"A mean, green goblin!",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:a,maxmana:5,hp:a,mana:5,str:A(1,3),def:1,hostile:!0,range:9,invulnerable:!1}},{morale:.2,minPlayerDist:0,maxPlayerDist:0,ranged:!1,melee:!0,magic:!1,wanders:!0}),A(1,10)<2){D({minItems:0,maxItems:1,dropTable:{STRENGTH_POTION:3,HEALTH_POTION:2,MANA_POTION:2,STEEL_ARROW:2,SWORD:0},x:this.x,y:this.y}).forEach(e=>this.addToInventory(e))}}}class ce extends F{constructor(e,t,i,a=!1){let s=A(20,25);super(e,t,{id:i,name:"Kobold",description:"A cold-blooded kobold!",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:s,maxmana:5,hp:s,mana:5,str:A(5,7),def:1,hostile:!0,range:9,invulnerable:!1}}),D({minItems:0,maxItems:2,dropTable:{STRENGTH_POTION:1,HEALTH_POTION:1,STEEL_ARROW:2,SWORD:1},x:this.x,y:this.y}).forEach(e=>this.addToInventory(e))}}class de extends F{constructor(e,t,i,a=!1){let s=A(30,35),r=A(5,10);if(super(e,t,{id:i,name:a?"Empowered Orc":"orc",description:"All bronze and no brains!",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:s,maxmana:5,hp:s,mana:5,str:r,def:1,hostile:!0,range:5,invulnerable:!1,empowered:a}},!1),A(1,10)<5){D({minItems:0,maxItems:2,dropTable:{STRENGTH_POTION:1,HEALTH_POTION:1,STEEL_ARROW:1,MANA_POTION:1,SWORD:1},x:this.x,y:this.y}).forEach(e=>this.addToInventory(e))}}interact(e){if(e===Ze.player){let t=this.attack(e);if(this.cb.empowered){let e=Math.floor(t/2);Ze.log(`The empowered orc steals your health and regenerates ${e} health!`,"alert"),this.heal(e)}}else e.react(this)}}class pe extends F{constructor(e,t,i){super(e,t,{id:i,name:"rat",description:"A fat rat!",symbol:"r",fg:"grey",bg:"seagreen",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:3,maxmana:0,hp:3,mana:0,str:1,def:0,hostile:!0,range:4,invulnerable:!1}})}}class ue extends z{constructor(e,t,i){let a=A(4,8);super(e,t,{id:i,name:"bat",description:"A creature of the night!",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:a,maxmana:5,hp:a,mana:5,str:A(1,2),def:1,hostile:!0,range:9,invulnerable:!1}},{morale:.4,minPlayerDist:0,maxPlayerDist:0,ranged:!1,melee:!0,magic:!1,wanders:!0})}}class me extends z{constructor(e,t,i){let a=A(4,8);super(e,t,{id:i,name:"wild goat",description:"A really pissed off goat!",visible:!0,blocked:!0,chasing:!1,combat:{description:[" headbutted "," rammed "],maxhp:a,maxmana:5,hp:a,mana:5,str:A(1,2),def:1,hostile:!0,range:9,invulnerable:!1}},{morale:.4,minPlayerDist:0,maxPlayerDist:0,ranged:!1,melee:!0,magic:!1,wanders:!0})}}class ge extends o{constructor(e,t,i){super(e,t,{name:"chest",id:i,visible:!0,blocked:!0}),this.closed=!0,this.items=[]}react(e){let t=e===Ze.player;if(this.closed)this.open();else if(0===this.items.length&&t)Ze.log("There's nothing left in this chest!","information");else{t&&Ze.log("You collect everything from the chest.","information");for(let t of this.items)e.addToInventory(t);t&&Ze.player.cb.chestsOpened++,this.items=[]}}addToInventory(e){this.items.push(e)}open(){this.closed=!1,this.id=Ze.display.tileset.tileproperties[this.id].activated_id,this.sprite.texture=Ze.display.tilesetMapping[this.id]}}class ve extends h{constructor(e,t,i){super(e,t,{id:i,type:"Key"})}hoverInfo(){return""}}var fe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e};class ye extends h{constructor(e,t,i,a){super(e,t,fe({id:i,action:"Read",type:"Spellbook"},a))}use(){for(let e of this.spells)Ze.player.cb.spells.some(t=>t.name===e.name)||Ze.player.cb.spells.push(e);Ze.player.removeFromInventory(this)}hoverInfo(){}}class be extends o{constructor(e,t,i,a){super(e,t,{id:i,name:"path",direction:a,description:"A path leading to a new area!",fg:"brown",bg:"orange",blocked:!0,visible:!0}),this.portal=null}act(){}react(e){Ze.log(`You leave the ${Ze.currentLevel.name} and go to the ${this.portal}.`,"information"),Ze.changeLevels(this.portal)}}const we={0:(e,t,i)=>new re(e,t,i),1:(e,t,i)=>new he(e,t,i),2:(e,t,i)=>new pe(e,t,i),3:(e,t,i)=>new ae(e,t,i,"down"),4:(e,t,i)=>new ae(e,t,i,"up"),5:(e,t,i)=>S(e,t,i),6:(e,t,i)=>new oe(e,t,i),7:(e,t,i)=>new de(e,t,i),8:(e,t,i)=>new de(e,t,i,!0),9:(e,t,i)=>new B(e,t,i),10:(e,t,i)=>new ge(e,t,i),11:(e,t,i)=>new d(e,t,i),12:(e,t,i)=>new f(e,t,i),13:(e,t,i)=>new y(e,t,i),14:(e,t,i)=>new _(e,t,4,7,"Orc Purifier",i),15:(e,t,i)=>new ve(e,t,i),16:(e,t,i)=>new class extends B{constructor(e,t,i){super(e,t,i),this.name="locked door"}react(e){if(this.closed&&e===Ze.player){let t=e.items().filter(e=>e instanceof ve);0===t.length?Ze.log("You need a key to open this door.","alert"):(Ze.log("You use a key to unlock the door.","player_move"),e.removeFromInventory(t[0]),this.openDoor())}}}(e,t,i),17:(e,t,i)=>W(e,t,i),18:(e,t,i)=>new R(e,t,i,5),19:(e,t,i)=>new ce(e,t,i),20:(e,t,i)=>new ue(e,t,i),21:(e,t,i)=>new class extends H{constructor(e,t,i){super(e,t,{id:i,name:"Lich",description:"Once a powerful necromancer, now transformed into a lich.",visible:!0,blocked:!0,chasing:!1,combat:{description:[" attacked "],maxhp:40,maxmana:25,hp:40,mana:25,str:15,def:5,hostile:!0,range:7,invulnerable:!1}}),this.spells={regeneration:new Z({cd:0,maxCD:5}),pain:new X({cd:0,maxCD:2}),vampiricDraining:new Q({cd:0,maxCD:5}),animateDead:new ie({cd:0,maxCD:7})}}act(){Ze.engine.lock();for(let e in this.spells)this.spells[e].cd=0===this.spells[e].cd?0:this.spells[e].cd-1;let e=Math.abs(this.x-Ze.player.x),t=Math.abs(this.y-Ze.player.y);if(e>Ze.width/2||t>Ze.height/2)return Ze.engine.unlock(),void super.act();this.intro||(Ze.log("You feel a sense of hopelessness and fear come over you.","crimson"),Ze.log("Something evil is nearby.","crimson")),this.intro=!0,Ze.player.recalculatePath();let i=[];if(N(this).reduce((e,t)=>e.concat(t.actors),[]).some(e=>e===Ze.player)){this.chasing||Ze.log(`A ${this.name} sees you.`,"alert"),this.chasing=!0,Ze.player.path.compute(this.x,this.y,function(e,t){i.push([e,t])});let e=this.cb.maxhp-this.cb.hp,t=te(this);const a=e=>{e.cd=e.maxCD};if(2===i.length)if(Ze.player.cb.hp<=15){let e=i[1];this.tryMove(e[0],e[1])}else if(e>=10&&0===this.spells.vampiricDraining.cd)this.spells.vampiricDraining.cast(Ze.player,this),a(this.spells.vampiricDraining);else if(e>=25&&0===this.spells.regeneration.cd)this.spells.regeneration.cast(this,this),a(this.spells.regeneration);else if(t.length>=2&&0===this.spells.animateDead.cd)this.spells.animateDead.cast(this,this),a(this.spells.animateDead);else{let e=i[1];this.tryMove(e[0],e[1])}else Ze.player.cb.hp<=9&&0===this.spells.pain.cd?(this.spells.pain.cast(Ze.player,this),a(this.spells.pain)):t.length>=2&&0===this.spells.animateDead.cd?(this.spells.animateDead.cast(this,this),a(this.spells.animateDead)):e>=25&&0===this.spells.regeneration.cd?(this.spells.regeneration.cast(this,this),a(this.spells.regeneration)):0===this.spells.pain.cd&&(this.spells.pain.cast(Ze.player,this),a(this.spells.pain))}Ze.engine.unlock(),super.act()}interact(e){e===Ze.player?this.attack(e):e.react(this)}}(e,t,i),22:(e,t,i)=>new be(e,t,i),23:(e,t,i)=>new j(e,t,i),24:(e,t,i)=>new V(e,t,i),25:(e,t,i)=>new q(e,t,"zombie",i),26:(e,t,i)=>new q(e,t,"skeleton",i),27:(e,t,i)=>new class extends ye{constructor(e,t,i){super(e,t,i,{spells:[new X,new Q,new ie,new Z],name:"Book of Death"})}use(){super.use(),Ze.log("You have learned necromancy spells...but at what cost?","lightgreen")}}(e,t,i),28:(e,t,i)=>new me(e,t,i)};function xe(e,t,i,a){if(i in we)return we[i](e,t,a);throw`No entity assigned to ID ${i} for frame ${a} at ${e+","+t}`}function _e(e){let{layers:t,width:i,height:a}=e,s=new Te(i,a);return s.createFromJSON(e),s}class Te{constructor(e,t){this.loadedIDS=[],this.playerLocation=null,this.width=e,this.height=t,this.actors=[],this.data=new Array(this.height),this.visible_tiles={},this.seen_tiles={};for(let e=0;e<this.height;e++){this.data[e]=new Array(this.width);for(let t=0;t<this.width;t++)this.data[e][t]=new le(t,e)}}getTile(e,t){return this.data[t][e]}createFromJSON({layers:e}){let t=[],i=[];for(let a of e)if(!0===a.properties.obstacles)this.processObstacleLayer(a);else if(!0===a.properties.items)t.push(a);else if(!0===a.properties.actors)this.processActorLayer(a);else{if(!0!==a.properties.portal)throw"A layer has been added to the map and is invalid";i.push(a)}for(let e of t)this.processItemLayer(e);for(let e of i)this.processPortalLayer(e)}processObstacleLayer(e){for(let t=0;t<this.height;t++)for(let i=0;i<this.width;i++){let a=e.data[t*this.width+i]-1;a>1&&(Ze.loadedIDS.push(a),this.data[t][i].updateTileInfo(a))}}processActorLayer(e){for(let t=0;t<this.height;t++)for(let i=0;i<this.width;i++){let a=e.data[t*this.width+i]-1;if(a>1){Ze.loadedIDS.push(a);let e=ne(a);if(!0!==e.entity)throw"Bad entity creation for tile "+a;if(0===e.entity_id)this.playerLocation=[i,t],this.playerID=a;else{let s=xe(i,t,e.entity_id,a);this.actors.push(s),this.data[t][i].actors.push(s)}}}}processItemLayer(e){for(let t=0;t<this.height;t++)for(let i=0;i<this.width;i++){let a=e.data[t*this.width+i]-1;if(a>1){Ze.loadedIDS.push(a);let e=ne(a);if(!0!==e.entity)throw"Bad entity creation for tile "+a;let s=xe(i,t,e.entity_id,a);this.actors.push(s),this.findActor(i,t).addToInventory(s)}}}processPortalLayer(e){for(let t=0;t<this.height;t++)for(let i=0;i<this.width;i++){let a=e.data[t*this.width+i]-1;if(a>1){Ze.loadedIDS.push(a);let e=ne(a),s=this.data[t][i].actors.filter(e=>e instanceof ae||e instanceof be);if(0===s.length)throw"tried to create a portal link for a ladder or level transition but neither was found";s[0].portal=e.level}}}print(){let e="";for(let t=0;t<this.height;t++){let i="";for(let e=0;e<this.width;e++)i+=this.data[t][e].symbol;e+=i+"\n"}for(let t=0;t<this.actors.length;t++){let i=this.actors[t],a=i.y*this.width+i.x+i.y;e=e.substr(0,a)+i.symbol+e.substr(a+1)}console.log(e)}findActor(e,t){let i=this.data[t][e].actors.filter(e=>e instanceof ge);if(0===i.length){let i=this.data[t][e].actors;if(0===i.length)throw`There's no actor in which an item can be placed at (${e},${t})`;return i[0]}return i[0]}adjTiles(e){let t=[];for(let i of ROT.DIRS[8]){let a=e.x+i[0],s=e.y+i[1];a<0||a===this.width||s<0||s===this.height||t.push(this.data[s][a])}return t}}const Se={ORC:[5292,5293,5294,5295,5296,5297,5299],EMPOWERED_ORC:[5298],GOBLIN:[7440,7441,7442,7443,7444,7445,7446],RAT:[2365],BAT:[3704,3706],KOBOLD:[5532,5533,5534,5535,5536,5537,5538,5539]},Ce=e=>e.reduce((e,t)=>e.concat(Array.isArray(t)?Ce(t):t),[]),ke=e=>{let t=A(0,e.length),i=e.splice(t,1);return 1===i.length?i[0].split(",").map(e=>Number(e)):null};const Oe={ORC:[5292,5293,5294,5295,5296,5297,5299],EMPOWERED_ORC:[5298],GOBLIN:[7440,7441,7442,7443,7444,7445,7446],RAT:[2365],BAT:[3704,3706],KOBOLD:[5532,5533,5534,5535,5536,5537,5538,5539]},Re=e=>{let t=A(0,e.length),i=e.splice(t,1);return 1===i.length?i[0].split(",").map(e=>Number(e)):null};var Ae=i("wG9/"),Ee=i.n(Ae),Le=i("d+bC"),$e=i.n(Le);const Ie={OLD_BEACH:{type:"OLD_BEACH",textures:{upperLeft:8816,top:8817,upperRight:8818,left:8936,center:8937,right:8938,lowerLeft:9056,bottom:9057,lowerRight:9058,endLeft:8940,middleCorridorHorizontal:8941,endRight:8942,endTop:8819,middleCorridorVertical:8939,endBottom:9059,single:8937}},BEACH:{type:"BEACH",textures:{upperLeft:8830,top:8831,upperRight:8832,left:8950,center:8951,right:8952,lowerLeft:9070,bottom:9071,lowerRight:9072,endLeft:8954,middleCorridorHorizontal:8955,endRight:8956,endTop:8833,middleCorridorVertical:8953,endBottom:9073,single:8951}},OCEAN_WATER:{type:"OCEAN_WATER",textures:{upperLeft:9017,top:9017,upperRight:9017,left:9017,center:9017,right:9017,lowerLeft:9017,bottom:9017,lowerRight:9017,endLeft:9017,middleCorridorHorizontal:9017,endRight:9017,endTop:9017,middleCorridorVertical:9017,endBottom:9017,single:9017}},COASTAL_WATER:{type:"COASTAL_WATER",textures:{upperLeft:8176,top:8177,upperRight:8178,left:8296,center:8297,right:8298,lowerLeft:8296,bottom:8297,lowerRight:8298,endLeft:8296,middleCorridorHorizontal:8177,endRight:8178,altUpperRight:8181,endTop:8177,middleCorridorVertical:8298,endBottom:8296,single:8178}},FOREST:{type:"FOREST",textures:{hasCorridors:!0,upperLeft:7743,top:7744,upperRight:7745,left:7863,center:7864,right:7865,lowerLeft:7983,bottom:7984,lowerRight:7985,endLeft:7867,middleCorridorHorizontal:7868,endRight:7869,endTop:7746,middleCorridorVertical:7866,endBottom:7986,single:7748}},MOUNTAIN:{type:"MOUNTAIN",textures:{upperLeft:9197,top:9198,upperRight:9199,left:9317,right:9317,lowerLeft:9437,bottom:9198,lowerRight:9439,endLeft:9198,middleCorridorHorizontal:9198,endRight:9198,endTop:9198,middleCorridorVertical:9200,endBottom:9198,middleT:9201,middleIntersection:9321}},SNOW:{type:"SNOW",textures:{}}},Me={ORC:[5292,5293,5294,5295,5296,5297,5299],EMPOWERED_ORC:[5298],GOBLIN:[7440,7441,7442,7443,7444,7445,7446],RAT:[2362,2363,2365,2366],BAT:[3704,3706],KOBOLD:[5532,5533,5534,5535,5536,5537,5538,5539],WILD_GOAT:[2600,2601,2602,2603,2604,2605]},De=1242,Ne=1243,Be=1362,Pe=1363,qe=1722,He=1726,Ye=1724,We=7355,ze=1482,Fe=1483,Ve=1484,je=1485;var Ge={randomCave:function(e,t,i,a=1){let s={revealed:!0};s.width=e,s.height=t,s.layers=[{data:[],properties:{obstacles:!0}},{data:[],properties:{obstacles:!0}},{data:[],properties:{actors:!0}},{data:[],properties:{actors:!0}}];let n={},l=new r.a.Map.Cellular(e,t);l.randomize(.5);for(let e=0;e<10;e++)l.create();l.connect(function(e,t,i){i||(n[e+","+t]=!0)});for(let i=0;i<t;i++){for(let e=0;e<s.layers.length;e++)s.layers[e].data.push([]);for(let t=0;t<e;t++)t+","+i in n?s.layers[0].data[i].push(9298):s.layers[0].data[i].push(9201),s.layers[1].data[i].push(0),s.layers[2].data[i].push(0),s.layers[3].data[i].push(0)}let o=9197,h=9198,c=9199,d=9317,p=9437,u=9198,m=9439,g={upperLeft:9176,top:9177,upperRight:9178,left:9296,center:9297,right:9298,lowerLeft:9416,bottom:9417,lowerRight:9418,endLeft:9300,middleCorridorHorizontal:9301,endRight:9302,endTop:9179,middleCorridorVertical:9299,endBottom:9419,single:9181},v=(e,t)=>{let i=0,a=`${e},${t-1}`,s=`${e},${t+1}`,r=`${e-1},${t}`,l=`${e+1},${t}`,o=`${e+1},${t-1}`,h=`${e-1},${t+1}`,c=`${e-1},${t-1}`,d=`${e+1},${t+1}`,p=e=>e in n;if(p(a)&&(i+=1),p(l)&&(i+=2),p(s)&&(i+=4),p(r)&&(i+=8),0==i){if(p(h)&&p(o)||p(c)&&p(d))return 21;if(p(c)&&p(a)&&p(d))return 20;if(p(d)&&p(s)&&p(c))return 20;if(p(c))return 16;if(p(o))return 17;if(p(h))return 18;if(p(d))return 19}return i},f={0:7046,1:u,2:d,3:c,4:h,5:h,6:m,7:u,8:9317,9:o,10:d,11:9319,12:p,13:u,14:9318,15:9318,16:m,17:p,18:c,19:o,20:9201,21:9321},y={0:g.single,1:g.endBottom,2:g.endLeft,3:g.lowerLeft,4:g.endTop,5:g.middleCorridorVertical,6:g.upperLeft,7:g.left,8:g.endRight,9:g.lowerRight,10:g.middleCorridorHorizontal,11:g.bottom,12:g.upperRight,13:g.right,14:g.top,15:g.center,16:g.single,17:g.single,18:g.single,19:g.lowerLeft,20:g.middleT};for(let i=0;i<t;i++)for(let t=0;t<e;t++)if(`${t},${i}`in n){let e=y[v(t,i)]+1;s.layers[0].data[i][t]=e}else{let e=f[v(t,i)]+1;s.layers[0].data[i][t]=e}let b=Object.keys(n),w=ke(b);if(null===w)throw"Could not find an open spot on the map to place the player!";s.layers[2].data[w[1]][w[0]]=Ze.playerID,s.layers[3].data[w[1]][w[0]]="down"===i?238:237;let x=ke(b);s.layers[2].data[x[1]][x[0]]="down"===i?237:238,x=ke(b),s.layers[2].data[x[1]][x[0]]="down"===i?237:238;let _=E(7+a,25+a);for(let e=0;e<_;e++){let e=ke(b);if(null===e)break;let t=r.a.RNG.getWeightedValue(mobDistribution),i=Se[t],a=(createActor(t),i[A(0,i.length-1)]+1);s.layers[2].data[e[1]][e[0]]=a}for(let e=0;e<s.layers.length;e++)s.layers[e].data=Ce(s.layers[e].data);return s},randomDungeon:function(e,t,i,a=1){let s=new Te(e,t);const n={upperLeft:7735,top:7736,upperRight:7737,left:7855,center:7856,right:7857,lowerLeft:7975,bottom:7976,lowerRight:7977,endLeft:7859,middleCorridorHorizontal:7860,endRight:7861,endTop:7738,middleCorridorVertical:7858,endBottom:7978,single:7740},l={left:7860,middle:7861,right:7862},o={top:7739,middle:7859,bottom:7979},h={upperLeft:8116,top:8117,upperRight:8118,left:8236,center:8237,right:8236,lowerLeft:8356,bottom:8117,lowerRight:8358,endBottom:8237,endTop:8238,island:8119,leftT:8241,middleT:8240,rightT:8239,topT:8120,bottomT:8360},c=569,d=568,p=477,u=479,m={ORC:1*~~(a/4)+1,EMPOWERED_ORC:~~(a/4),KOBOLD:~~(a/3),GOBLIN:10-~~(a/2),BAT:8-~~(a/4),RAT:8-~~(a/4)},g=(e,t,i,a)=>{switch(e){case"ORC":return new de(t,i,a);case"EMPOWERED_ORC":return new de(t,i,a,!0);case"KOBOLD":return new ce(t,i,a);case"GOBLIN":return new he(t,i,a);case"BAT":return new ue(t,i,a);case"RAT":return new pe(t,i,a);default:throw"Unidentified actor given to create actor"}};let v=0,f={},y=new r.a.Map.Digger(e,t,{roomWidth:[6,20],corrdiorLength:[4,4],roomDugPercentage:.4}).create(function(e,t,i){i||(f[e+","+t]=!0)}),b=(e,t)=>{let i=0,a=`${e},${t-1}`,s=`${e},${t+1}`,r=`${e-1},${t}`,n=`${e+1},${t}`,l=`${e+1},${t-1}`,o=`${e-1},${t+1}`,h=`${e-1},${t-1}`,c=`${e+1},${t+1}`,d=e=>e in f;if(d(a)&&(i+=1),d(n)&&(i+=2),d(s)&&(i+=4),d(r)&&(i+=8),0==i){if(d(h))return 16;if(d(l))return 17;if(d(o))return 18;if(d(c))return 19}return i},w=(e,t)=>{let i=0,a=`${e},${t-1}`,s=`${e},${t+1}`,r=`${e-1},${t}`,n=`${e+1},${t}`,l=`${e+1},${t-1}`,o=`${e-1},${t+1}`,h=`${e-1},${t-1}`,c=`${e+1},${t+1}`,d=e=>e in f;if(d(a)&&(i+=1),d(n)&&(i+=2),d(s)&&(i+=4),d(r)&&(i+=8),d(a)&&!d(s)&&!d(n)&&!d(r)&&(d(o)||d(c)))return 20;if(0==i){if(d(h))return 16;if(d(l))return 17;if(d(o))return 18;if(d(c))return 19}return i},x={0:n.single,1:n.endBottom,2:n.endLeft,3:n.lowerLeft,4:n.endTop,5:n.middleCorridorVertical,6:n.upperLeft,7:n.left,8:n.endRight,9:n.lowerRight,10:n.middleCorridorHorizontal,11:n.bottom,12:n.upperRight,13:n.right,14:n.top,15:n.center,16:n.single,17:n.single,18:n.single,19:n.lowerLeft},_={0:7046,1:h.bottom,2:h.left,3:h.upperRight,4:h.top,5:h.top,6:h.lowerRight,7:h.bottom,8:h.right,9:h.upperLeft,10:h.left,11:h.endTop,12:h.lowerLeft,13:h.bottom,14:h.endBottom,15:h.center,16:h.lowerRight,17:h.lowerLeft,18:h.upperRight,19:h.upperLeft,20:h.middleT};for(let i=0;i<t;i++)for(let t=0;t<e;t++){let e=s.getTile(t,i);if(`${t},${i}`in f){let a=b(t,i),s=x[a]+1;e.updateTileInfo(s)}else{let a=_[w(t,i)]+1;e.updateTileInfo(a)}}for(let e of y.getRooms()){e.getLeft(),e.getRight(),e.getTop(),e.getBottom();let t=e.getLeft(),a=e.getRight(),f=e.getTop(),w=e.getBottom(),_={y:~~((f+w)/2),x:~~((a+t)/2)};e.getDoors((e,t)=>{let i,a=Object.values(o)+Object.values(n)+Object.values(l)+Object.values(n),r=s.getTile(e,t-1).obstacles[0].id,h=s.getTile(e,t+1).obstacles[0].id;i=a.includes(r-1)&&a.includes(h-1)?new B(e,t,d):new B(e,t,c),s.getTile(e,t).actors.push(i),s.actors.push(i);let p=b(e,t),u=x[p]+1;s.getTile(e,t).obstacles=[],s.getTile(e,t).updateTileInfo(u)});let T=A(1,y.getRooms().length);if(1==T||0==v){let e="down"===i?p:u,t=new ae(_.x,_.y,e,"down");s.getTile(_.x,_.y).actors.push(t),s.actors.push(t),v++}let S=[];Object.values(h);for(let e=f;e<w;e++)for(let i=t;i<a;i++)s.getTile(i,e).blocked()||S.push(i+","+e);T=E(1,5);for(let e=0;e<T;e++){let e=Re(S);if(null===e)break;let[t,i]=e,a=r.a.RNG.getWeightedValue(m),n=Oe[a],l=g(a,t,i,n[A(0,n.length-1)]);s.getTile(t,i).actors.push(l),s.actors.push(l)}if(T>=4){let e=Re(S);if(null!==e){let[t,i]=e,a=new ge(t,i,57);s.getTile(t,i).actors.push(a),s.actors.push(a)}}}let T=function(e){let t=Object.keys(e);return t[Math.floor(t.length*Math.random())]}(f).split(","),[S,C]=T.map(e=>parseInt(e));s.playerLocation=[S,C];let k=new ae(S,C,p,"up");return s.getTile(S,C).actors.push(k),s.actors.push(k),s},randomSimplexMap:function(e,t,i){let a=~~(e/i),s=~~(t/i),n=new Te(a,s);console.log(a,s);let l=$e.a.create(908234),o=$e.a.create(908234),h=new Ee.a(l.nextDouble.bind(l));new Ee.a(o.nextDouble.bind(o));const c={GOBLIN:1,RAT:3,WILD_GOAT:3},d=(e,t,i,a)=>{switch(e){case"ORC":return new de(t,i,a);case"EMPOWERED_ORC":return new de(t,i,a,!0);case"KOBOLD":return new ce(t,i,a);case"GOBLIN":return new he(t,i,a);case"BAT":return new ue(t,i,a);case"RAT":return new pe(t,i,a);case"WILD_GOAT":return new me(t,i,a);default:throw"Unidentified actor given to create actor"}},p=(e,t)=>h.noise2D(e,t)/2+.5,u=(i,a)=>{let s=i/e-.5,r=a/t-.5,n=1*p(1.5*s,1.5*r)+.5*p(3*s,3*r)+.25*p(6*s,6*r)+.13*p(12*s,12*r)+.06*p(24*s,24*r)+.03*p(48*s,48*r);return n/=1.97,100*(n=Math.pow(n,5))},m=e=>e<1.5?Ie.COASTAL_WATER:Ie.FOREST;let g=(e,t)=>{let i=u(e,t),a=m(i),s=0,r=`${e},${t+1}`,n=`${e-1},${t}`,l=`${e+1},${t}`,o=`${e-1},${t-1}`,h=e=>{let[t,i]=e.split(","),s=u(t,i),r=m(s).type;return r===a.type||"OCEAN_WATER"===r&&"COASTAL_WATER"===a.type};return h(`${e},${t-1}`)&&(s+=1),h(l)&&(s+=2),h(r)&&(s+=4),h(n)&&(s+=8),15!==s||h(o)||"COASTAL_WATER"!==a.type||(s=18),{texture:((e,t)=>{const{hasCorridors:i}=e;let a={0:e.single,1:e.endBottom,2:i?e.endLeft:e.upperLeft,3:e.lowerLeft,4:i?e.endTop:e.upperLeft,5:e.middleCorridorVertical,6:e.upperLeft,7:e.left,8:i?e.endRight:e.upperRight,9:e.lowerRight,10:e.middleCorridorHorizontal,11:e.bottom,12:e.upperRight,13:e.right,14:e.top,15:e.center,16:e.lowerRight,17:e.lowerLeft,18:e.altUpperRight,19:e.upperLeft,20:e.middleT,21:e.middleIntersection};return t in a?a[t]:(console.warn(`Couldn't find a texture for sum: ${t} with tile options: ${tileOptions}`),0)})(a.textures,s),type:a.type,elevation:i}};const v={[De]:25,[Ne]:25,[Be]:25,[Pe]:25,[qe]:1,[He]:1,[ze]:1,[Fe]:1,[Ve]:1,[je]:1,[Ye]:1};for(let e=0;e<s;e++)for(let t=0;t<a;t++){let i=g(t,e),a=n.getTile(t,e);if(i.type===Ie.OCEAN_WATER.type||i.type===Ie.COASTAL_WATER.type)a.updateTileInfo(7146),a.updateTileInfo(i.texture);else if(i.type===Ie.FOREST.type){if(a.updateTileInfo(i.texture),L(5,i.elevation,6)||L(10,i.elevation,100))a.updateTileInfo(We);else if(A(0,4)>0){let e=r.a.RNG.getWeightedValue(v);a.updateTileInfo(e)}if(!a.blocked()&&1===A(0,500)){let i=r.a.RNG.getWeightedValue(c),s=Me[i],l=d(i,t,e,s[A(0,s.length-1)]);a.actors.push(l),n.actors.push(l)}}}return n.playerLocation=[~~(a/2),~~(s/2)],n}};n.utils.skipHello();const{randomSimplexMap:Ue,randomDungeon:Ke,randomCave:Je}=Ge,Xe=7419;let Ze={app:null,overview:null,dev:!1,display:null,HUD:null,console:null,player:null,playerLocation:null,playerID:4696,loadedIDS:[],scheduler:null,turn:0,engine:null,loaded:!1,levels:{},currentLevel:{name:"overworld"},map:null,messageHistory:[],tempMessages:[],minimap:null,selectedTile:null,pathToTarget:{},targetReticle:null,enemyCycle:null,enemyCycleIndex:0,userSettings:{hpBars:!0},init(e){this.playerID=e,this.player=new re(0,0,e),this.currentLevel.name="overworld",this.displayOptions={width:32,height:20,forceSquareRatio:!0,layout:"tile",tileWidth:32,tileHeight:32};this.display=new class{constructor(){let e=window.innerWidth<=1400?800:1024,t=window.innerHeight<=800?500:640;this.app=new n.Application({width:e,height:t}),this.staticBackground=null,this.animatedBackground=null,this.FOVBackground=null,this.HUDBackground=null,this.movingSprites=[],this.viewPort=null,this.tileSize=32,this.tileset=null,this.tilesetMapping={},this.spriteBox=[]}loadAssets(e){let{renderer:t,stage:i,view:a}=this.app,{resources:s}=n.loader;n.loader.add({url:"static/compiled_dawnlike.json",name:"textureAtlas"}).add({url:"static/images/compiled_tileset_32x32.png",name:"spritesheet"}).add({url:"static/maps/overworld.json",name:"overworld"}).add({url:"static/maps/graveyard.json",name:"graveyard"}).add({url:"static/maps/lichLair.json",name:"lichLair"}).add({url:"static/maps/orcCastle.json",name:"orcCastle"}).on("progress",(e,t)=>this.handleAssetLoad(e,t)).load(()=>{this.tileset=n.loader.resources.textureAtlas.data;for(let e=0;e<this.tileset.tilecount;e++){let t=this.getTilesetCoords(e),i=new n.Rectangle(t[0],t[1],this.tileSize,this.tileSize),a=new n.Texture(n.loader.resources.spritesheet.texture,i);this.tilesetMapping[e]=a}this.clear();let t=e=>{for(let e of this.movingSprites)e.sprite.x===e.target.x&&e.sprite.y===e.target.y&&(this.movingSprites=this.movingSprites.filter(t=>t.sprite!==e.sprite));for(let e of this.movingSprites){let{sprite:t,target:i}=e,a=0,s=0,r=Math.abs(t.x-i.x),n=Math.abs(t.y-i.y),l=r<=12&&0!==r||n<=12&&0!==n?2:4;i.x>t.x&&(a=l),i.x<t.x&&(a=-l),i.y>t.y&&(s=l),i.y<t.y&&(s=-l),Math.abs(a)>r&&(a=r),Math.abs(s)>n&&(s=n),t.position.set(t.x+a,t.y+s)}};this.app.ticker.add(e=>t()),e()})}getTilesetCoords(e){this.tileset.tilewidth;let t=this.tileset.tileheight,i=this.tileset.columns;return[e%i*t,Math.floor(e/i)*t]}renderMap(e){let{renderer:t,stage:i}=this.app;i.removeChildren();let a=new n.Container;this.animatedBackground=new n.Container;for(let t=0;t<e.height;t++)for(let i=0;i<e.width;i++){let s=e.getTile(i,t);for(let e of s.obstacles)if(!0===e.animated&&void 0!==e.animated_id&&void 0!==this.getTexture(e.animated_id)){let a=[this.getTexture(e.id),this.getTexture(e.animated_id)],s=new n.extras.AnimatedSprite(a);s.position.set(i*this.tileSize,t*this.tileSize),s.animationSpeed=.025;let r=~~(150*Math.random());setTimeout(()=>s.play(),r),this.animatedBackground.addChild(s)}else{let s=new n.Sprite(this.getTexture(e.id));s.position.set(i*this.tileSize,t*this.tileSize),a.addChild(s)}}this.staticBackground=new n.Sprite(t.generateTexture(a)),this.staticBackground.position.set(0,0),this.animatedBackground.position.set(0,0),this.background=new n.Container,this.background.addChild(this.staticBackground),this.background.addChild(this.animatedBackground),i.addChild(this.background);let s={x:Ze.player.x-~~(Ze.width/2),y:Ze.player.y-~~(Ze.height/2),width:Math.ceil(Ze.width),height:Ze.height},r=[s.x,s.y];s.x<0&&(r[0]=0),s.x+s.width>Ze.map.width&&(r[0]=Ze.map.width-s.width),s.y<=0&&(r[1]=0),s.y+s.height>Ze.map.height&&(r[1]=Ze.map.height-s.height),r[0],r[1],this.background.position.set(-r[0]*this.tileSize,-r[1]*this.tileSize);for(let t of e.actors)t instanceof h||this.assignSprite(t);if(!e.revealed){this.FOVBackground=new n.Container,this.spriteBox=[];for(let e=0;e<Ze.map.height;e++){this.spriteBox.push([]);for(let t=0;t<Ze.map.width;t++){let i=new n.Sprite(this.getTexture(7026));i.position.set(t*this.tileSize,e*this.tileSize),this.spriteBox[e].push(i),this.FOVBackground.addChild(i)}}for(let t=0;t<e.height;t++)for(let i=0;i<e.width;i++)e.visible_tiles[i+","+t]?this.spriteBox[t][i].visible=!1:i+","+t in e.seen_tiles?this.spriteBox[t][i].alpha=.5:this.spriteBox[t][i].alpha=1;this.background.addChild(this.FOVBackground)}Ze.drawMiniMap()}updateMap(){let e={x:Ze.player.x-~~(Ze.width/2),y:Ze.player.y-~~(Ze.height/2),width:Math.ceil(Ze.width),height:Ze.height},t=[e.x,e.y];if(e.x<0&&(t[0]=0),e.x+e.width>Ze.map.width&&(t[0]=Ze.map.width-e.width),e.y<=0&&(t[1]=0),e.y+e.height>Ze.map.height&&(t[1]=Ze.map.height-e.height),t[0],t[1],!Ze.map.revealed){Object.assign(Ze.map.seen_tiles,Ze.map.visible_tiles),Ze.map.visible_tiles={},new r.a.FOV.PreciseShadowcasting((e,t)=>Ze.inbounds(e,t)&&Ze.getTile(e,t).visible()).compute(Ze.player.x,Ze.player.y,Ze.player.cb.range,(e,t,i,a)=>{Ze.map.visible_tiles[e+","+t]=!0});for(let e=0;e<Ze.map.height;e++)for(let t=0;t<Ze.map.width;t++)if(Ze.map.visible_tiles[t+","+e])this.spriteBox[e][t].visible=!1;else if(this.spriteBox[e][t].visible=!0,Ze.map.seen_tiles[t+","+e]){let i=((...e)=>e.some(e=>Ze.map.visible_tiles[e]))(`${t-1},${e}`,`${t+1},${e}`,`${t},${e-1}`,`${t},${e+1}`,`${t-1},${e-1}`,`${t+1},${e+1}`,`${t-1},${e+1}`,`${t+1},${e-1}`);this.spriteBox[e][t].alpha=i?.5:.7}else this.spriteBox[e][t].alpha=1}if(Ze.userSettings.hpBars){for(let t=e.x;t<e.x+e.width-1;t++)for(let i=e.y;i<e.y+e.height-1;i++)if(Ze.inbounds(t,i)&&(Ze.map.revealed||Ze.map.visible_tiles[t+","+i])){let e=Ze.getTile(t,i).actors.filter(e=>e instanceof H&&!(e instanceof re)&&!(e instanceof oe));if(e.length>=1)for(let t of e)if(void 0!==t.spriteHPBar&&this.background.removeChild(t.spriteHPBar),t.cb.hp<t.cb.maxhp){let e=new n.Graphics,i=t.x*this.tileSize,a=(t.y-.5)*this.tileSize;e.beginFill(10627626),e.drawRect(i+1,a,this.tileSize-2,7),e.beginFill(16732754);let s=t.cb.hp/t.cb.maxhp*(this.tileSize-4);e.drawRect(i+2,a+1,s,5),e.endFill();let r=new n.Sprite(this.app.renderer.generateTexture(e));r.position.set(i,a),t.setSpriteHPBar(r),this.background.addChild(r)}}}else for(let e of Ze.map.actors)void 0!==e.spriteHPBar&&(this.background.removeChild(e.spriteHPBar),e.spriteHPBar=void 0);this.moveSprite(this.background,-t[0],-t[1]),Ze.drawMiniMap()}getTexture(e){return this.tilesetMapping[e]}moveSprite(e,t,i,a=!0){let s=t*this.tileSize,r=i*this.tileSize;a?(this.movingSprites.filter(t=>t.sprite===e).length>0&&(this.movingSprites=this.movingSprites.filter(t=>t.sprite!==e)),this.movingSprites.push({sprite:e,target:{x:s,y:r}})):e.position.set(s,r)}assignSprite(e,t=!1,i=1){let{x:a,y:s,id:r}=e,l=this.tileset.tileproperties[e.id+""];if(!0===l.animated&&void 0!==l.animated_id&&void 0!==this.getTexture(l.animated_id)){let a=[this.getTexture(e.id),this.getTexture(l.animated_id)],s=new n.extras.AnimatedSprite(a);e.setSprite(s),s.animationSpeed=.065;let r=~~(1e3*Math.random());setTimeout(()=>s.play(),r),t?this.background.addChildAt(s,i):this.background.addChild(s),s.position.set(e.x*this.tileSize,e.y*this.tileSize)}else{let i=new n.Sprite(this.getTexture(e.id));e.setSprite(i),t?this.background.addChildAt(i,1):this.background.addChild(i),i.position.set(e.x*this.tileSize,e.y*this.tileSize)}}clearSprite(e){this.background.removeChild(e.sprite),e.sprite=null}removeChild(e){this.background.removeChild(e)}getContainer(){return this.app.view}handleAssetLoad(e,t){let{stage:i,renderer:a}=this.app;this.clear();let s=new n.Graphics,r=a.width/2,l=a.height/2,o=a.width/2,h=new n.Text(`Loading ${t.name}... ${Math.floor(e.progress)}%`,{fill:16777215,fontSize:16,fontFamily:["Source Code Pro","Menlo","Consolas"],x:r,y:l});s.lineStyle(50,7303023),s.drawRoundedRect(r-o/2,l,o,4);let c=o-10,d=c*(e.progress/100);s.lineStyle(30,305972),s.drawRoundedRect(r-c/2,l,d,4),i.addChild(s),i.addChild(h)}clear(){this.app.stage.removeChildren()}act(){Ze.engine.lock(),this.updateMap(),Ze.engine.unlock()}},this.display.loadAssets(()=>{this.levels.graveyard=_e(n.loader.resources.graveyard.data),this.levels["Lich Lair"]=_e(n.loader.resources.lichLair.data),this.levels.overworld=_e(n.loader.resources.overworld.data),this.levels["Orc Castle"]=_e(n.loader.resources.orcCastle.data),this.levels.graveyard.revealed=!0,this.levels["Lich Lair"].revealed=!0,this.levels.overworld.revealed=!0,this.levels["Orc Castle"].revealed=!0,this.map=this.levels[this.currentLevel.name],this.width=this.map.width<this.displayOptions.width?this.map.width:this.displayOptions.width,this.height=this.map.height<this.displayOptions.height?this.map.height:this.displayOptions.height,this.map.actors.push(this.player);let[e,t]=this.map.playerLocation;this.player.placeAt(e,t),this.scheduleAllActors(),this.initializeMinimap(),document.getElementById("game_container").appendChild(this.display.getContainer()),document.getElementById("minimap_container").appendChild(this.minimap.getContainer()),this.engine.start(),this.renderMap()})},renderMap(){this.display.renderMap(this.map),this.targetReticle=new n.Sprite(this.display.tilesetMapping[7418]),this.targetReticle.visible=!1,this.display.background.addChild(this.targetReticle)},scheduleAllActors(){this.scheduler=new r.a.Scheduler.Simple,this.scheduler.add(this.player,!0),this.scheduler.add(this.display,!0);for(let e=0;e<this.map.actors.length;e++)this.map.actors[e]!==this.player&&this.map.actors[e]instanceof H&&this.scheduler.add(this.map.actors[e],!0);this.engine=new r.a.Engine(this.scheduler)},initializeMinimap(){this.minimap=new r.a.Display,this.minimap.setOptions({width:this.map.width,height:this.map.height,fontSize:2,spacing:2,forceSquareRatio:!0}),this.drawMiniMap()},clearTempLog(){this.tempMessages.splice(0,this.tempMessages.length)},inbounds(e,t){return!(e<0||e>=this.map.width||t<0||t>=this.map.height)},inViewport(e,t){let i=Ze.player.x-~~(Ze.width/2),a=Ze.player.y-~~(Ze.height/2);return i<=e&&e<=i+Ze.width&&a<=t&&t<=a+Ze.height},changeLevels(e,t,i){if(void 0===this.levels[e]){this.player.cb.dungeonsExplored++,e.toLowerCase().includes("cave")?this.levels[e]=Je(80,40,t,i):this.levels[e]=Ke(40,40,t,i),this.levels[e].revealed=!1;for(let t of this.levels[e].actors)if(t instanceof ge){D({minItems:1,maxItems:4,dropTable:{STRENGTH_POTION:1,HEALTH_POTION:1,STEEL_ARROW:1,MANA_POTION:1,SWORD:3},x:t.x,y:t.y}).forEach(e=>t.addToInventory(e))}}this.map.playerLocation=[Ze.player.x,Ze.player.y],this.levels[this.currentLevel.name]=this.map,this.getTile(this.player.x,this.player.y).removeActor(this.player),this.map.actors=this.map.actors.filter(e=>e!==this.player),this.map=this.levels[e],this.currentLevel.name=e,this.playerLocation=this.map.playerLocation,this.display.clear(),this.width=this.map.width<this.displayOptions.width?this.map.width:this.displayOptions.width,this.height=this.map.height<this.displayOptions.height?this.map.height:this.displayOptions.height,this.player.placeAt(this.playerLocation[0],this.playerLocation[1]),this.map.actors.push(this.player),this.scheduleAllActors(),Object.assign(this.map.seen_tiles,this.map.visible_tiles),this.map.visible_tiles={},new r.a.FOV.PreciseShadowcasting((e,t)=>this.inbounds(e,t)&&this.getTile(e,t).visible()).compute(this.player.x,this.player.y,this.player.cb.range,(e,t,i,a)=>{this.map.visible_tiles[e+","+t]=!0}),this.minimap.setOptions({width:this.map.width,height:this.map.height,fontSize:2,spacing:2,forceSquareRatio:!0}),this.minimap.clear(),this.drawMiniMap(),this.renderMap()},drawMiniMap(){let e=this.map.actors.filter(e=>e instanceof ae||e instanceof B);if(this.map.revealed){for(let e=0;e<this.map.height;e++)for(let t=0;t<this.map.width;t++){let i=this.getTile(t,e);i.x+","+i.y in this.map.visible_tiles?this.minimap.draw(t,e," ",i.bg(),this.brightenColor(i.bg())):this.minimap.draw(t,e," ",i.bg(),i.bg())}for(let t of e)this.minimap.draw(t.x,t.y," ",t.fg,t.bg)}else{for(let e=0;e<this.map.height;e++)for(let t=0;t<this.map.width;t++){let i=this.getTile(t,e);i.x+","+i.y in this.map.visible_tiles?this.minimap.draw(t,e," ",i.bg(),this.brightenColor(i.bg())):i.x+","+i.y in this.map.seen_tiles&&this.minimap.draw(t,e," ",i.bg(),i.bg())}for(let t of e)t.x+","+t.y in this.map.seen_tiles&&this.minimap.draw(t.x,t.y," ",t.fg,t.bg)}this.minimap.draw(this.player.x,this.player.y," ","yellow","yellow")},brightenColor(e){let t=r.a.Color.rgb2hsl(r.a.Color.fromString(e));return t[2]*=1.25,r.a.Color.toRGB(r.a.Color.hsl2rgb(t))},getNearbyEnemies(){let e={x:this.player.x-~~(Ze.width/2),y:this.player.y-~~(Ze.height/2),width:Math.ceil(Ze.width),height:Ze.height},t=[e.x,e.y];e.x<0&&(t[0]=0),e.x+e.width>Ze.map.width&&(t[0]=Ze.map.width-e.width),e.y<=0&&(t[1]=0),e.y+e.height>Ze.map.height&&(t[1]=Ze.map.height-e.height),this.camera={x:t[0],y:t[1]};let i=[t[0]+e.width,t[1]+e.height],a=0,s=[];for(let e=t[0];e<i[0];e++){for(let a=t[1];a<i[1];a++){let t=this.getTile(e,a);s=s.concat(t.actors)}0,a=0}return s.filter(e=>void 0!==e.cb&&e.cb.hostile).sort((e,t)=>e.distanceTo(this.player)<t.distanceTo(this.player)?-1:t.distanceTo(this.player)<e.distanceTo(this.player)?1:0)},getClosestEnemyToPlayer(){return this.getNearbyEnemies()[0]},clearSelectedTile(){this.selectedTile=null,this.pathToTarget={},this.clearTempLog(),this.targetReticle.visible=!1},changeSelectedTile(e){this.selectedTile=e;let{x:t,y:i}=e,a=this.selectedTile.blocked()||void 0===this.map.visible_tiles[t+","+i];if(this.pathToTarget={},!a){let e=this.player.x,t=this.selectedTile.x,i=this.player.y,a=this.selectedTile.y,s=Math.abs(t-e),r=e<t?1:-1,n=Math.abs(a-i),l=i<a?1:-1,o=(s>n?s:-n)/2;for(;e!==t||i!==a;){this.pathToTarget[e+","+i]=!0;let t=o;t>-s&&(o-=n,e+=r),t<n&&(o+=s,i+=l)}this.pathToTarget[e+","+i]=!0,this.pathToTarget[this.player.x+","+this.player.y]=!1}return this.targetReticle.visible=!0,this.targetReticle.position.set(e.x*this.display.tileSize,e.y*this.display.tileSize),this.describeSelectedTile(),!a},selectNearestEnemyTile(){this.clearSelectedTile();let e=this.getClosestEnemyToPlayer();if(void 0!==e){let{x:t,y:i}=e;return this.changeSelectedTile(this.getTile(t,i))}return!1},cycleThroughSelectableEnemies(){if(null===this.enemyCycle&&(this.enemyCycle=this.getNearbyEnemies(),this.enemyCycleIndex=0),this.enemyCycle.length>1){this.clearSelectedTile(),this.enemyCycleIndex+=1,this.enemyCycleIndex===this.enemyCycle.length&&(this.enemyCycleIndex=0);let e=this.enemyCycle[this.enemyCycleIndex];return this.changeSelectedTile(this.getTile(e.x,e.y))}},describeSelectedTile(){let{actors:e,obstacles:t}=this.selectedTile,i=e.filter(e=>e instanceof o&&e!==this.player).map(e=>e instanceof h?e.type.toLowerCase():e.name.toLowerCase()),a=t.map(e=>e.description).filter(e=>void 0!==e);a.length>0&&i.push(a.slice(-1)[0]);let s=[];if(s=i.slice(1,-1).reduce((e,t)=>e+", "+$(t),$(i.slice(0,1)[0])),i.length>1?s+=[` and ${$(i.slice(-1)[0])}`]:0==i.length&&(s="nothing"),(Ze.player.targeting||Ze.player.casting)&&null!==this.selectedTile){let e=Ze.map.data[this.selectedTile.y][this.selectedTile.x].actors.some(e=>e.id===Xe)?" This tile is out of range or blocked.":"";this.log(`[You see ${s} here.${e}]`,"player_move",!0)}else this.log(`[You see ${s} here.]`,"player_move",!0)},getTile(e,t){return this.map.data[t][e]},printPlayerTile(){console.log(Ze.map.data[this.player.y][this.player.x])},eventToTile(){let{x:e,y:t}=this.display.app.renderer.plugins.interaction.mouse.global,i=Ze.player.x-~~(Ze.width/2),a=Ze.player.y-~~(Ze.height/2)-1,s=i+~~(e/this.display.tileSize),r=a+~~(t/this.display.tileSize);return this.inbounds(s,r)?this.getTile(s,r):null},log(e,t,i=!1){let a={defend:"lightblue",magic:"#3C1CFD",attack:"red",death:"crimson",information:"yellow",player_move:"#878787",level_up:"green",alert:"orange"},s=t in a?a[t]:t;i?this.tempMessages.splice(0,1,[e,s]):this.messageHistory.push([e,s])}};var Qe={name:"start-menu",data:()=>({selectedSprite:null,playerSprites:[{name:"Monk",description:"A master of martial arts with special healing abilities",abilities:[{name:"Magic Dart",description:"A magical dart of energy that deals between 1-8 damage to a target",school:"conjuration",art:"magic_dart"}],stats:{hp:50,strength:1,dexterity:1,wisdom:1},sprites:[4812,4453,3859,4219]},{name:"Ninja",description:"A sneaky, hidden ninja of a secret order with the ability to stealth",abilities:[{name:"Magic Dart",description:"A magical dart of energy that deals between 1-8 damage to a target",school:"conjuration",art:"magic_dart"}],stats:{hp:50,strength:1,dexterity:1,wisdom:1},sprites:[4334,4814]},{name:"Knight",description:"A proud knight, sworn to uphold chivalric values",abilities:[{name:"Magic Dart",description:"A magical dart of energy that deals between 1-8 damage to a target",school:"conjuration",art:"magic_dart"}],stats:{hp:50,strength:1,dexterity:1,wisdom:1},sprites:[4213,4693]},{name:"Barbarian",description:"A wild and vicious savage with extreme strength and rage",abilities:[{name:"Magic Dart",description:"A magical dart of energy that deals between 1-8 damage to a target",school:"conjuration",art:"magic_dart"}],stats:{hp:50,strength:1,dexterity:1,wisdom:1},sprites:[4337,4336]},{name:"Wizard",description:"A scholar of the arcane and all things magical",abilities:[{name:"Magic Dart",description:"A magical dart of energy that deals between 1-8 damage to a target",school:"conjuration",art:"magic_dart"}],stats:{hp:50,strength:1,dexterity:1,wisdom:1},sprites:[3858,4218,4813]}]}),created(){},methods:{getPlayerSpriteImage:e=>`../static/images/player_sprites/${e}.png`,selectSprite(e){this.$emit("spriteSelected",e)},getSpellSplashArt:(e,t)=>`../static/images/spells/${e}/${t}.png`}},et={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-app",{attrs:{dark:""}},[i("v-container",{attrs:{"grid-list-xl":""}},[i("v-layout",{attrs:{row:""}},[i("v-flex",{attrs:{xs12:""}},[i("h2",[e._v("Welcome to Rotten Soup")])])],1),e._v(" "),i("v-layout",{attrs:{row:""}},[i("v-flex",[i("h3",[e._v("Select your hero by clicking on the character you want to play")])])],1),e._v(" "),i("v-layout",{attrs:{row:"",wrap:""}},e._l(e.playerSprites,function(t,a){return i("v-flex",{key:a,staticStyle:{padding:"10px"},attrs:{xs4:""}},[i("v-card",{staticStyle:{padding:"25px"}},[i("v-layout",{attrs:{row:""}},[i("div",[i("h5",[e._v(e._s(t.name))]),e._v(" "),i("p",[e._v(e._s(t.description))])])]),e._v(" "),i("v-layout",{attrs:{row:""}},[e._v("\r\n                        Characters\r\n                    ")]),e._v(" "),i("v-layout",{attrs:{row:""}},e._l(t.sprites,function(t){return i("v-flex",{key:t,staticStyle:{"margin-right":"5px"},attrs:{col:"",xs1:""}},[i("v-layout",{attrs:{row:"","align-center":""}},[i("v-flex",[i("img",{class:{spriteIsSelected:e.selectedSprite===t,sprite:e.selectedSprite!==t},attrs:{src:e.getPlayerSpriteImage(t)},on:{click:function(i){e.selectSprite(t)}}})])],1)],1)}))],1)],1)}))],1)],1)},staticRenderFns:[]};var tt=i("VU/8")(Qe,et,!1,function(e){i("ESgl")},null,null).exports,it={data:()=>({messages:Ze.messageHistory,tempMessages:Ze.tempMessages,offset:0}),methods:{getTempMessages(){return this.tempMessages},getMessages(){return this.messages.slice(-10-this.offset+this.getTempMessages().length)},resetOffset(){this.offset=0},down(){this.offset>0&&this.offset--},up(){this.offset<this.messages.length-10&&this.offset++}}},at={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-layout",{attrs:{id:"console_container"}},[i("v-flex",{attrs:{column:"","align-start":""}},[i("v-list",{staticClass:"pt-3",attrs:{id:"console"}},[e._l(e.getMessages(),function(t,a){return i("li",{key:a,staticClass:"ml-2"},[i("p",[i("b",{style:{color:t[1]}},[e._v(e._s(t[0]))])])])}),e._v(" "),e._l(e.getTempMessages(),function(t,a){return i("li",{staticClass:"ml-2"},[i("p",[i("b",{style:{color:t[1]}},[e._v(e._s(t[0]))])])])})],2)],1),e._v(" "),i("v-flex",{staticClass:"text-xs-center",staticStyle:{"max-width":"27px"},attrs:{id:"scroll_controls",column:""}},[i("v-layout",[i("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[i("v-icon",{staticClass:"scroll_controls",attrs:{small:""},on:{click:function(t){e.up()}}},[e._v("fa-angle-up")])],1)],1),e._v(" "),i("v-layout",{staticStyle:{height:"70px"}}),e._v(" "),i("v-layout",[i("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[i("v-icon",{staticClass:"scroll_controls",attrs:{small:""},on:{click:function(t){e.down()}}},[e._v("fa-angle-down")])],1)],1),e._v(" "),i("v-layout",[i("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[i("v-icon",{staticClass:"scroll_controls",attrs:{small:""},on:{click:function(t){e.resetOffset()}}},[e._v("fa-angle-double-down")])],1)],1)],1)],1)},staticRenderFns:[]};var st=i("VU/8")(it,at,!1,function(e){i("oNwW")},null,null).exports,rt={components:{"message-log":st},data:()=>({})},nt={render:function(){var e=this.$createElement,t=this._self._c||e;return t("v-flex",{staticStyle:{"max-width":"1120px"},attrs:{column:""}},[t("v-layout",{staticStyle:{padding:"0px"},attrs:{row:""}},[t("div",{staticStyle:{margin:"0",padding:"0"},attrs:{id:"game_container"}})]),this._v(" "),t("message-log")],1)},staticRenderFns:[]};var lt=i("VU/8")(rt,nt,!1,function(e){i("jZkN")},null,null).exports,ot=i("DAYN"),ht={components:{draggable:i.n(ot).a},data:()=>({inventory:[],length:Ze.player.inventory,rows:[1,2,3,4],x:0,y:0}),created(){},methods:{getInventorySprite:e=>`../static/images/inventory_sprites/${e}.png`,colorSlot:e=>null!==e.item&&"cb"in e.item&&e.item.cb.equipped,getInventoryRow(e){let t=e*(Ze.player.inventory.length/this.rows.length);return Ze.player.inventory.slice(t,t+Ze.player.inventory.length/this.rows.length)},useItem(e,t){t.shiftKey?e.item.drop():e.item.use()},dropItem(e,t){e.item.drop()},getInventory:()=>Ze.player.inventory,show(e,t){t.preventDefault(),Ze.player.inventory.forEach(e=>{e.menu=!1}),this.x=t.clientX,this.y=t.clientY,this.$nextTick(()=>{e.menu=!0})}}},ct={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{staticClass:"pa-0",attrs:{fluid:""}},[i("v-layout",{attrs:{row:""}},[i("v-flex",{attrs:{xs4:""}},[i("b",[e._v("Items")])])],1),e._v(" "),i("draggable",{staticClass:"layout inventory_row row",attrs:{element:"v-layout",row:"",wrap:""},model:{value:e.inventory,callback:function(t){e.inventory=t},expression:"inventory"}},e._l(e.getInventory(),function(t,a){return i("v-flex",{key:a,class:{selectedItem:e.colorSlot(t),inventory_cell:!e.colorSlot(t)},attrs:{xs1:"",col:"","align-center":""}},[null!==t.item?i("v-tooltip",{attrs:{"open-delay":"200",bottom:"","align-center":""}},[i("p",{staticClass:"text-xs-center ma-0"},[e._v("\r\n                    "+e._s(t.item.getAction())+" "+e._s(t.item.type)+"\r\n                    "),i("br"),e._v(" "),"name"in t.item?i("span",[e._v(e._s("Name: "+t.item.name)),i("br")]):e._e(),e._v(" "+e._s(t.item.hoverInfo())+"\r\n                ")]),e._v(" "),null!==t.item?i("v-layout",{attrs:{slot:"activator",ripple:"",row:""},on:{click:function(i){e.useItem(t,i)},contextmenu:function(i){e.show(t,i)}},slot:"activator"},[i("v-menu",{attrs:{"offset-x":"","nudge-width":200,"close-on-click":!0,absolute:"","position-x":e.x,"position-y":e.y},model:{value:t.menu,callback:function(i){e.$set(t,"menu",i)},expression:"cell.menu"}},[i("v-card",[i("v-list",[i("v-list-tile",{attrs:{avatar:""}},[i("v-list-tile-avatar",[i("img",{attrs:{src:e.getInventorySprite(t.item.id)}})]),e._v(" "),i("v-list-tile-content",[i("v-list-tile-title",[e._v(e._s(t.item.type))]),e._v(" "),i("v-list-tile-sub-title",[e._v(e._s(t.item.hoverInfo()))])],1)],1)],1),e._v(" "),i("v-divider"),e._v(" "),i("v-card-actions",[i("v-btn",{attrs:{flat:"",color:"blue"},on:{click:function(i){e.useItem(t,i)}}},[e._v(e._s(t.item.getAction()))]),e._v(" "),i("v-btn",{attrs:{flat:"",color:"red"},on:{click:function(i){e.dropItem(t,i)}}},[e._v("Drop")])],1)],1)],1),e._v(" "),i("v-badge",{attrs:{overlay:"",bottom:"",color:"grey",overlap:""}},[void 0!==t.item.quantity?i("span",{attrs:{slot:"badge",dark:""},slot:"badge"},[i("b",[e._v(e._s(t.item.quantity))])]):e._e(),e._v(" "),i("img",{attrs:{src:e.getInventorySprite(t.item.id)}})])],1):e._e()],1):e._e()],1)}))],1)},staticRenderFns:[]};var dt=i("VU/8")(ht,ct,!1,function(e){i("TiSk")},"data-v-46096a4a",null).exports,pt={components:{inventory:dt},data:()=>({inventoryModalOpened:!1}),methods:{}},ut={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.inventoryModalOpened?i("v-container",{staticClass:"modal elevation-24"},[i("v-layout",{attrs:{row:""}},[i("v-flex",{attrs:{xs5:"",col:""}},[i("h3",[e._v("Bob the NPC")]),e._v(" "),i("inventory")],1),e._v(" "),i("v-flex",{attrs:{xs2:"",col:""}}),e._v(" "),i("v-flex",{attrs:{xs5:"",col:""}},[i("h3",[e._v("Your Items")]),e._v(" "),i("inventory")],1)],1)],1):e._e()},staticRenderFns:[]};var mt=i("VU/8")(pt,ut,!1,function(e){i("z9mr")},null,null).exports,gt={data:()=>({enemies:Ze.player.nearbyEnemies}),methods:{getNearbyEnemies:()=>Ze.player.nearbyEnemies},created(){}},vt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{staticStyle:{"min-height":"50px"},attrs:{fluid:""}},[e.getNearbyEnemies().length>0?i("v-layout",{attrs:{row:"",wrap:""}},e._l(e.getNearbyEnemies(),function(t,a){return i("v-flex",{key:a,attrs:{md4:"",col:""}},[i("v-tooltip",{attrs:{bottom:""}},[i("span",{attrs:{"align-center":""}},[e._v("\n                    HP : "+e._s(t.cb.hp)+" / "+e._s(t.cb.maxhp)),i("br"),e._v('\n                    "'+e._s(t.description)+'"'),i("br")]),e._v(" "),i("div",{staticClass:"enemy_col",attrs:{slot:"activator",fluid:""},slot:"activator"},[i("v-layout",{staticClass:"text-xs-center",staticStyle:{"font-size":"10px",margin:"0px auto -10px 0px"},attrs:{"align-center":"",row:""}},[i("v-flex",{attrs:{xs12:""}},[e._v(e._s(t.name.capitalize()))])],1),e._v(" "),i("v-layout",{staticStyle:{margin:"0px"},attrs:{row:""}},[i("v-flex",{attrs:{xs12:""}},[i("v-progress-linear",{attrs:{value:t.cb.hp/t.cb.maxhp*100,height:"4",color:"error"}})],1)],1)],1)])],1)})):i("v-layout",{attrs:{row:""}},[i("v-container",{attrs:{fluid:""}},[e._v("\n            No enemies in view\n        ")])],1)],1)},staticRenderFns:[]};var ft=i("VU/8")(gt,vt,!1,function(e){i("lPMU")},null,null).exports,yt={data:()=>({}),methods:{}},bt={render:function(){var e=this.$createElement,t=this._self._c||e;return t("v-layout",{staticClass:"text-xs-center",attrs:{row:""}},[t("v-flex",{attrs:{xs10:"",fluid:"",id:"minimap_container"}})],1)},staticRenderFns:[]};var wt=i("VU/8")(yt,bt,!1,function(e){i("2Nfd")},null,null).exports,xt={data:()=>({}),methods:{getHP:()=>Ze.player.cb.hp,getMaxHP:()=>Ze.player.cb.maxhp,getMana:()=>Ze.player.cb.mana,getMaxMana:()=>Ze.player.cb.maxmana,getStrength:()=>Ze.player.cb.str,getDefence:()=>Ze.player.cb.def,getDamageRange:()=>Ze.player.getMinDmg()===Ze.player.getMaxDmg()?Ze.player.getMinDmg():Ze.player.getMinDmg()+" - "+Ze.player.getMaxDmg(),getLevel:()=>Ze.player.cb.level,getRemainingXP:()=>Ze.player.remainingXP(),getPercentToLevel(){let e=l[this.getLevel()]-l[this.getLevel()-1];return(Ze.player.cb.xp-l[this.getLevel()-1])/e},getCurrentWeapon:()=>Ze.player.cb.equipment.weapon,getCurrentWeaponEnchantments(){if(null!==this.getCurrentWeapon()){let e=this.getCurrentWeapon().cb.enchantments;return 0===e.length?null:1===e.length?e[0].name:e.reduce((e,t)=>e+", "+t.name,"")}return null}}},_t={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{staticClass:"pa-0",attrs:{fluid:""}},[i("v-flex",{staticClass:"stat-row"},[i("v-layout",{attrs:{row:"","align-center":""}},[i("v-flex",{staticStyle:{"min-width":"70px"},attrs:{md1:"",col:""}},[i("b",[e._v("Level")])]),e._v(" "),i("v-flex",{staticStyle:{"padding-left":"7px"},attrs:{md2:"",col:""}},[e._v(e._s(e.getLevel()))]),e._v(" "),i("v-flex",{attrs:{md5:"",col:""}},[e._v(e._s(Math.floor(e.getRemainingXP()))+"XP until level "+e._s(e.getLevel()+1))])],1)],1),e._v(" "),i("v-flex",{staticClass:"stat-row"},[i("v-layout",{attrs:{row:"","align-center":""}},[i("v-flex",{staticStyle:{"min-width":"70px"},attrs:{md1:"",col:""}},[i("b",[e._v("Strength")])]),e._v(" "),i("v-flex",{staticStyle:{"padding-left":"7px"},attrs:{md3:"",col:""}},[e._v(e._s(e.getStrength()))])],1)],1),e._v(" "),i("v-flex",{staticClass:"stat-row"},[i("v-layout",{attrs:{row:"","align-center":""}},[i("v-flex",{staticStyle:{"min-width":"70px"},attrs:{md1:"",col:""}},[i("b",[e._v("Damage")])]),e._v(" "),i("v-flex",{staticStyle:{"padding-left":"7px"},attrs:{md2:"",col:""}},[e._v(e._s(e.getDamageRange()))]),e._v(" "),null!==e.getCurrentWeapon()&&null!==e.getCurrentWeaponEnchantments()?i("v-flex",{attrs:{md6:"",col:""}},[i("b",[e._v("Weapon Enchantments:")]),e._v(" "+e._s(e.getCurrentWeaponEnchantments())+"\n        ")]):e._e()],1)],1)],1)},staticRenderFns:[]},Tt=i("VU/8")(xt,_t,!1,null,null,null).exports,St={data:()=>({spells:Ze.player.cb.spells}),methods:{highlightSpell:e=>Ze.player.cb.currentSpell===e,getSpellSplashArt:(e,t)=>`../static/images/spells/${e}/${t}.png`,getSpells(){return this.spells},fillerSpellSlots(){return this.spells.length<11?11-this.spells.length:0},selectSpell(e){Ze.player.selectSpell(e)}}},Ct={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{staticClass:"pa-0",attrs:{fluid:""}},[i("v-layout",{attrs:{row:""}},[i("v-flex",{attrs:{xs4:""}},[i("b",[e._v("Spells")])])],1),e._v(" "),i("v-layout",{attrs:{row:"",id:"spell_bar"}},[e._l(e.getSpells(),function(t,a){return i("div",{key:a,class:{selectedSpell:e.highlightSpell(t),spell:!e.highlightSpell(t)},attrs:{xs1:""},on:{click:function(i){e.selectSpell(t)}}},[i("v-tooltip",{attrs:{bottom:"","align-center":""}},[i("p",{staticClass:"text-xs-center ma-0",staticStyle:{"max-width":"200px"}},[e._v("\n                    Cast "+e._s(t.name)+" "),i("br"),e._v("\n                    Costs "),i("b",{staticStyle:{color:"blue"}},[e._v(e._s(t.manaCost)+" Mana")]),i("br"),e._v("\n                    "+e._s(t.hoverInfo)+"\n                ")]),e._v(" "),i("img",{attrs:{slot:"activator",src:e.getSpellSplashArt(t.type.toLowerCase(),t.splashArt),width:"26",height:"26"},slot:"activator"})])],1)}),e._v(" "),e._l(e.fillerSpellSlots(),function(e,t){return i("div",{staticClass:"spell",attrs:{xs1:""}},[i("img",{staticStyle:{opacity:"0.7"},attrs:{width:"26",height:"26",src:"static/images/equipment_placeholders/bookmarklet.png"}})])})],2)],1)},staticRenderFns:[]};var kt=i("VU/8")(St,Ct,!1,function(e){i("6EFC")},null,null).exports,Ot={props:["item","altSprite"],methods:{getInventorySprite:e=>`../static/images/inventory_sprites/${e}.png`,colorSlot:e=>!0,useItem(e,t){t.shiftKey?e.drop():e.use()},dropItem(e,t){e.drop()},getInventory:()=>Game.player.inventory}},Rt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"item_slot pa-0 ma-0 text-xs-center"},[null!==e.item?i("v-tooltip",{attrs:{"open-delay":"200",bottom:"","align-center":""}},[i("p",{staticClass:"text-xs-center ma-0"},[e._v("\n            "+e._s(e.item.getAction())+" "+e._s(e.item.type)+"\n            "),i("br"),e._v(" "),"name"in e.item?i("span",[e._v(e._s("Name: "+e.item.name)),i("br")]):e._e(),e._v(" "+e._s(e.item.hoverInfo())+"\n        ")]),e._v(" "),null!==e.item?i("v-layout",{attrs:{slot:"activator",ripple:"",row:""},on:{click:function(t){e.useItem(e.item,t)}},slot:"activator"},[i("v-badge",{attrs:{overlay:"",bottom:"",color:"grey",overlap:""}},[void 0!==e.item.quantity?i("span",{attrs:{slot:"badge",dark:""},slot:"badge"},[i("b",[e._v(e._s(e.item.quantity))])]):e._e(),e._v(" "),i("img",{attrs:{src:e.getInventorySprite(e.item.id)}})])],1):e._e()],1):null!==e.altSprite?i("img",{staticStyle:{opacity:"0.5"},attrs:{src:e.altSprite,width:"35",height:"35"}}):e._e()],1)},staticRenderFns:[]};var At={components:{"item-slot":i("VU/8")(Ot,Rt,!1,function(e){i("9g9w")},null,null).exports},data:()=>({equipment:Ze.player.cb.equipment})},Et={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{staticClass:"pa-0",attrs:{fluid:""}},[i("v-layout",[i("v-flex",{staticStyle:{"min-width":"75px"},attrs:{md1:""}},[i("b",[e._v("Equipment")])])],1),e._v(" "),i("v-container",{staticClass:"pa-0 text-xs-left",attrs:{fluid:""}},[i("v-layout",{staticStyle:{"margin-top":"4px"}},[e._l(4,function(e){return i("v-flex",{key:e,staticClass:"filler",attrs:{xs1:""}})}),e._v(" "),i("v-flex",{staticClass:"filler",attrs:{xs1:""}},[i("item-slot",{attrs:{item:e.equipment.head,altSprite:"../static/images/equipment_placeholders/head.png",index:"head"}})],1),e._v(" "),i("v-flex",{staticClass:"filler",attrs:{xs1:""}},[i("item-slot",{attrs:{item:e.equipment.ammo,altSprite:"../static/images/equipment_placeholders/quiver.png",index:"ammo"}})],1)],2),e._v(" "),i("v-layout",{staticStyle:{"margin-top":"4px"}},[e._l(3,function(e){return i("v-flex",{key:e,staticClass:"filler",attrs:{xs1:""}})}),e._v(" "),i("v-flex",{staticClass:"filler",attrs:{xs1:""}},[i("item-slot",{attrs:{item:e.equipment.weapon,altSprite:"../static/images/equipment_placeholders/stiletto.png",index:"weapon"}})],1),e._v(" "),i("v-flex",{staticClass:"filler",attrs:{xs1:""}},[i("item-slot",{attrs:{item:e.equipment.torso,altSprite:"../static/images/equipment_placeholders/chest-armor.png",index:"torso"}})],1)],2),e._v(" "),i("v-layout",{staticStyle:{"margin-top":"4px"}},[e._l(3,function(e){return i("v-flex",{key:e,staticClass:"filler",attrs:{xs1:""}})}),e._v(" "),i("v-flex",{staticClass:"filler",attrs:{xs1:""}},[i("item-slot",{attrs:{item:e.equipment.ring,altSprite:"../static/images/equipment_placeholders/ring.png",index:"weapon"}})],1),e._v(" "),i("v-flex",{staticClass:"filler",attrs:{xs1:""}},[i("item-slot",{attrs:{item:e.equipment.legs,altSprite:"../static/images/equipment_placeholders/leg-armor.png",index:"legs"}})],1)],2)],1)],1)},staticRenderFns:[]};var Lt=i("VU/8")(At,Et,!1,function(e){i("gPi5")},null,null).exports,$t={name:"help-dialog",data:()=>({helpDialog:!1,cheatSheet:[{code:". | 5",description:"Rest for a turn"},{code:", | g",description:"Pick up an item"},{code:"<",description:"Climb up a ladder"},{code:">",description:"Climb down a ladder"},{code:"f",description:"Fire a ranged weapon"},{code:"z",description:"Cast a spell"},{code:"x",description:"Examine the area"}]}),mounted(){window.addEventListener("keydown",e=>{(e.getModifierState("Shift")&&191===e.keyCode||27===e.keyCode&&this.helpDialog)&&(this.helpDialog=!this.helpDialog)})}},It={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"help"}},[i("v-tooltip",{attrs:{right:"","align-center":""}},[i("span",[e._v("Controls")]),e._v(" "),i("v-btn",{attrs:{slot:"activator",flat:"",icon:"",color:"yellow darken-4"},on:{click:function(t){t.stopPropagation(),e.helpDialog=!0}},slot:"activator"},[i("v-icon",[e._v("fa-question-circle")])],1)],1),e._v(" "),i("v-dialog",{attrs:{"max-width":"600px"},model:{value:e.helpDialog,callback:function(t){e.helpDialog=t},expression:"helpDialog"}},[i("v-card",[i("v-card-text",{staticClass:"text-xs-center"},[i("h2",{staticClass:"pa-1"},[e._v("Controls")])]),e._v(" "),i("v-card-text",[i("v-expansion-panel",[i("v-expansion-panel-content",[i("div",{attrs:{slot:"header"},slot:"header"},[e._v("All Keybinds")]),e._v(" "),i("v-card",{attrs:{flat:""}},[i("v-card-text",{staticClass:"pb-0 pt-0"},[i("v-container",[i("v-layout",{staticClass:"pb-2",attrs:{row:""}},[i("v-flex",{attrs:{xs6:""}},[i("b",[e._v("Keys")])]),e._v(" "),i("v-flex",{attrs:{xs6:""}},[i("b",[e._v("Description")])])],1),e._v(" "),e._l(e.cheatSheet,function(t,a){return i("v-layout",{key:a,attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs6:""}},[i("code",[e._v(e._s(t.code))])]),e._v(" "),i("v-flex",{attrs:{xs6:""}},[i("p",[e._v(e._s(t.description))])])],1)})],2)],1)],1)],1),e._v(" "),i("v-expansion-panel-content",[i("div",{attrs:{slot:"header"},slot:"header"},[e._v("Magic and Ranged Combat")]),e._v(" "),i("v-card",{attrs:{flat:""}},[i("v-card-text",{staticClass:"pt-0"},[i("v-container",{attrs:{fluid:""}},[i("p",[i("b",[e._v("Magic")])]),e._v(" "),i("p",[e._v("To cast a spell, first select a spell from your spellbook by "),i("code",[e._v("clicking")]),e._v(" on it. Then, you can press "),i("code",[e._v("z")]),e._v(" to cast the selected spell. If your spell is targeted, you will enter targeting mode.\n\n                                    ")]),i("p",[i("b",[e._v("Ranged")])]),e._v(" "),i("p",[e._v("If you have a ranged weapon and proper ammunition equipped, press "),i("code",[e._v("f")]),e._v(" to enter targeting mode to fire your ranged weapon.\n                                    ")]),e._v(" "),i("p",[i("b",[e._v("Targeting")])]),e._v("\n                                    In targeting mode, you can select a tile to cast a spell or shoot a projectile so long as it's within range. By default, targeting will select the nearest enemy. You can change the selected tile with the standard "),i("code",[e._v("movement")]),e._v(" keys. You can also cycle through enemies in view with "),i("code",[e._v("tab")]),e._v(", "),i("code",[e._v("=")]),e._v(", and "),i("code",[e._v("/")]),e._v(". You cannot select a tile that is blocked or out of your line of sight. Pressing "),i("code",[e._v("escape")]),e._v(" will cancel your spell or ranged attack. You can also press "),i("code",[e._v("f")]),e._v(" or "),i("code",[e._v("z")]),e._v(" for ranged or magic respectively.\n                                    ")])],1)],1)],1),e._v(" "),i("v-expansion-panel-content",[i("div",{attrs:{slot:"header"},slot:"header"},[e._v("Movement and Examining")]),e._v(" "),i("v-card",{attrs:{flat:""}},[i("v-card-text",{staticClass:"pb-0 pt-0"},[i("v-container",[i("p",[e._v("You can move with arrow keys, the numpad, or vi keys. You can move in all 8 directions. ")]),e._v(" "),i("v-container",{staticClass:"text-xs-center"},[i("pre",[e._v("y  k  u      7  8  9  ")]),e._v(" "),i("pre",[e._v(" \\ | /        \\ | /   ")]),e._v(" "),i("pre",[e._v(" h-+-l        4-5-6   ")]),e._v(" "),i("pre",[e._v(" / | \\        / | \\   ")]),e._v(" "),i("pre",[e._v("b  j  n      1  2  3  ")]),e._v(" "),i("pre",[e._v("vi-keys     numberpad ")])]),e._v(" "),i("p",[e._v("\n                                        When in targeting mode, you can use these keys to switch to different tiles. Press "),i("code",[e._v("x")]),e._v(" to examine your surroundings. Press "),i("code",[e._v("x")]),e._v(" or "),i("code",[e._v("escape")]),e._v(" to leave the examine mode.\n                                    ")])],1)],1)],1)],1),e._v(" "),i("v-expansion-panel-content",[i("div",{attrs:{slot:"header"},slot:"header"},[e._v("Melee Combat")]),e._v(" "),i("v-card",{attrs:{flat:""}},[i("v-card-text",{staticClass:"pt-0"},[i("v-container",{attrs:{fluid:""}},[i("p",[e._v("To fight an enemy with your fists or melee weapon, simply "),i("code",[e._v("move")]),e._v(" into a tile where they are standing.")])])],1)],1)],1),e._v(" "),i("v-expansion-panel-content",[i("v-card",{attrs:{flat:""}},[i("div",{attrs:{slot:"header"},slot:"header"},[e._v("Ladders, Resting, and Picking up Items")]),e._v(" "),i("v-card-text",{staticClass:"pt-0"},[i("v-container",{attrs:{fluid:""}},[i("p",[e._v("To pick up items off the ground, press "),i("code",[e._v(",")]),e._v(" or "),i("code",[e._v("g")]),e._v(".")]),e._v(" "),i("p",[e._v("To rest for a turn and restore a little health, press "),i("code",[e._v(".")]),e._v(" or "),i("code",[e._v("5")]),e._v(" on the numpad.")]),e._v(" "),i("p",[e._v("To climb ladders, press "),i("code",[e._v("<")]),e._v(" to go up and press "),i("code",[e._v(">")]),e._v(" to go down.")])])],1)],1)],1),e._v(" "),i("v-expansion-panel-content",[i("div",{attrs:{slot:"header"},slot:"header"},[e._v("Inventory Management")]),e._v(" "),i("v-card",{attrs:{flat:""}},[i("v-card-text",{staticClass:"pt-0"},[i("v-container",{attrs:{fluid:""}},[i("p",[e._v("\n                                        To equip a weapon or drink a potion, "),i("code",[e._v("click")]),e._v(" the item in your inventory. To drop an item, "),i("code",[e._v("shift+click")]),e._v(" the item in your inventory. Alternatively, you can either equip or drop items by right-clicking an item to bring up its context menu and selecting one of the actions from there.\n                                    ")]),e._v(" "),i("p",[e._v("\n                                        You can rearrange inventory items by dragging and dropping items where you want them to be.\n                                    ")]),e._v(" "),i("p",[e._v("\n                                        To view details about items, simply "),i("code",[e._v("hover")]),e._v(" over the item in your inventory and view the tooltip.\n                                    ")])])],1)],1)],1)],1)],1),e._v(" "),i("v-card-actions",[i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"yellow darken-4",flat:""},on:{click:function(t){t.stopPropagation(),e.helpDialog=!1}}},[e._v("Close")])],1)],1)],1)],1)},staticRenderFns:[]};var Mt=i("VU/8")($t,It,!1,function(e){i("zLzP")},null,null).exports,Dt={name:"help-dialog",data:()=>({userSettings:Ze.userSettings,toolDialog:!1,mouseEnabled:!1,showHPBars:Ze.userSettings.hpBars,turnOffAnimation:!1}),watch:{mouseEnabled(e,t){Ze.player.mouseEnabled=e}},methods:{toggleHPBars(){Ze.userSettings.hpBars=!Ze.userSettings.hpBars}}},Nt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-tooltip",{attrs:{right:"","align-center":""}},[i("span",[e._v("Settings")]),e._v(" "),i("v-btn",{attrs:{slot:"activator",flat:"",icon:"",color:"yellow darken-4"},on:{click:function(t){t.stopPropagation(),e.toolDialog=!0}},slot:"activator"},[i("v-icon",[e._v("fa-cog")])],1)],1),e._v(" "),i("v-dialog",{attrs:{"max-width":"400px"},model:{value:e.toolDialog,callback:function(t){e.toolDialog=t},expression:"toolDialog"}},[i("v-card",[i("v-card-text",{staticClass:"text-xs-center"},[i("h2",[e._v("Settings")])]),e._v(" "),i("v-card-text",[i("v-layout",{attrs:{row:""}},[i("v-flex",{attrs:{xs6:""}},[e._v("Enable Mouse Controls")]),e._v(" "),i("v-flex",{attrs:{xs4:"","offset-xs2":""}},[i("v-switch",{attrs:{color:"yellow darken-4"},model:{value:e.mouseEnabled,callback:function(t){e.mouseEnabled=t},expression:"mouseEnabled"}})],1)],1),e._v(" "),i("v-layout",{attrs:{row:""}},[i("v-flex",{attrs:{xs6:""}},[e._v("Show HP Bars")]),e._v(" "),i("v-flex",{attrs:{xs4:"","offset-xs2":""}},[i("v-switch",{attrs:{color:"yellow darken-4"},on:{click:function(t){return t.stopPropagation(),e.toggleHPBars(t)}},model:{value:e.userSettings.hpBars,callback:function(t){e.$set(e.userSettings,"hpBars",t)},expression:"userSettings.hpBars"}})],1)],1)],1),e._v(" "),i("v-card-actions",[i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"yellow darken-4",flat:""},on:{click:function(t){t.stopPropagation(),e.toolDialog=!1}}},[e._v("Close")])],1)],1)],1)],1)},staticRenderFns:[]},Bt=i("VU/8")(Dt,Nt,!1,null,null,null).exports;let{innerWidth:Pt}=window,qt=Pt>1400;var Ht={data:()=>({showEquipment:qt,activeTab:null,currentLevel:Ze.currentLevel,cb:Ze.player.cb,equipment:Ze.player.cb.equipment}),methods:{getHP:()=>Ze.player.cb.hp,getMaxHP:()=>Ze.player.cb.maxhp,getMana:()=>Ze.player.cb.mana,getMaxMana:()=>Ze.player.cb.maxmana,getCurrentLevel:()=>Ze.currentLevel.name.replace(/[0-9]/g,""),getCurrentLevelDepth:()=>parseInt(Ze.currentLevel.name.replace(/[^0-9]/g,""))},components:{inventory:dt,"enemy-overview":ft,"mini-map":wt,stats:Tt,spellbook:kt,"help-dialog":Mt,"tool-dialog":Bt,equipment:Lt},created(){}},Yt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-flex",{staticClass:"hud_container elevation-0",attrs:{column:""}},[i("v-container",{staticClass:"pa-2",attrs:{fluid:""}},[i("v-layout",{staticStyle:{"margin-bottom":"-20px","margin-top":"-10px"},attrs:{"align-center":""}},[i("v-flex",{staticStyle:{"min-width":"75px"},attrs:{md1:""}},[i("b",[e._v("Health ")])]),e._v(" "),i("v-flex",{attrs:{md8:""}},[i("v-progress-linear",{attrs:{id:"hpBar",color:"error",value:e.getHP()/e.getMaxHP()*100,height:"15"}})],1),e._v(" "),i("v-flex",{staticClass:"text-xs-center",staticStyle:{"padding-left":"5px"},attrs:{md3:""}},[e._v(e._s(e.getHP())+" / "+e._s(e.getMaxHP()))]),e._v(" "),i("v-flex",[i("help-dialog")],1)],1),e._v(" "),i("v-layout",{attrs:{"align-center":""}},[i("v-flex",{staticStyle:{"min-width":"75px"},attrs:{md1:""}},[i("b",[e._v("Magic")])]),e._v(" "),i("v-flex",{attrs:{md8:""}},[i("v-progress-linear",{attrs:{id:"manaBar",value:e.getMana()/e.getMaxMana()*100,height:"15",info:""}})],1),e._v(" "),i("v-flex",{staticClass:"text-xs-center",staticStyle:{"padding-left":"5px"},attrs:{md3:""}},[e._v(e._s(e.getMana())+" / "+e._s(e.getMaxMana()))]),e._v(" "),i("v-flex",[i("tool-dialog")],1)],1),e._v(" "),i("v-layout",[i("stats")],1),e._v(" "),i("v-layout",{staticClass:"mt-4",attrs:{"align-center":""}},[i("v-flex",{attrs:{xs5:""}},[i("b",[e._v("Location:")]),e._v(" "+e._s(e.getCurrentLevel().capitalize()))]),e._v(" "),e.getCurrentLevelDepth()>0?i("v-flex",{staticClass:"pl-3"},[i("b",[e._v("Level:")]),e._v(" "+e._s(e.getCurrentLevelDepth()))]):e._e()],1),e._v(" "),i("v-layout",{staticClass:"text-xs-center pt-1"},[i("v-flex",{attrs:{xs10:"",fluid:"",id:"minimap_container"}})],1),e._v(" "),e.showEquipment?i("v-layout",{staticClass:"pt-1",staticStyle:{"min-height":"145px"}},[i("equipment")],1):e._e(),e._v(" "),i("v-layout",[i("spellbook")],1),e._v(" "),i("v-layout",{staticClass:"mt-1"},[i("inventory")],1)],1)],1)},staticRenderFns:[]};var Wt=i("VU/8")(Ht,Yt,!1,function(e){i("KJcc")},null,null).exports,zt={data:()=>({cb:Ze.player.cb,dead:Ze.player.cb.dead,deathDialog:!0}),methods:{startNewGame(){location.reload()},formatNoOrMultiple:(e,t,i)=>`${0===t?"no":t} ${1===t?e:i}`,playerIsDead:()=>Ze.player.isDead()}},Ft={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.playerIsDead()?i("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:e.deathDialog,callback:function(t){e.deathDialog=t},expression:"deathDialog"}},[i("v-card",[i("v-card-text",{staticClass:"text-xs-center"},[i("h1",{staticClass:"red--text lighten-1"},[e._v("\n          You have died!\n      ")])]),e._v(" "),i("v-card-text",[i("v-layout",[i("v-flex",{attrs:{id:"death_text"}},[e._v("\n            You were level "+e._s(e.cb.level)+".\n            Your strength was level "+e._s(e.cb.str)+".\n            "),i("p"),e._v("\n\n            You knew "+e._s(e.formatNoOrMultiple("spell",e.cb.spells.length,"spells"))+".\n            You casted "+e._s(e.formatNoOrMultiple("spell",e.cb.spellsCast,"spells"))+".\n            "),i("p"),e._v("\n\n            You dealt "+e._s(e.cb.damageDealt)+" damage. You received "+e._s(e.cb.damageTaken)+" damage.\n            "),i("p"),e._v("\n\n            You recovered "+e._s(e.formatNoOrMultiple("heath point",e.cb.healthRestored,"health points"))+".\n            You consumed "+e._s(e.formatNoOrMultiple("potion",e.cb.potionsConsumed,"potions"))+"\n            "),i("p"),e._v("\n\n            You defeated "+e._s(e.formatNoOrMultiple("enemy",e.cb.enemiesKilled,"enemies"))+".\n            "),i("p"),e._v("\n\n            You explored "+e._s(e.formatNoOrMultiple("dungeon",e.cb.dungeonsExplored,"dungeons"))+".\n            You looted "+e._s(e.formatNoOrMultiple("treasure chest",e.cb.chestsOpened,"treasure chests"))+".\n            "),i("p")])],1)],1),e._v(" "),i("v-card-actions",[i("img",{attrs:{src:"static/images/death_icons/tombstone.png",width:"100px",height:"100px"}}),e._v(" "),i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"green darken-3",raised:""},on:{click:function(t){t.stopPropagation(),e.startNewGame()}}},[e._v("Play Again")]),e._v(" "),i("v-spacer"),e._v(" "),i("img",{attrs:{src:"static/images/death_icons/hasty-grave.png",width:"120px",height:"100px"}})],1)],1)],1):e._e()},staticRenderFns:[]};var Vt=i("VU/8")(zt,Ft,!1,function(e){i("oe5T")},null,null).exports;window.Game=Ze;let{innerWidth:jt,innerHeight:Gt}=window,Ut=jt<=1400?"1240px":"1470px",Kt=Gt<=800?"750px":"823px",Jt=jt>1400,Xt=jt<=1400?"800px":"1024px",Zt=Gt<=800?"500px":"640px";var Qt={name:"app",data:()=>({mouseControls:!1,loading:!0,playerSelected:!1,unstableBuildMessage:!1,uiWidth:Ut,uiHeight:Kt,gameDisplayWidth:Xt,gameDisplayHeight:Zt,hideFooter:Jt}),components:{"start-menu":tt,"game-display":lt,hud:Wt,"item-transfer-modal":mt,"death-modal":Vt,"help-dialog":Mt,"message-log":st},created(){},mounted(){},methods:{loadGame(e){this.playerSelected=!0,Ze.init(e),Ze.log("Welcome to Rotten Soup!","information"),Ze.log("Press ? to view the controls.","player_move")}}},ei={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-app",{staticClass:"black",attrs:{dark:""}},[i("v-content",[i("v-container",{directives:[{name:"show",rawName:"v-show",value:e.playerSelected,expression:"playerSelected"}],style:{"max-width":e.uiWidth,"max-height":e.uiHeight},attrs:{id:"main_container"}},[e.unstableBuildMessage?i("v-layout",{attrs:{row:""}},[i("v-flex",{attrs:{xs12:""}},[i("v-alert",{attrs:{color:"yellow darken-4",type:"warning",dismissible:""},model:{value:e.unstableBuildMessage,callback:function(t){e.unstableBuildMessage=t},expression:"unstableBuildMessage"}},[e._v("\n              This build is unstable. A lot of working is going on under the hood. Expect lots of broken, weird things!\n            ")])],1)],1):e._e(),e._v(" "),i("v-layout",{staticClass:"mt-3",style:{"max-width":e.uiWidth,"max-height":e.uiHeight},attrs:{row:"",id:"ui"}},[i("v-flex",{style:{"max-width":e.gameDisplayWidth},attrs:{column:""}},[i("v-layout",{style:{"max-height":e.gameDisplayHeight},attrs:{id:"game_container_row"}},[i("div",{attrs:{id:"game_container"}})]),e._v(" "),e.playerSelected?i("message-log"):e._e()],1),e._v(" "),e.playerSelected?i("hud"):e._e()],1),e._v(" "),e.playerSelected?i("death-modal"):e._e()],1),e._v(" "),i("start-menu",{directives:[{name:"show",rawName:"v-show",value:!e.playerSelected,expression:"!playerSelected"}],on:{spriteSelected:e.loadGame}})],1),e._v(" "),e.hideFooter?i("v-footer",{attrs:{app:""}},[i("small",{staticClass:"pl-2"},[e._v("RottenSoup")]),e._v(" "),i("v-btn",{attrs:{target:"_blank",href:"https://github.com/Larkenx/Rotten-Soup",icon:"",ripple:""}},[i("v-icon",[e._v("fa-github")])],1)],1):e._e()],1)},staticRenderFns:[]};var ti=i("VU/8")(Qt,ei,!1,function(e){i("6DgK")},null,null).exports,ii=i("3EgV"),ai=i.n(ii);i("7zck");a.a.use(ai.a),a.a.config.productionTip=!1,new a.a({el:"#app",components:{App:ti},template:"<App/>"})},TiSk:function(e,t){},gPi5:function(e,t){},jZkN:function(e,t){},lPMU:function(e,t){},oNwW:function(e,t){},oe5T:function(e,t){},z9mr:function(e,t){},zLzP:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.2fa9e20e34adf72a87c5.js.map